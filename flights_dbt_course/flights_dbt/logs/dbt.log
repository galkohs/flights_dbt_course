[0m13:40:35.040027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A7759210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A76E1E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A731F090>]}


============================== 13:40:35.053289 | eb945846-48c5-467d-b7d8-4c60717251ef ==============================
[0m13:40:35.053289 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:40:35.055228 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:40:35.190220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb945846-48c5-467d-b7d8-4c60717251ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A7376010>]}
[0m13:40:35.206217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb945846-48c5-467d-b7d8-4c60717251ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A7376010>]}
[0m13:40:35.208211 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m13:40:35.225649 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:40:35.226671 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:40:35.227671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'eb945846-48c5-467d-b7d8-4c60717251ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A1084250>]}
[0m13:40:36.340454 [debug] [MainThread]: 1603: static parser failed on dimension\Dim_Airport.sql
[0m13:40:36.355415 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimension\Dim_Airport.sql
[0m13:40:36.358407 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m13:40:36.362396 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m13:40:36.444178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb945846-48c5-467d-b7d8-4c60717251ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A7AABC10>]}
[0m13:40:36.455139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb945846-48c5-467d-b7d8-4c60717251ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A7B0FC50>]}
[0m13:40:36.455139 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:40:36.457136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb945846-48c5-467d-b7d8-4c60717251ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A3773090>]}
[0m13:40:36.458167 [info ] [MainThread]: 
[0m13:40:36.460128 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:40:36.461503 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m13:40:36.473475 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m13:40:36.474472 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m13:40:36.476478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:36.559856 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m13:40:36.561850 [debug] [ThreadPool]: On list_flights_demo: Close
[0m13:40:36.563846 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_flights_demo, now create_flights_demo_flights_wh)
[0m13:40:36.565485 [debug] [ThreadPool]: Creating schema "database: "flights_demo"
schema: "flights_wh"
"
[0m13:40:36.571471 [debug] [ThreadPool]: Using postgres connection "create_flights_demo_flights_wh"
[0m13:40:36.571471 [debug] [ThreadPool]: On create_flights_demo_flights_wh: BEGIN
[0m13:40:36.572469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:36.618105 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:40:36.619100 [debug] [ThreadPool]: Using postgres connection "create_flights_demo_flights_wh"
[0m13:40:36.619100 [debug] [ThreadPool]: On create_flights_demo_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "create_flights_demo_flights_wh"} */
create schema if not exists "flights_wh"
[0m13:40:36.633570 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m13:40:36.635112 [debug] [ThreadPool]: On create_flights_demo_flights_wh: COMMIT
[0m13:40:36.636104 [debug] [ThreadPool]: Using postgres connection "create_flights_demo_flights_wh"
[0m13:40:36.636104 [debug] [ThreadPool]: On create_flights_demo_flights_wh: COMMIT
[0m13:40:36.639097 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m13:40:36.639097 [debug] [ThreadPool]: On create_flights_demo_flights_wh: Close
[0m13:40:36.642087 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo_flights_wh'
[0m13:40:36.647100 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m13:40:36.648097 [debug] [ThreadPool]: On list_flights_demo_flights_wh: BEGIN
[0m13:40:36.648097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:36.813564 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:40:36.813564 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m13:40:36.814561 [debug] [ThreadPool]: On list_flights_demo_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo_flights_wh"} */
select
      'flights_demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m13:40:36.834510 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m13:40:36.836502 [debug] [ThreadPool]: On list_flights_demo_flights_wh: ROLLBACK
[0m13:40:36.836502 [debug] [ThreadPool]: On list_flights_demo_flights_wh: Close
[0m13:40:36.843485 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:36.843485 [debug] [MainThread]: On master: BEGIN
[0m13:40:36.844482 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:40:36.902334 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:40:36.905319 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:36.906316 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:40:36.933735 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m13:40:36.937726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb945846-48c5-467d-b7d8-4c60717251ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A3773090>]}
[0m13:40:36.938724 [debug] [MainThread]: On master: ROLLBACK
[0m13:40:36.939721 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:36.940754 [debug] [MainThread]: On master: BEGIN
[0m13:40:36.940754 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:40:36.941749 [debug] [MainThread]: On master: COMMIT
[0m13:40:36.941749 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:36.942712 [debug] [MainThread]: On master: COMMIT
[0m13:40:36.942712 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:40:36.943710 [debug] [MainThread]: On master: Close
[0m13:40:36.943710 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:40:36.944709 [info ] [MainThread]: 
[0m13:40:36.955056 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_Airport
[0m13:40:36.956095 [info ] [Thread-1 (]: 1 of 3 START sql incremental model flights_wh.Dim_Airport ...................... [RUN]
[0m13:40:36.957053 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flights_dbt.Dim_Airport'
[0m13:40:36.958051 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_Airport
[0m13:40:36.961042 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_Airport"
[0m13:40:36.963975 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (compile): 13:40:36.958051 => 13:40:36.963975
[0m13:40:36.964973 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_Airport
[0m13:40:37.033790 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_Airport"
[0m13:40:37.038777 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m13:40:37.039774 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: BEGIN
[0m13:40:37.039774 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:40:37.084654 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:40:37.084654 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m13:40:37.085652 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      
  
    

  create  table "flights_demo"."flights_wh"."Dim_Airport"
  
  
    as
  
  (
    

select *,
jsonb_extract_path(airport_name, 'en' )as airport_name_eng, 
jsonb_extract_path(city, 'en' )as city_eng,
jsonb_extract_path(airport_name, 'ru' )as airport_name_rus,
jsonb_extract_path(city, 'en' )as city_rus
'2023-08-16 10:40:35'::timestamp as dbt_time
from stg.airports_data
  );
  
  
[0m13:40:37.086649 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "'2023-08-16 10:40:35'"
LINE 20: '2023-08-16 10:40:35'::timestamp as dbt_time
         ^

[0m13:40:37.087648 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: ROLLBACK
[0m13:40:37.088644 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (execute): 13:40:36.964973 => 13:40:37.087648
[0m13:40:37.088644 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: Close
[0m13:40:37.184910 [debug] [Thread-1 (]: Database Error in model Dim_Airport (models\dimension\Dim_Airport.sql)
  syntax error at or near "'2023-08-16 10:40:35'"
  LINE 20: '2023-08-16 10:40:35'::timestamp as dbt_time
           ^
  compiled Code at target\run\flights_dbt\models\dimension\Dim_Airport.sql
[0m13:40:37.185903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb945846-48c5-467d-b7d8-4c60717251ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A7C02B10>]}
[0m13:40:37.186901 [error] [Thread-1 (]: 1 of 3 ERROR creating sql incremental model flights_wh.Dim_Airport ............. [[31mERROR[0m in 0.23s]
[0m13:40:37.187924 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_Airport
[0m13:40:37.188932 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m13:40:37.188932 [info ] [Thread-1 (]: 2 of 3 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m13:40:37.190916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_Airport, now model.flights_dbt.my_first_dbt_model)
[0m13:40:37.190916 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m13:40:37.193881 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m13:40:37.195664 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 13:40:37.190916 => 13:40:37.195664
[0m13:40:37.196664 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m13:40:37.210628 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m13:40:37.211513 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m13:40:37.212513 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m13:40:37.212513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:37.263378 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:40:37.264375 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m13:40:37.265372 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m13:40:37.281329 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m13:40:37.289308 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m13:40:37.290306 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m13:40:37.292299 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:40:37.314243 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m13:40:37.314243 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m13:40:37.315240 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m13:40:37.317234 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:40:37.324218 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m13:40:37.325212 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_demo"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m13:40:37.326211 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:40:37.329202 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 13:40:37.196664 => 13:40:37.328205
[0m13:40:37.329202 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m13:40:37.330199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb945846-48c5-467d-b7d8-4c60717251ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A804C910>]}
[0m13:40:37.332194 [info ] [Thread-1 (]: 2 of 3 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.14s]
[0m13:40:37.334190 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m13:40:37.336184 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m13:40:37.337181 [info ] [Thread-1 (]: 3 of 3 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m13:40:37.338179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m13:40:37.339176 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m13:40:37.342168 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m13:40:37.344163 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 13:40:37.339176 => 13:40:37.344163
[0m13:40:37.345161 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m13:40:37.386051 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m13:40:37.389047 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m13:40:37.390041 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m13:40:37.390041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:37.469827 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:40:37.470824 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m13:40:37.470824 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_demo"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m13:40:37.482795 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:40:37.489777 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m13:40:37.490771 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m13:40:37.492766 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:40:37.495760 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m13:40:37.495760 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m13:40:37.496756 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m13:40:37.497754 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:40:37.501743 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m13:40:37.502741 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m13:40:37.503741 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:40:37.507727 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 13:40:37.345161 => 13:40:37.506728
[0m13:40:37.508723 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m13:40:37.510721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb945846-48c5-467d-b7d8-4c60717251ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A7B49A90>]}
[0m13:40:37.511718 [info ] [Thread-1 (]: 3 of 3 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.17s]
[0m13:40:37.513712 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m13:40:37.516706 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:37.518709 [debug] [MainThread]: On master: BEGIN
[0m13:40:37.519697 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:40:37.590506 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:40:37.591503 [debug] [MainThread]: On master: COMMIT
[0m13:40:37.592501 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:37.593498 [debug] [MainThread]: On master: COMMIT
[0m13:40:37.594498 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:40:37.595705 [debug] [MainThread]: On master: Close
[0m13:40:37.596491 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:37.598485 [debug] [MainThread]: Connection 'create_flights_demo_flights_wh' was properly closed.
[0m13:40:37.599484 [debug] [MainThread]: Connection 'list_flights_demo_flights_wh' was properly closed.
[0m13:40:37.600480 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m13:40:37.603471 [info ] [MainThread]: 
[0m13:40:37.605467 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 1 view model in 0 hours 0 minutes and 1.14 seconds (1.14s).
[0m13:40:37.606463 [debug] [MainThread]: Command end result
[0m13:40:37.613444 [info ] [MainThread]: 
[0m13:40:37.614441 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:40:37.616438 [info ] [MainThread]: 
[0m13:40:37.617434 [error] [MainThread]: [33mDatabase Error in model Dim_Airport (models\dimension\Dim_Airport.sql)[0m
[0m13:40:37.619430 [error] [MainThread]:   syntax error at or near "'2023-08-16 10:40:35'"
[0m13:40:37.620426 [error] [MainThread]:   LINE 20: '2023-08-16 10:40:35'::timestamp as dbt_time
[0m13:40:37.621436 [error] [MainThread]:            ^
[0m13:40:37.623421 [error] [MainThread]:   compiled Code at target\run\flights_dbt\models\dimension\Dim_Airport.sql
[0m13:40:37.625419 [info ] [MainThread]: 
[0m13:40:37.629404 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m13:40:37.631396 [debug] [MainThread]: Command `dbt run` failed at 13:40:37.631396 after 2.63 seconds
[0m13:40:37.632393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A70DDC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A0DEEC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000216A0DEEBD0>]}
[0m13:40:37.635395 [debug] [MainThread]: Flushing usage events
[0m13:41:32.138675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3C44BED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3C431C750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3C482A8D0>]}


============================== 13:41:32.142691 | b2162429-5446-45eb-8992-9649ba699193 ==============================
[0m13:41:32.142691 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:41:32.143662 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:41:32.227648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2162429-5446-45eb-8992-9649ba699193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3C4034B50>]}
[0m13:41:32.250587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2162429-5446-45eb-8992-9649ba699193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3C248EBD0>]}
[0m13:41:32.251585 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m13:41:32.265548 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:41:32.342301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:41:32.342301 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models\dimension\Dim_Airport.sql
[0m13:41:32.364284 [debug] [MainThread]: 1603: static parser failed on dimension\Dim_Airport.sql
[0m13:41:32.379239 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimension\Dim_Airport.sql
[0m13:41:32.390210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2162429-5446-45eb-8992-9649ba699193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3C4B8D390>]}
[0m13:41:32.398152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2162429-5446-45eb-8992-9649ba699193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3C4B8E9D0>]}
[0m13:41:32.398152 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:41:32.399112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2162429-5446-45eb-8992-9649ba699193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3C0843110>]}
[0m13:41:32.401145 [info ] [MainThread]: 
[0m13:41:32.402939 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:41:32.403977 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m13:41:32.415979 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m13:41:32.417944 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m13:41:32.417944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:32.589081 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:41:32.590081 [debug] [ThreadPool]: On list_flights_demo: Close
[0m13:41:32.592639 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo_flights_wh'
[0m13:41:32.598626 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m13:41:32.599623 [debug] [ThreadPool]: On list_flights_demo_flights_wh: BEGIN
[0m13:41:32.599623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:32.643426 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:41:32.643426 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m13:41:32.644469 [debug] [ThreadPool]: On list_flights_demo_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo_flights_wh"} */
select
      'flights_demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m13:41:32.652478 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m13:41:32.653479 [debug] [ThreadPool]: On list_flights_demo_flights_wh: ROLLBACK
[0m13:41:32.654783 [debug] [ThreadPool]: On list_flights_demo_flights_wh: Close
[0m13:41:32.659806 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:32.659806 [debug] [MainThread]: On master: BEGIN
[0m13:41:32.660803 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:41:32.704308 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:41:32.704308 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:32.705295 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:41:32.728207 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m13:41:32.729204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2162429-5446-45eb-8992-9649ba699193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3C43BE390>]}
[0m13:41:32.730201 [debug] [MainThread]: On master: ROLLBACK
[0m13:41:32.731198 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:32.731198 [debug] [MainThread]: On master: BEGIN
[0m13:41:32.732410 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:41:32.733413 [debug] [MainThread]: On master: COMMIT
[0m13:41:32.733413 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:32.734410 [debug] [MainThread]: On master: COMMIT
[0m13:41:32.734410 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:41:32.735405 [debug] [MainThread]: On master: Close
[0m13:41:32.736402 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:41:32.737411 [info ] [MainThread]: 
[0m13:41:32.743975 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_Airport
[0m13:41:32.743975 [info ] [Thread-1 (]: 1 of 3 START sql incremental model flights_wh.Dim_Airport ...................... [RUN]
[0m13:41:32.746332 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flights_dbt.Dim_Airport'
[0m13:41:32.746332 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_Airport
[0m13:41:32.751319 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_Airport"
[0m13:41:32.755309 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (compile): 13:41:32.747331 => 13:41:32.754318
[0m13:41:32.756305 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_Airport
[0m13:41:32.814189 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_Airport"
[0m13:41:32.817145 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m13:41:32.819140 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: BEGIN
[0m13:41:32.821136 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:41:32.866205 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:41:32.867201 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m13:41:32.867201 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      
  
    

  create  table "flights_demo"."flights_wh"."Dim_Airport"
  
  
    as
  
  (
    

select *,
    jsonb_extract_path(airport_name, 'en' )as airport_name_eng, 
    jsonb_extract_path(city, 'en' )as city_eng,
    jsonb_extract_path(airport_name, 'ru' )as airport_name_rus,
    jsonb_extract_path(city, 'en' )as city_rus,

'2023-08-16 10:41:32'::timestamp as dbt_time

from stg.airports_data
  );
  
  
[0m13:41:32.891640 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m13:41:32.909592 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m13:41:32.910551 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m13:41:32.910551 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m13:41:32.913036 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:41:32.914073 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (execute): 13:41:32.756305 => 13:41:32.914073
[0m13:41:32.914073 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: Close
[0m13:41:32.916031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2162429-5446-45eb-8992-9649ba699193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3C4BB5810>]}
[0m13:41:32.917030 [info ] [Thread-1 (]: 1 of 3 OK created sql incremental model flights_wh.Dim_Airport ................. [[32mSELECT 104[0m in 0.17s]
[0m13:41:32.918026 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_Airport
[0m13:41:32.919022 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m13:41:32.919022 [info ] [Thread-1 (]: 2 of 3 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m13:41:32.921370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_Airport, now model.flights_dbt.my_first_dbt_model)
[0m13:41:32.921370 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m13:41:32.924397 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m13:41:32.925360 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 13:41:32.921370 => 13:41:32.924397
[0m13:41:32.925360 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m13:41:32.939360 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m13:41:32.941318 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m13:41:32.942314 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m13:41:32.942314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:32.988995 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:41:32.989995 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m13:41:32.989995 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m13:41:32.995493 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m13:41:33.003512 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m13:41:33.004508 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m13:41:33.007464 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:41:33.010492 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m13:41:33.010492 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m13:41:33.011453 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:41:33.016492 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m13:41:33.017441 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m13:41:33.018474 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m13:41:33.020429 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:41:33.024457 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m13:41:33.025452 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_demo"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m13:41:33.041591 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:41:33.042592 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 13:41:32.926358 => 13:41:33.042592
[0m13:41:33.043588 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m13:41:33.044586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2162429-5446-45eb-8992-9649ba699193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3C43EDBD0>]}
[0m13:41:33.045583 [info ] [Thread-1 (]: 2 of 3 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.12s]
[0m13:41:33.046582 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m13:41:33.047579 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m13:41:33.048576 [info ] [Thread-1 (]: 3 of 3 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m13:41:33.050572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m13:41:33.050572 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m13:41:33.053595 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m13:41:33.054594 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 13:41:33.051568 => 13:41:33.054594
[0m13:41:33.055582 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m13:41:33.075540 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m13:41:33.076538 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m13:41:33.076538 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m13:41:33.077499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:33.126285 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:41:33.127322 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m13:41:33.127322 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_demo"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m13:41:33.136271 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:41:33.140256 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m13:41:33.140256 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m13:41:33.141254 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:41:33.143248 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m13:41:33.143248 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m13:41:33.144245 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m13:41:33.145256 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:41:33.148285 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m13:41:33.149249 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m13:41:33.151244 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:41:33.152240 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 13:41:33.055582 => 13:41:33.152240
[0m13:41:33.153272 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m13:41:33.154234 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2162429-5446-45eb-8992-9649ba699193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3C4CF0510>]}
[0m13:41:33.155234 [info ] [Thread-1 (]: 3 of 3 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.10s]
[0m13:41:33.156229 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m13:41:33.158258 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:33.158258 [debug] [MainThread]: On master: BEGIN
[0m13:41:33.159222 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:41:33.202256 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:41:33.203294 [debug] [MainThread]: On master: COMMIT
[0m13:41:33.204270 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:33.204270 [debug] [MainThread]: On master: COMMIT
[0m13:41:33.205293 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:41:33.205293 [debug] [MainThread]: On master: Close
[0m13:41:33.206279 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:41:33.207241 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m13:41:33.207241 [debug] [MainThread]: Connection 'list_flights_demo_flights_wh' was properly closed.
[0m13:41:33.208239 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m13:41:33.208239 [info ] [MainThread]: 
[0m13:41:33.209238 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 1 view model in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m13:41:33.211231 [debug] [MainThread]: Command end result
[0m13:41:33.219213 [info ] [MainThread]: 
[0m13:41:33.221220 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:41:33.222202 [info ] [MainThread]: 
[0m13:41:33.223236 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:41:33.225228 [debug] [MainThread]: Command `dbt run` succeeded at 13:41:33.225228 after 1.10 seconds
[0m13:41:33.225228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3C4465310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3C3E61610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3BDE7DFD0>]}
[0m13:41:33.226192 [debug] [MainThread]: Flushing usage events
[0m13:46:24.987823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A0C842D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A09EF450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A0C85810>]}


============================== 13:46:24.993977 | aec4de0e-fd03-4407-be52-88bd18bed3b9 ==============================
[0m13:46:24.993977 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:46:24.994978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:46:25.080523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aec4de0e-fd03-4407-be52-88bd18bed3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A06FA650>]}
[0m13:46:25.096482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aec4de0e-fd03-4407-be52-88bd18bed3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A0C61D10>]}
[0m13:46:25.097933 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m13:46:25.109905 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:46:25.254828 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:46:25.255826 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models\example\schema.yml
[0m13:46:25.255826 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models\dimension\Dim_Airport.sql
[0m13:46:25.290733 [debug] [MainThread]: 1603: static parser failed on dimension\Dim_Airport.sql
[0m13:46:25.305546 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimension\Dim_Airport.sql
[0m13:46:25.346427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aec4de0e-fd03-4407-be52-88bd18bed3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A14E54D0>]}
[0m13:46:25.353869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aec4de0e-fd03-4407-be52-88bd18bed3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A149F750>]}
[0m13:46:25.354877 [info ] [MainThread]: Found 3 models, 6 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:46:25.355839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aec4de0e-fd03-4407-be52-88bd18bed3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C89D0C3090>]}
[0m13:46:25.357857 [info ] [MainThread]: 
[0m13:46:25.358829 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:46:25.360848 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m13:46:25.369831 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m13:46:25.370849 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m13:46:25.370849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:25.448831 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m13:46:25.450824 [debug] [ThreadPool]: On list_flights_demo: Close
[0m13:46:25.452820 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo_flights_wh'
[0m13:46:25.457831 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m13:46:25.458829 [debug] [ThreadPool]: On list_flights_demo_flights_wh: BEGIN
[0m13:46:25.458829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:25.502623 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:46:25.503650 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m13:46:25.503650 [debug] [ThreadPool]: On list_flights_demo_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo_flights_wh"} */
select
      'flights_demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m13:46:25.513661 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m13:46:25.515660 [debug] [ThreadPool]: On list_flights_demo_flights_wh: ROLLBACK
[0m13:46:25.515660 [debug] [ThreadPool]: On list_flights_demo_flights_wh: Close
[0m13:46:25.520679 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:25.521677 [debug] [MainThread]: On master: BEGIN
[0m13:46:25.521677 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:46:25.561671 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:46:25.561671 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:25.562706 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:46:25.584445 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m13:46:25.586437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aec4de0e-fd03-4407-be52-88bd18bed3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A14A6C90>]}
[0m13:46:25.587427 [debug] [MainThread]: On master: ROLLBACK
[0m13:46:25.588425 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:25.588425 [debug] [MainThread]: On master: BEGIN
[0m13:46:25.589391 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:46:25.589391 [debug] [MainThread]: On master: COMMIT
[0m13:46:25.590389 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:25.590389 [debug] [MainThread]: On master: COMMIT
[0m13:46:25.591385 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:46:25.591385 [debug] [MainThread]: On master: Close
[0m13:46:25.592421 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:46:25.593382 [info ] [MainThread]: 
[0m13:46:25.607957 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_Airport
[0m13:46:25.609954 [info ] [Thread-1 (]: 1 of 3 START sql incremental model flights_wh.Dim_Airport ...................... [RUN]
[0m13:46:25.611946 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flights_dbt.Dim_Airport'
[0m13:46:25.613945 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_Airport
[0m13:46:25.619958 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_Airport"
[0m13:46:25.621921 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (compile): 13:46:25.614991 => 13:46:25.621921
[0m13:46:25.622950 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_Airport
[0m13:46:25.688775 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m13:46:25.689771 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

    
  
    

  create temporary table "Dim_Airport__dbt_tmp134625657859"
  
  
    as
  
  (
    

select *,
    jsonb_extract_path(airport_name, 'en' )as airport_name_eng, 
    jsonb_extract_path(city, 'en' )as city_eng,
    jsonb_extract_path(airport_name, 'ru' )as airport_name_rus,
    jsonb_extract_path(city, 'en' )as city_rus,

'2023-08-16 10:46:24'::timestamp as dbt_time

from stg.airports_data
  );
  
  
[0m13:46:25.690736 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:46:25.768406 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m13:46:25.775389 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m13:46:25.775389 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: BEGIN
[0m13:46:25.776386 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:46:25.777384 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m13:46:25.777384 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport__dbt_tmp134625657859'
        
      order by ordinal_position

  
[0m13:46:25.801319 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m13:46:25.806306 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m13:46:25.807304 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m13:46:25.811293 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m13:46:25.820269 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m13:46:25.821267 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m13:46:25.825256 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m13:46:25.843208 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_Airport"
[0m13:46:25.844206 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m13:46:25.845203 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      
        
            delete from "flights_demo"."flights_wh"."Dim_Airport"
            where (
                airport_code) in (
                select (airport_code)
                from "Dim_Airport__dbt_tmp134625657859"
            );

        
    

    insert into "flights_demo"."flights_wh"."Dim_Airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time"
        from "Dim_Airport__dbt_tmp134625657859"
    )
  
[0m13:46:25.853180 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m13:46:25.868141 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m13:46:25.868141 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m13:46:25.869141 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m13:46:25.870137 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:46:25.872131 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (execute): 13:46:25.622950 => 13:46:25.872131
[0m13:46:25.873128 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: Close
[0m13:46:25.874127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aec4de0e-fd03-4407-be52-88bd18bed3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A0C260D0>]}
[0m13:46:25.875124 [info ] [Thread-1 (]: 1 of 3 OK created sql incremental model flights_wh.Dim_Airport ................. [[32mINSERT 0 104[0m in 0.26s]
[0m13:46:25.877124 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_Airport
[0m13:46:25.879112 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m13:46:25.880110 [info ] [Thread-1 (]: 2 of 3 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m13:46:25.882106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_Airport, now model.flights_dbt.my_first_dbt_model)
[0m13:46:25.882106 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m13:46:25.886096 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m13:46:25.887120 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 13:46:25.883103 => 13:46:25.887120
[0m13:46:25.888089 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m13:46:25.906078 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m13:46:25.907074 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m13:46:25.908036 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m13:46:25.908036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:25.959897 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:46:25.960894 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m13:46:25.961892 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m13:46:25.968077 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m13:46:25.975059 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m13:46:25.976057 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m13:46:25.978895 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:46:25.982921 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m13:46:25.983881 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m13:46:25.984879 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:46:25.992857 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m13:46:25.992857 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m13:46:25.993855 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m13:46:25.995850 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:46:26.000835 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m13:46:26.001833 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_demo"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m13:46:26.005823 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:46:26.006821 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 13:46:25.889117 => 13:46:26.006821
[0m13:46:26.007818 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m13:46:26.008814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aec4de0e-fd03-4407-be52-88bd18bed3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A1562C50>]}
[0m13:46:26.009814 [info ] [Thread-1 (]: 2 of 3 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.13s]
[0m13:46:26.011810 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m13:46:26.012807 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m13:46:26.013803 [info ] [Thread-1 (]: 3 of 3 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m13:46:26.014800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m13:46:26.014800 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m13:46:26.017791 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m13:46:26.019788 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 13:46:26.015796 => 13:46:26.018788
[0m13:46:26.019788 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m13:46:26.039733 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m13:46:26.040730 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m13:46:26.040730 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m13:46:26.041728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:26.207676 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:46:26.208721 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m13:46:26.208721 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_demo"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m13:46:26.221096 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:46:26.224122 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m13:46:26.225121 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m13:46:26.226086 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:46:26.228083 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m13:46:26.229078 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m13:46:26.230108 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m13:46:26.230804 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:46:26.233830 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m13:46:26.234796 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m13:46:26.235794 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:46:26.237818 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 13:46:26.020784 => 13:46:26.236790
[0m13:46:26.237818 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m13:46:26.238786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aec4de0e-fd03-4407-be52-88bd18bed3b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8A1570050>]}
[0m13:46:26.239783 [info ] [Thread-1 (]: 3 of 3 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.22s]
[0m13:46:26.240780 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m13:46:26.242775 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:26.243773 [debug] [MainThread]: On master: BEGIN
[0m13:46:26.243773 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:46:26.289248 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:46:26.289248 [debug] [MainThread]: On master: COMMIT
[0m13:46:26.289248 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:26.290245 [debug] [MainThread]: On master: COMMIT
[0m13:46:26.290245 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:46:26.291243 [debug] [MainThread]: On master: Close
[0m13:46:26.292239 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:46:26.293240 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m13:46:26.293240 [debug] [MainThread]: Connection 'list_flights_demo_flights_wh' was properly closed.
[0m13:46:26.294235 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m13:46:26.296437 [info ] [MainThread]: 
[0m13:46:26.298441 [info ] [MainThread]: Finished running 1 incremental model, 1 table model, 1 view model in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m13:46:26.301465 [debug] [MainThread]: Command end result
[0m13:46:26.308416 [info ] [MainThread]: 
[0m13:46:26.309405 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:46:26.310404 [info ] [MainThread]: 
[0m13:46:26.312409 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:46:26.314428 [debug] [MainThread]: Command `dbt run` succeeded at 13:46:26.314428 after 1.36 seconds
[0m13:46:26.314428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C89A729110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C89AA04190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C89AA04250>]}
[0m13:46:26.315390 [debug] [MainThread]: Flushing usage events
[0m13:58:50.594444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD11A49590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD11AA42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD11AA4D90>]}


============================== 13:58:50.598428 | 737bcdc9-ce61-459b-bf9f-eef6511ec811 ==============================
[0m13:58:50.598428 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:58:50.599427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:58:50.673680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '737bcdc9-ce61-459b-bf9f-eef6511ec811', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD1173F550>]}
[0m13:58:50.689642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '737bcdc9-ce61-459b-bf9f-eef6511ec811', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD1173F550>]}
[0m13:58:50.691598 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m13:58:50.702568 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m13:58:50.778117 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:58:50.779069 [debug] [MainThread]: Partial parsing: added file: flights_dbt://models\dimension\Dim_aircraft.sql
[0m13:58:50.800049 [debug] [MainThread]: 1603: static parser failed on dimension\Dim_aircraft.sql
[0m13:58:50.815011 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimension\Dim_aircraft.sql
[0m13:58:50.825974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '737bcdc9-ce61-459b-bf9f-eef6511ec811', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD121D2C50>]}
[0m13:58:50.831959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '737bcdc9-ce61-459b-bf9f-eef6511ec811', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD121F8610>]}
[0m13:58:50.832926 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m13:58:50.833923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '737bcdc9-ce61-459b-bf9f-eef6511ec811', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD0DEE32D0>]}
[0m13:58:50.835918 [info ] [MainThread]: 
[0m13:58:50.837931 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:58:50.838929 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m13:58:50.848920 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m13:58:50.848920 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m13:58:50.849929 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:58:50.902761 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m13:58:50.905752 [debug] [ThreadPool]: On list_flights_demo: Close
[0m13:58:50.908327 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo_flights_wh'
[0m13:58:50.914313 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m13:58:50.914313 [debug] [ThreadPool]: On list_flights_demo_flights_wh: BEGIN
[0m13:58:50.915310 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:58:51.084633 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:58:51.085632 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m13:58:51.085632 [debug] [ThreadPool]: On list_flights_demo_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo_flights_wh"} */
select
      'flights_demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m13:58:51.093886 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m13:58:51.094926 [debug] [ThreadPool]: On list_flights_demo_flights_wh: ROLLBACK
[0m13:58:51.095944 [debug] [ThreadPool]: On list_flights_demo_flights_wh: Close
[0m13:58:51.100870 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:51.101867 [debug] [MainThread]: On master: BEGIN
[0m13:58:51.101867 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:58:51.146369 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:58:51.146369 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:51.147408 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:58:51.171081 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m13:58:51.174110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '737bcdc9-ce61-459b-bf9f-eef6511ec811', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD1178E210>]}
[0m13:58:51.174110 [debug] [MainThread]: On master: ROLLBACK
[0m13:58:51.175109 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:51.175109 [debug] [MainThread]: On master: BEGIN
[0m13:58:51.176107 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:58:51.177066 [debug] [MainThread]: On master: COMMIT
[0m13:58:51.177066 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:51.177066 [debug] [MainThread]: On master: COMMIT
[0m13:58:51.178063 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:58:51.178063 [debug] [MainThread]: On master: Close
[0m13:58:51.179060 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:58:51.181055 [info ] [MainThread]: 
[0m13:58:51.186979 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_Airport
[0m13:58:51.186979 [info ] [Thread-1 (]: 1 of 4 START sql incremental model flights_wh.Dim_Airport ...................... [RUN]
[0m13:58:51.189355 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flights_dbt.Dim_Airport'
[0m13:58:51.190343 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_Airport
[0m13:58:51.194331 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_Airport"
[0m13:58:51.196328 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (compile): 13:58:51.190343 => 13:58:51.195364
[0m13:58:51.197323 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_Airport
[0m13:58:51.259195 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m13:58:51.259195 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

    
  
    

  create temporary table "Dim_Airport__dbt_tmp135851229275"
  
  
    as
  
  (
    

select *,
    jsonb_extract_path(airport_name, 'en' )as airport_name_eng, 
    jsonb_extract_path(city, 'en' )as city_eng,
    jsonb_extract_path(airport_name, 'ru' )as airport_name_rus,
    jsonb_extract_path(city, 'en' )as city_rus,

'2023-08-16 10:58:50'::timestamp as dbt_time

from stg.airports_data
  );
  
  
[0m13:58:51.260155 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:58:51.425328 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m13:58:51.432344 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m13:58:51.432344 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: BEGIN
[0m13:58:51.433307 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:58:51.434343 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m13:58:51.434343 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport__dbt_tmp135851229275'
        
      order by ordinal_position

  
[0m13:58:51.451779 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m13:58:51.457761 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m13:58:51.458758 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m13:58:51.462786 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m13:58:51.472721 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m13:58:51.473718 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m13:58:51.476747 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m13:58:51.495660 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_Airport"
[0m13:58:51.496657 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m13:58:51.497655 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      
        
            delete from "flights_demo"."flights_wh"."Dim_Airport"
            where (
                airport_code) in (
                select (airport_code)
                from "Dim_Airport__dbt_tmp135851229275"
            );

        
    

    insert into "flights_demo"."flights_wh"."Dim_Airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time"
        from "Dim_Airport__dbt_tmp135851229275"
    )
  
[0m13:58:51.501290 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m13:58:51.515309 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m13:58:51.516294 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m13:58:51.516294 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m13:58:51.520201 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:58:51.521245 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (execute): 13:58:51.197323 => 13:58:51.521245
[0m13:58:51.522235 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: Close
[0m13:58:51.523195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '737bcdc9-ce61-459b-bf9f-eef6511ec811', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD12255450>]}
[0m13:58:51.524195 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model flights_wh.Dim_Airport ................. [[32mINSERT 0 104[0m in 0.33s]
[0m13:58:51.526189 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_Airport
[0m13:58:51.526189 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_aircraft
[0m13:58:51.527186 [info ] [Thread-1 (]: 2 of 4 START sql incremental model flights_wh.Dim_aircraft ..................... [RUN]
[0m13:58:51.528183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_Airport, now model.flights_dbt.Dim_aircraft)
[0m13:58:51.529180 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_aircraft
[0m13:58:51.532171 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_aircraft"
[0m13:58:51.533169 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (compile): 13:58:51.529180 => 13:58:51.533169
[0m13:58:51.533169 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_aircraft
[0m13:58:51.538155 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_aircraft"
[0m13:58:51.539152 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m13:58:51.540150 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: BEGIN
[0m13:58:51.540150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:51.589816 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:58:51.590851 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m13:58:51.590851 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      
  
    

  create  table "flights_demo"."flights_wh"."Dim_aircraft"
  
  
    as
  
  (
    

select *,
    case when range >= 5600 then 'High'
        when range < 5600 then 'Low'
        else 'Null'
        end as range_L_H,
    jsonb_extract_path(model, 'en' )as Model_English,
    jsonb_extract_path(model, 'ru' )as Model_Russian,

'2023-08-16 10:58:50'::timestamp as dbt_time

from flights_demo.stg.aircrafts_data ad 
join seats s 
	on s.aircraft_code = ad.aircraft_code
  );
  
  
[0m13:58:51.594681 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "seats" does not exist
LINE 26: join seats s 
              ^

[0m13:58:51.594681 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: ROLLBACK
[0m13:58:51.595680 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (execute): 13:58:51.534166 => 13:58:51.595680
[0m13:58:51.596679 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: Close
[0m13:58:51.609942 [debug] [Thread-1 (]: Database Error in model Dim_aircraft (models\dimension\Dim_aircraft.sql)
  relation "seats" does not exist
  LINE 26: join seats s 
                ^
  compiled Code at target\run\flights_dbt\models\dimension\Dim_aircraft.sql
[0m13:58:51.609942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '737bcdc9-ce61-459b-bf9f-eef6511ec811', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD12270610>]}
[0m13:58:51.610940 [error] [Thread-1 (]: 2 of 4 ERROR creating sql incremental model flights_wh.Dim_aircraft ............ [[31mERROR[0m in 0.08s]
[0m13:58:51.611745 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_aircraft
[0m13:58:51.612745 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m13:58:51.612745 [info ] [Thread-1 (]: 3 of 4 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m13:58:51.614741 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_aircraft, now model.flights_dbt.my_first_dbt_model)
[0m13:58:51.614741 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m13:58:51.619771 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m13:58:51.620764 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 13:58:51.615777 => 13:58:51.620764
[0m13:58:51.621725 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m13:58:51.633725 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m13:58:51.635685 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m13:58:51.636719 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m13:58:51.637724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:51.684222 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:58:51.685221 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m13:58:51.685221 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m13:58:51.694989 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m13:58:51.701012 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m13:58:51.701974 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m13:58:51.704295 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:58:51.707290 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m13:58:51.707290 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m13:58:51.709285 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:58:51.716266 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m13:58:51.717276 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m13:58:51.717276 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m13:58:51.719259 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:58:51.724245 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m13:58:51.724245 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_demo"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m13:58:51.727824 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m13:58:51.729858 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 13:58:51.621725 => 13:58:51.728823
[0m13:58:51.729858 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m13:58:51.730849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '737bcdc9-ce61-459b-bf9f-eef6511ec811', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD12198890>]}
[0m13:58:51.731814 [info ] [Thread-1 (]: 3 of 4 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.12s]
[0m13:58:51.733810 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m13:58:51.734823 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m13:58:51.735806 [info ] [Thread-1 (]: 4 of 4 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m13:58:51.736801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m13:58:51.737798 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m13:58:51.740790 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m13:58:51.741788 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 13:58:51.737798 => 13:58:51.740790
[0m13:58:51.741788 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m13:58:51.761734 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m13:58:51.762732 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m13:58:51.762732 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m13:58:51.763729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:51.807737 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:58:51.808775 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m13:58:51.808775 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_demo"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m13:58:51.814500 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:58:51.817520 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m13:58:51.818492 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m13:58:51.820487 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:58:51.822518 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m13:58:51.822518 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m13:58:51.823477 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m13:58:51.826487 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:58:51.829483 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m13:58:51.829483 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m13:58:51.830981 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:58:51.831982 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 13:58:51.742802 => 13:58:51.831982
[0m13:58:51.833012 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m13:58:51.833976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '737bcdc9-ce61-459b-bf9f-eef6511ec811', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD1221D510>]}
[0m13:58:51.834974 [info ] [Thread-1 (]: 4 of 4 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.10s]
[0m13:58:51.837965 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m13:58:51.839994 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:51.839994 [debug] [MainThread]: On master: BEGIN
[0m13:58:51.840959 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:58:51.883644 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:58:51.883644 [debug] [MainThread]: On master: COMMIT
[0m13:58:51.884692 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:51.885641 [debug] [MainThread]: On master: COMMIT
[0m13:58:51.886656 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:58:51.887635 [debug] [MainThread]: On master: Close
[0m13:58:51.889660 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:58:51.890627 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m13:58:51.890627 [debug] [MainThread]: Connection 'list_flights_demo_flights_wh' was properly closed.
[0m13:58:51.891623 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m13:58:51.891623 [info ] [MainThread]: 
[0m13:58:51.892620 [info ] [MainThread]: Finished running 2 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m13:58:51.894642 [debug] [MainThread]: Command end result
[0m13:58:51.900200 [info ] [MainThread]: 
[0m13:58:51.902200 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:58:51.904194 [info ] [MainThread]: 
[0m13:58:51.905216 [error] [MainThread]: [33mDatabase Error in model Dim_aircraft (models\dimension\Dim_aircraft.sql)[0m
[0m13:58:51.906189 [error] [MainThread]:   relation "seats" does not exist
[0m13:58:51.907188 [error] [MainThread]:   LINE 26: join seats s 
[0m13:58:51.909183 [error] [MainThread]:                 ^
[0m13:58:51.910191 [error] [MainThread]:   compiled Code at target\run\flights_dbt\models\dimension\Dim_aircraft.sql
[0m13:58:51.911175 [info ] [MainThread]: 
[0m13:58:51.912173 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m13:58:51.913170 [debug] [MainThread]: Command `dbt run` failed at 13:58:51.913170 after 1.34 seconds
[0m13:58:51.914206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD11C7F5D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD0B51E050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD0B51EB90>]}
[0m13:58:51.915213 [debug] [MainThread]: Flushing usage events
[0m13:59:59.849587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AC1C1ED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ABF8AAAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AC1F93210>]}


============================== 13:59:59.854607 | c92689af-a09f-491e-875a-e875f418fb66 ==============================
[0m13:59:59.854607 [info ] [MainThread]: Running with dbt=1.5.3
[0m13:59:59.855605 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m13:59:59.928633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c92689af-a09f-491e-875a-e875f418fb66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AC1C0B450>]}
[0m13:59:59.943594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c92689af-a09f-491e-875a-e875f418fb66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AC1FFC550>]}
[0m13:59:59.945575 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m13:59:59.956547 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:00:00.035641 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:00:00.035641 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models\dimension\Dim_aircraft.sql
[0m14:00:00.059571 [debug] [MainThread]: 1603: static parser failed on dimension\Dim_aircraft.sql
[0m14:00:00.074510 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimension\Dim_aircraft.sql
[0m14:00:00.083525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c92689af-a09f-491e-875a-e875f418fb66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AC26745D0>]}
[0m14:00:00.091466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c92689af-a09f-491e-875a-e875f418fb66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AC1F01950>]}
[0m14:00:00.091466 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:00:00.092466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c92689af-a09f-491e-875a-e875f418fb66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ABE373090>]}
[0m14:00:00.094491 [info ] [MainThread]: 
[0m14:00:00.095455 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:00:00.097484 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m14:00:00.108423 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m14:00:00.109418 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m14:00:00.109418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:00.162276 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m14:00:00.164299 [debug] [ThreadPool]: On list_flights_demo: Close
[0m14:00:00.166266 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo_flights_wh'
[0m14:00:00.173248 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m14:00:00.174280 [debug] [ThreadPool]: On list_flights_demo_flights_wh: BEGIN
[0m14:00:00.174280 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:00.215114 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:00:00.216110 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m14:00:00.216110 [debug] [ThreadPool]: On list_flights_demo_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo_flights_wh"} */
select
      'flights_demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m14:00:00.222092 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m14:00:00.224118 [debug] [ThreadPool]: On list_flights_demo_flights_wh: ROLLBACK
[0m14:00:00.225085 [debug] [ThreadPool]: On list_flights_demo_flights_wh: Close
[0m14:00:00.230070 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:00.231067 [debug] [MainThread]: On master: BEGIN
[0m14:00:00.231067 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:00:00.270293 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:00:00.271309 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:00.271309 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:00:00.292502 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m14:00:00.294458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c92689af-a09f-491e-875a-e875f418fb66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ABE3732D0>]}
[0m14:00:00.295454 [debug] [MainThread]: On master: ROLLBACK
[0m14:00:00.295454 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:00.296490 [debug] [MainThread]: On master: BEGIN
[0m14:00:00.297450 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:00:00.297450 [debug] [MainThread]: On master: COMMIT
[0m14:00:00.297450 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:00.298448 [debug] [MainThread]: On master: COMMIT
[0m14:00:00.298448 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:00:00.299475 [debug] [MainThread]: On master: Close
[0m14:00:00.300444 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:00:00.301440 [info ] [MainThread]: 
[0m14:00:00.307070 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_Airport
[0m14:00:00.308102 [info ] [Thread-1 (]: 1 of 4 START sql incremental model flights_wh.Dim_Airport ...................... [RUN]
[0m14:00:00.309069 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flights_dbt.Dim_Airport'
[0m14:00:00.310065 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_Airport
[0m14:00:00.314056 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_Airport"
[0m14:00:00.316054 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (compile): 14:00:00.310065 => 14:00:00.315116
[0m14:00:00.317071 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_Airport
[0m14:00:00.378881 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m14:00:00.379878 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

    
  
    

  create temporary table "Dim_Airport__dbt_tmp140000347963"
  
  
    as
  
  (
    

select *,
    jsonb_extract_path(airport_name, 'en' )as airport_name_eng, 
    jsonb_extract_path(city, 'en' )as city_eng,
    jsonb_extract_path(airport_name, 'ru' )as airport_name_rus,
    jsonb_extract_path(city, 'en' )as city_rus,

'2023-08-16 10:59:59'::timestamp as dbt_time

from stg.airports_data
  );
  
  
[0m14:00:00.379878 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:00:00.565697 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m14:00:00.572715 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m14:00:00.573714 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: BEGIN
[0m14:00:00.574675 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:00:00.575711 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m14:00:00.575711 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport__dbt_tmp140000347963'
        
      order by ordinal_position

  
[0m14:00:00.592666 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m14:00:00.597666 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m14:00:00.598655 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m14:00:00.602648 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m14:00:00.610620 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m14:00:00.610620 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m14:00:00.614615 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m14:00:00.631566 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_Airport"
[0m14:00:00.632523 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m14:00:00.633521 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      
        
            delete from "flights_demo"."flights_wh"."Dim_Airport"
            where (
                airport_code) in (
                select (airport_code)
                from "Dim_Airport__dbt_tmp140000347963"
            );

        
    

    insert into "flights_demo"."flights_wh"."Dim_Airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time"
        from "Dim_Airport__dbt_tmp140000347963"
    )
  
[0m14:00:00.637952 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m14:00:00.651956 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m14:00:00.652915 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m14:00:00.652915 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m14:00:00.654919 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:00:00.655978 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (execute): 14:00:00.317071 => 14:00:00.655978
[0m14:00:00.656940 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: Close
[0m14:00:00.657938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c92689af-a09f-491e-875a-e875f418fb66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AC26AD4D0>]}
[0m14:00:00.658931 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model flights_wh.Dim_Airport ................. [[32mINSERT 0 104[0m in 0.35s]
[0m14:00:00.660894 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_Airport
[0m14:00:00.660894 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_aircraft
[0m14:00:00.661972 [info ] [Thread-1 (]: 2 of 4 START sql incremental model flights_wh.Dim_aircraft ..................... [RUN]
[0m14:00:00.662662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_Airport, now model.flights_dbt.Dim_aircraft)
[0m14:00:00.663697 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_aircraft
[0m14:00:00.666688 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_aircraft"
[0m14:00:00.667653 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (compile): 14:00:00.663697 => 14:00:00.667653
[0m14:00:00.667653 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_aircraft
[0m14:00:00.675631 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_aircraft"
[0m14:00:00.677672 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m14:00:00.678624 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: BEGIN
[0m14:00:00.678624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:00.726278 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:00:00.727277 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m14:00:00.727277 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      
  
    

  create  table "flights_demo"."flights_wh"."Dim_aircraft"
  
  
    as
  
  (
    

select *,
    case when range >= 5600 then 'High'
        when range < 5600 then 'Low'
        else 'Null'
        end as range_L_H,
    jsonb_extract_path(model, 'en' )as Model_English,
    jsonb_extract_path(model, 'ru' )as Model_Russian,

'2023-08-16 10:59:59'::timestamp as dbt_time

from flights_demo.stg.aircrafts_data ad 
join flights_demo.stg.seats s 
	on s.aircraft_code = ad.aircraft_code
  );
  
  
[0m14:00:00.735407 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "aircraft_code" specified more than once

[0m14:00:00.735407 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: ROLLBACK
[0m14:00:00.736407 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (execute): 14:00:00.668650 => 14:00:00.736407
[0m14:00:00.737405 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: Close
[0m14:00:00.744420 [debug] [Thread-1 (]: Database Error in model Dim_aircraft (models\dimension\Dim_aircraft.sql)
  column "aircraft_code" specified more than once
  compiled Code at target\run\flights_dbt\models\dimension\Dim_aircraft.sql
[0m14:00:00.745419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c92689af-a09f-491e-875a-e875f418fb66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AC2714790>]}
[0m14:00:00.745419 [error] [Thread-1 (]: 2 of 4 ERROR creating sql incremental model flights_wh.Dim_aircraft ............ [[31mERROR[0m in 0.08s]
[0m14:00:00.746716 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_aircraft
[0m14:00:00.747751 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m14:00:00.748713 [info ] [Thread-1 (]: 3 of 4 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m14:00:00.749228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_aircraft, now model.flights_dbt.my_first_dbt_model)
[0m14:00:00.750271 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m14:00:00.754217 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m14:00:00.756216 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 14:00:00.750271 => 14:00:00.755253
[0m14:00:00.756216 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m14:00:00.769213 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m14:00:00.772173 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m14:00:00.772173 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m14:00:00.773173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:00.945506 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:00:00.946538 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m14:00:00.946538 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:00:00.952103 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m14:00:00.958128 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m14:00:00.959125 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:00:00.960151 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:00:00.963145 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m14:00:00.963145 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:00:00.964142 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:00:00.972122 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m14:00:00.973119 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m14:00:00.973119 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m14:00:00.978339 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:00:00.983328 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m14:00:00.984325 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_demo"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m14:00:00.987833 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:00:00.989869 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 14:00:00.756216 => 14:00:00.989869
[0m14:00:00.989869 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m14:00:00.990865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c92689af-a09f-491e-875a-e875f418fb66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AC1F87CD0>]}
[0m14:00:00.991825 [info ] [Thread-1 (]: 3 of 4 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.24s]
[0m14:00:00.993965 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m14:00:00.994976 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m14:00:00.995959 [info ] [Thread-1 (]: 4 of 4 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m14:00:00.996956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m14:00:00.997954 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m14:00:00.999991 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m14:00:01.001944 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 14:00:00.997954 => 14:00:01.000982
[0m14:00:01.001944 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m14:00:01.022888 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m14:00:01.024883 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m14:00:01.024883 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m14:00:01.025880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:00:01.177222 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:00:01.178260 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m14:00:01.178260 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_demo"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m14:00:01.184856 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:00:01.187851 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m14:00:01.188848 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:00:01.189846 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:00:01.191839 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m14:00:01.191839 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m14:00:01.192837 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m14:00:01.197328 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:00:01.199325 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m14:00:01.200322 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m14:00:01.201321 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:00:01.203315 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 14:00:01.001944 => 14:00:01.202333
[0m14:00:01.203315 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m14:00:01.205324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c92689af-a09f-491e-875a-e875f418fb66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AC27E8810>]}
[0m14:00:01.206308 [info ] [Thread-1 (]: 4 of 4 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.21s]
[0m14:00:01.207304 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m14:00:01.209014 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:01.210015 [debug] [MainThread]: On master: BEGIN
[0m14:00:01.210015 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:00:01.257064 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:00:01.258102 [debug] [MainThread]: On master: COMMIT
[0m14:00:01.258102 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:01.259062 [debug] [MainThread]: On master: COMMIT
[0m14:00:01.259062 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:00:01.260061 [debug] [MainThread]: On master: Close
[0m14:00:01.260061 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:00:01.261058 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m14:00:01.261058 [debug] [MainThread]: Connection 'list_flights_demo_flights_wh' was properly closed.
[0m14:00:01.262055 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m14:00:01.262055 [info ] [MainThread]: 
[0m14:00:01.263054 [info ] [MainThread]: Finished running 2 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 1.17 seconds (1.17s).
[0m14:00:01.265081 [debug] [MainThread]: Command end result
[0m14:00:01.272034 [info ] [MainThread]: 
[0m14:00:01.272838 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:00:01.273840 [info ] [MainThread]: 
[0m14:00:01.274837 [error] [MainThread]: [33mDatabase Error in model Dim_aircraft (models\dimension\Dim_aircraft.sql)[0m
[0m14:00:01.275833 [error] [MainThread]:   column "aircraft_code" specified more than once
[0m14:00:01.277829 [error] [MainThread]:   compiled Code at target\run\flights_dbt\models\dimension\Dim_aircraft.sql
[0m14:00:01.278825 [info ] [MainThread]: 
[0m14:00:01.280838 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m14:00:01.282137 [debug] [MainThread]: Command `dbt run` failed at 14:00:01.282137 after 1.45 seconds
[0m14:00:01.283172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AC1CBD310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028AC19E5090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028ABB9EE050>]}
[0m14:00:01.283172 [debug] [MainThread]: Flushing usage events
[0m14:03:02.769670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002232D46EC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002232D179CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002232D449810>]}


============================== 14:03:02.773697 | c54c7a07-75fd-419d-833c-8962ba34fb2a ==============================
[0m14:03:02.773697 [info ] [MainThread]: Running with dbt=1.5.3
[0m14:03:02.774657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m14:03:02.855401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c54c7a07-75fd-419d-833c-8962ba34fb2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002232D21B990>]}
[0m14:03:02.871390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c54c7a07-75fd-419d-833c-8962ba34fb2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002232D551F50>]}
[0m14:03:02.873353 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m14:03:02.884323 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m14:03:02.975404 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:03:02.976365 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models\dimension\Dim_aircraft.sql
[0m14:03:02.998847 [debug] [MainThread]: 1603: static parser failed on dimension\Dim_aircraft.sql
[0m14:03:03.013204 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimension\Dim_aircraft.sql
[0m14:03:03.024167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c54c7a07-75fd-419d-833c-8962ba34fb2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002232CF46FD0>]}
[0m14:03:03.031463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c54c7a07-75fd-419d-833c-8962ba34fb2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002232DD1C210>]}
[0m14:03:03.031463 [info ] [MainThread]: Found 4 models, 6 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m14:03:03.033460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c54c7a07-75fd-419d-833c-8962ba34fb2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002232DC06950>]}
[0m14:03:03.034492 [info ] [MainThread]: 
[0m14:03:03.036452 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:03:03.038474 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m14:03:03.048448 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m14:03:03.048448 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m14:03:03.049443 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:03:03.272885 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m14:03:03.274879 [debug] [ThreadPool]: On list_flights_demo: Close
[0m14:03:03.276878 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo_flights_wh'
[0m14:03:03.283866 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m14:03:03.284853 [debug] [ThreadPool]: On list_flights_demo_flights_wh: BEGIN
[0m14:03:03.284853 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:03:03.468836 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:03:03.469876 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m14:03:03.469876 [debug] [ThreadPool]: On list_flights_demo_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo_flights_wh"} */
select
      'flights_demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m14:03:03.478363 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m14:03:03.479363 [debug] [ThreadPool]: On list_flights_demo_flights_wh: ROLLBACK
[0m14:03:03.480359 [debug] [ThreadPool]: On list_flights_demo_flights_wh: Close
[0m14:03:03.485387 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:03.486384 [debug] [MainThread]: On master: BEGIN
[0m14:03:03.486384 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:03:03.530042 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:03:03.530042 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:03.531040 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:03:03.557146 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m14:03:03.559142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c54c7a07-75fd-419d-833c-8962ba34fb2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002232D22E690>]}
[0m14:03:03.559142 [debug] [MainThread]: On master: ROLLBACK
[0m14:03:03.560138 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:03.561137 [debug] [MainThread]: On master: BEGIN
[0m14:03:03.562138 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:03:03.562138 [debug] [MainThread]: On master: COMMIT
[0m14:03:03.563131 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:03.563131 [debug] [MainThread]: On master: COMMIT
[0m14:03:03.564128 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:03:03.564128 [debug] [MainThread]: On master: Close
[0m14:03:03.565126 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:03:03.566123 [info ] [MainThread]: 
[0m14:03:03.572351 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_Airport
[0m14:03:03.573351 [info ] [Thread-1 (]: 1 of 4 START sql incremental model flights_wh.Dim_Airport ...................... [RUN]
[0m14:03:03.575346 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flights_dbt.Dim_Airport'
[0m14:03:03.575346 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_Airport
[0m14:03:03.580332 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_Airport"
[0m14:03:03.581330 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (compile): 14:03:03.576341 => 14:03:03.581330
[0m14:03:03.582325 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_Airport
[0m14:03:03.640172 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m14:03:03.641168 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

    
  
    

  create temporary table "Dim_Airport__dbt_tmp140303611248"
  
  
    as
  
  (
    

select *,
    jsonb_extract_path(airport_name, 'en' )as airport_name_eng, 
    jsonb_extract_path(city, 'en' )as city_eng,
    jsonb_extract_path(airport_name, 'ru' )as airport_name_rus,
    jsonb_extract_path(city, 'en' )as city_rus,

'2023-08-16 11:03:02'::timestamp as dbt_time

from stg.airports_data
  );
  
  
[0m14:03:03.642165 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:03:03.712997 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m14:03:03.720961 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m14:03:03.721926 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: BEGIN
[0m14:03:03.722944 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:03:03.722944 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m14:03:03.723920 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport__dbt_tmp140303611248'
        
      order by ordinal_position

  
[0m14:03:03.741632 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m14:03:03.746662 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m14:03:03.747617 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m14:03:03.751622 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m14:03:03.758606 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m14:03:03.759603 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m14:03:03.763593 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m14:03:03.780547 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_Airport"
[0m14:03:03.782542 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m14:03:03.782542 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      
        
            delete from "flights_demo"."flights_wh"."Dim_Airport"
            where (
                airport_code) in (
                select (airport_code)
                from "Dim_Airport__dbt_tmp140303611248"
            );

        
    

    insert into "flights_demo"."flights_wh"."Dim_Airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time"
        from "Dim_Airport__dbt_tmp140303611248"
    )
  
[0m14:03:03.791856 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m14:03:03.806854 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m14:03:03.806854 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m14:03:03.807816 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m14:03:03.810336 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:03:03.811336 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (execute): 14:03:03.582325 => 14:03:03.811336
[0m14:03:03.811336 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: Close
[0m14:03:03.812335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c54c7a07-75fd-419d-833c-8962ba34fb2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002232D17B910>]}
[0m14:03:03.814328 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model flights_wh.Dim_Airport ................. [[32mINSERT 0 104[0m in 0.24s]
[0m14:03:03.816324 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_Airport
[0m14:03:03.816324 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_aircraft
[0m14:03:03.817322 [info ] [Thread-1 (]: 2 of 4 START sql incremental model flights_wh.Dim_aircraft ..................... [RUN]
[0m14:03:03.819314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_Airport, now model.flights_dbt.Dim_aircraft)
[0m14:03:03.819314 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_aircraft
[0m14:03:03.822341 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_aircraft"
[0m14:03:03.823345 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (compile): 14:03:03.820345 => 14:03:03.823345
[0m14:03:03.824301 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_aircraft
[0m14:03:03.829290 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_aircraft"
[0m14:03:03.831284 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m14:03:03.832281 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: BEGIN
[0m14:03:03.833280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:03:04.003264 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:03:04.004304 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m14:03:04.004304 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      
  
    

  create  table "flights_demo"."flights_wh"."Dim_aircraft"
  
  
    as
  
  (
    

select 
    ad.aircraft_code,
    ad.model,
    ad.range,
    ad.last_update,

    s. seat_no,
    s.fare_conditions,
    
    case when range >= 5600 then 'High'
        when range < 5600 then 'Low'
        else 'Null'
        end as range_L_H,
    jsonb_extract_path(model, 'en' )as Model_English,
    jsonb_extract_path(model, 'ru' )as Model_Russian,

'2023-08-16 11:03:02'::timestamp as dbt_time

from flights_demo.stg.aircrafts_data ad 
join flights_demo.stg.seats s 
	on s.aircraft_code = ad.aircraft_code
  );
  
  
[0m14:03:04.021832 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m14:03:04.026787 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m14:03:04.027784 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m14:03:04.027784 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m14:03:04.030496 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:03:04.031440 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (execute): 14:03:03.824301 => 14:03:04.031440
[0m14:03:04.032436 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: Close
[0m14:03:04.033435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c54c7a07-75fd-419d-833c-8962ba34fb2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002232DD3BB50>]}
[0m14:03:04.034434 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model flights_wh.Dim_aircraft ................ [[32mSELECT 1339[0m in 0.22s]
[0m14:03:04.035430 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_aircraft
[0m14:03:04.036426 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m14:03:04.036426 [info ] [Thread-1 (]: 3 of 4 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m14:03:04.037798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_aircraft, now model.flights_dbt.my_first_dbt_model)
[0m14:03:04.038842 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m14:03:04.042826 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m14:03:04.044784 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 14:03:04.038842 => 14:03:04.043823
[0m14:03:04.044784 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m14:03:04.059775 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m14:03:04.061738 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m14:03:04.061738 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m14:03:04.062736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:03:04.107776 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:03:04.108776 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m14:03:04.108776 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m14:03:04.114423 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m14:03:04.122401 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m14:03:04.122401 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m14:03:04.125065 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:03:04.128057 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m14:03:04.128057 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m14:03:04.129054 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:03:04.134042 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m14:03:04.135041 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m14:03:04.135041 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m14:03:04.137339 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:03:04.142328 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m14:03:04.143325 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_demo"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m14:03:04.147698 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m14:03:04.149696 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 14:03:04.045819 => 14:03:04.148698
[0m14:03:04.149696 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m14:03:04.151691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c54c7a07-75fd-419d-833c-8962ba34fb2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002232DD5CFD0>]}
[0m14:03:04.152689 [info ] [Thread-1 (]: 3 of 4 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.11s]
[0m14:03:04.154683 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m14:03:04.155680 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m14:03:04.155680 [info ] [Thread-1 (]: 4 of 4 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m14:03:04.158045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m14:03:04.158045 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m14:03:04.161070 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m14:03:04.162035 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 14:03:04.158045 => 14:03:04.161070
[0m14:03:04.162035 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m14:03:04.182021 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m14:03:04.182978 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m14:03:04.182978 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m14:03:04.183976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:03:04.343480 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:03:04.344445 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m14:03:04.344445 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_demo"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m14:03:04.353552 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:03:04.356581 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m14:03:04.356581 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m14:03:04.358539 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:03:04.360571 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m14:03:04.360571 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m14:03:04.360571 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m14:03:04.363067 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:03:04.365064 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m14:03:04.366061 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m14:03:04.367147 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:03:04.369186 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 14:03:04.163031 => 14:03:04.368193
[0m14:03:04.369186 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m14:03:04.370183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c54c7a07-75fd-419d-833c-8962ba34fb2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002232DC61AD0>]}
[0m14:03:04.371141 [info ] [Thread-1 (]: 4 of 4 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.21s]
[0m14:03:04.373133 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m14:03:04.375131 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:04.375131 [debug] [MainThread]: On master: BEGIN
[0m14:03:04.376159 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:03:04.419980 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:03:04.421978 [debug] [MainThread]: On master: COMMIT
[0m14:03:04.421978 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:04.422970 [debug] [MainThread]: On master: COMMIT
[0m14:03:04.423719 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:03:04.423719 [debug] [MainThread]: On master: Close
[0m14:03:04.424718 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:03:04.424718 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m14:03:04.425716 [debug] [MainThread]: Connection 'list_flights_demo_flights_wh' was properly closed.
[0m14:03:04.425716 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m14:03:04.427488 [info ] [MainThread]: 
[0m14:03:04.428101 [info ] [MainThread]: Finished running 2 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 1.39 seconds (1.39s).
[0m14:03:04.430317 [debug] [MainThread]: Command end result
[0m14:03:04.439265 [info ] [MainThread]: 
[0m14:03:04.440260 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:03:04.441256 [info ] [MainThread]: 
[0m14:03:04.442254 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:03:04.443250 [debug] [MainThread]: Command `dbt run` succeeded at 14:03:04.443250 after 1.69 seconds
[0m14:03:04.444276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002232D0D4BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002232AA4DAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002232D18FE10>]}
[0m14:03:04.444276 [debug] [MainThread]: Flushing usage events
[0m15:12:50.191329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002740BD9C2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002740BE10110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002740BB2E390>]}


============================== 15:12:50.203745 | ebf2bc71-0f43-43b9-ac42-832a3973a5bc ==============================
[0m15:12:50.203745 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:12:50.208772 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:12:50.414846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ebf2bc71-0f43-43b9-ac42-832a3973a5bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002740BD42E90>]}
[0m15:12:50.445767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ebf2bc71-0f43-43b9-ac42-832a3973a5bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002740BD42E90>]}
[0m15:12:50.449377 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:12:50.471318 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:12:50.635775 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading flights_dbt: dimension\schema.yml - Runtime Error
    Syntax error near line 5
    ------------------------------
    2  | 
    3  | models:
    4  |   - name: Dim_Airport
    5  |       description: "Name of Airports & Cities"
    6  |       columns:
    7  |         - name: airport_code
    8  |           description: "The primary key for this table"
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 5, column 18
[0m15:12:50.651732 [debug] [MainThread]: Command `dbt run` failed at 15:12:50.650795 after 0.53 seconds
[0m15:12:50.653776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002740BE6D310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002740BB54510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002740BD6E650>]}
[0m15:12:50.656758 [debug] [MainThread]: Flushing usage events
[0m15:16:44.476166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001424770F590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014247749710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014247B32FD0>]}


============================== 15:16:44.485144 | 7a5ec851-b20d-439a-9443-eb1a44f40e7c ==============================
[0m15:16:44.485144 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:16:44.488136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:16:44.656687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a5ec851-b20d-439a-9443-eb1a44f40e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000142477FD010>]}
[0m15:16:44.695613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a5ec851-b20d-439a-9443-eb1a44f40e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014247AD1D10>]}
[0m15:16:44.698573 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:16:44.730490 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:16:44.971843 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 2 files changed.
[0m15:16:44.974846 [debug] [MainThread]: Partial parsing: added file: flights_dbt://models\dimension\schema.yml
[0m15:16:44.976832 [debug] [MainThread]: Partial parsing: added file: flights_dbt://models\Facts\Fact_flights.sql
[0m15:16:44.978828 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models\example\schema.yml
[0m15:16:44.979924 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models\dimension\Dim_aircraft.sql
[0m15:16:45.052717 [debug] [MainThread]: 1699: static parser successfully parsed Facts\Fact_flights.sql
[0m15:16:45.108478 [debug] [MainThread]: 1603: static parser failed on dimension\Dim_Airport.sql
[0m15:16:45.127427 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimension\Dim_Airport.sql
[0m15:16:45.134446 [debug] [MainThread]: 1603: static parser failed on dimension\Dim_aircraft.sql
[0m15:16:45.147373 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimension\Dim_aircraft.sql
[0m15:16:45.341018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a5ec851-b20d-439a-9443-eb1a44f40e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014248131550>]}
[0m15:16:45.366787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a5ec851-b20d-439a-9443-eb1a44f40e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014248230310>]}
[0m15:16:45.368782 [info ] [MainThread]: Found 5 models, 8 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:16:45.372067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a5ec851-b20d-439a-9443-eb1a44f40e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014243EB3090>]}
[0m15:16:45.378875 [info ] [MainThread]: 
[0m15:16:45.382744 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:16:45.389725 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m15:16:45.462531 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m15:16:45.464528 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m15:16:45.467613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:45.715725 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m15:16:45.721709 [debug] [ThreadPool]: On list_flights_demo: Close
[0m15:16:45.728736 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo_flights_wh'
[0m15:16:45.753627 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m15:16:45.755625 [debug] [ThreadPool]: On list_flights_demo_flights_wh: BEGIN
[0m15:16:45.758619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:45.933127 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:16:45.935123 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m15:16:45.937112 [debug] [ThreadPool]: On list_flights_demo_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo_flights_wh"} */
select
      'flights_demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m15:16:45.985761 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:16:45.991968 [debug] [ThreadPool]: On list_flights_demo_flights_wh: ROLLBACK
[0m15:16:45.993990 [debug] [ThreadPool]: On list_flights_demo_flights_wh: Close
[0m15:16:46.016900 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:46.019895 [debug] [MainThread]: On master: BEGIN
[0m15:16:46.021895 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:16:46.191437 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:16:46.193429 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:46.198414 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:16:46.347015 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m15:16:46.352004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a5ec851-b20d-439a-9443-eb1a44f40e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014247E9DB50>]}
[0m15:16:46.353003 [debug] [MainThread]: On master: ROLLBACK
[0m15:16:46.354995 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:46.355995 [debug] [MainThread]: On master: BEGIN
[0m15:16:46.356989 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:16:46.358987 [debug] [MainThread]: On master: COMMIT
[0m15:16:46.359986 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:46.361977 [debug] [MainThread]: On master: COMMIT
[0m15:16:46.362973 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:16:46.364969 [debug] [MainThread]: On master: Close
[0m15:16:46.367960 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:16:46.370954 [info ] [MainThread]: 
[0m15:16:46.388907 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_Airport
[0m15:16:46.390923 [info ] [Thread-1 (]: 1 of 4 START sql incremental model flights_wh.Dim_Airport ...................... [RUN]
[0m15:16:46.399886 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flights_dbt.Dim_Airport'
[0m15:16:46.403881 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_Airport
[0m15:16:46.413838 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_Airport"
[0m15:16:46.423821 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (compile): 15:16:46.406855 => 15:16:46.422586
[0m15:16:46.426803 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_Airport
[0m15:16:46.589368 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m15:16:46.590940 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

    
  
    

  create temporary table "Dim_Airport__dbt_tmp151646524541"
  
  
    as
  
  (
    

select *,
    jsonb_extract_path(airport_name, 'en' )as airport_name_eng, 
    jsonb_extract_path(city, 'en' )as city_eng,
    jsonb_extract_path(airport_name, 'ru' )as airport_name_rus,
    jsonb_extract_path(city, 'en' )as city_rus,

'2023-08-16 12:16:44'::timestamp as dbt_time

from stg.airports_data
  );
  
  
[0m15:16:46.592360 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:16:46.797817 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m15:16:46.822747 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m15:16:46.825342 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: BEGIN
[0m15:16:46.828875 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:16:46.831731 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m15:16:46.834723 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport__dbt_tmp151646524541'
        
      order by ordinal_position

  
[0m15:16:46.936204 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m15:16:46.957143 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m15:16:46.959557 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m15:16:46.974095 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m15:16:47.005014 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m15:16:47.007010 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m15:16:47.023966 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m15:16:47.104754 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_Airport"
[0m15:16:47.113202 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m15:16:47.117715 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      
        
            delete from "flights_demo"."flights_wh"."Dim_Airport"
            where (
                airport_code) in (
                select (airport_code)
                from "Dim_Airport__dbt_tmp151646524541"
            );

        
    

    insert into "flights_demo"."flights_wh"."Dim_Airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time"
        from "Dim_Airport__dbt_tmp151646524541"
    )
  
[0m15:16:47.145637 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m15:16:47.200491 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m15:16:47.201487 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m15:16:47.203483 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m15:16:47.206475 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:16:47.209489 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (execute): 15:16:46.427801 => 15:16:47.208470
[0m15:16:47.211231 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: Close
[0m15:16:47.214455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a5ec851-b20d-439a-9443-eb1a44f40e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000142481A45D0>]}
[0m15:16:47.216449 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model flights_wh.Dim_Airport ................. [[32mINSERT 0 104[0m in 0.82s]
[0m15:16:47.221434 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_Airport
[0m15:16:47.224432 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_aircraft
[0m15:16:47.226603 [info ] [Thread-1 (]: 2 of 4 START sql incremental model flights_wh.Dim_aircraft ..................... [RUN]
[0m15:16:47.234400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_Airport, now model.flights_dbt.Dim_aircraft)
[0m15:16:47.236394 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_aircraft
[0m15:16:47.252361 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_aircraft"
[0m15:16:47.255343 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (compile): 15:16:47.238744 => 15:16:47.254349
[0m15:16:47.256340 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_aircraft
[0m15:16:47.275291 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m15:16:47.277285 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

    
  
    

  create temporary table "Dim_aircraft__dbt_tmp151647268310"
  
  
    as
  
  (
    

select 
    row_number () over() as dim_aircraft_id,

    ad.aircraft_code,
    ad.model,
    ad.range,
    ad.last_update,

    s. seat_no,
    s.fare_conditions,

    case when range >= 5600 then 'High'
        when range < 5600 then 'Low'
        else 'Null'
        end as range_L_H,
    jsonb_extract_path(model, 'en' )as Model_English,
    jsonb_extract_path(model, 'ru' )as Model_Russian,

'2023-08-16 12:16:44'::timestamp as dbt_time

from flights_demo.stg.aircrafts_data ad 
join flights_demo.stg.seats s 
	on s.aircraft_code = ad.aircraft_code
  );
  
  
[0m15:16:47.279284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:47.393975 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m15:16:47.403949 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m15:16:47.406029 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: BEGIN
[0m15:16:47.407935 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:16:47.408971 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m15:16:47.410116 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft__dbt_tmp151647268310'
        
      order by ordinal_position

  
[0m15:16:47.441845 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m15:16:47.448827 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m15:16:47.449823 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m15:16:47.456806 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m15:16:47.462789 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m15:16:47.465005 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m15:16:47.471768 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m15:16:47.477753 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_aircraft"
[0m15:16:47.479764 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m15:16:47.480876 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      
        
            delete from "flights_demo"."flights_wh"."Dim_aircraft"
            where (
                dim_aircraft_id) in (
                select (dim_aircraft_id)
                from "Dim_aircraft__dbt_tmp151647268310"
            );

        
    

    insert into "flights_demo"."flights_wh"."Dim_aircraft" ("aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time")
    (
        select "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time"
        from "Dim_aircraft__dbt_tmp151647268310"
    )
  
[0m15:16:47.486725 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "dim_aircraft_id" does not exist
LINE 7:                 dim_aircraft_id) in (
                        ^

[0m15:16:47.487723 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: ROLLBACK
[0m15:16:47.490714 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (execute): 15:16:47.257441 => 15:16:47.489716
[0m15:16:47.491712 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: Close
[0m15:16:47.509662 [debug] [Thread-1 (]: Database Error in model Dim_aircraft (models\dimension\Dim_aircraft.sql)
  column "dim_aircraft_id" does not exist
  LINE 7:                 dim_aircraft_id) in (
                          ^
  compiled Code at target\run\flights_dbt\models\dimension\Dim_aircraft.sql
[0m15:16:47.510660 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a5ec851-b20d-439a-9443-eb1a44f40e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000142481D4290>]}
[0m15:16:47.511855 [error] [Thread-1 (]: 2 of 4 ERROR creating sql incremental model flights_wh.Dim_aircraft ............ [[31mERROR[0m in 0.28s]
[0m15:16:47.514650 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_aircraft
[0m15:16:47.515647 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m15:16:47.517643 [info ] [Thread-1 (]: 3 of 4 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m15:16:47.520635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_aircraft, now model.flights_dbt.my_first_dbt_model)
[0m15:16:47.521663 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m15:16:47.525652 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m15:16:47.528747 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 15:16:47.522240 => 15:16:47.527615
[0m15:16:47.530611 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m15:16:47.573495 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m15:16:47.577484 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m15:16:47.579481 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m15:16:47.582626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:47.691178 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:16:47.692546 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m15:16:47.693202 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:16:47.704522 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m15:16:47.718008 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m15:16:47.719245 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:16:47.721119 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:16:47.731106 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m15:16:47.732520 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:16:47.735094 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:16:47.762988 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m15:16:47.765121 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m15:16:47.766444 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m15:16:47.769970 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:16:47.782934 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m15:16:47.784929 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_demo"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m15:16:47.824847 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:16:47.828810 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 15:16:47.532605 => 15:16:47.828810
[0m15:16:47.830844 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m15:16:47.832829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a5ec851-b20d-439a-9443-eb1a44f40e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000142487A5990>]}
[0m15:16:47.835830 [info ] [Thread-1 (]: 3 of 4 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.31s]
[0m15:16:47.838784 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m15:16:47.841777 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m15:16:47.843773 [info ] [Thread-1 (]: 4 of 4 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m15:16:47.847765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m15:16:47.849756 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m15:16:47.859730 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m15:16:47.865007 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 15:16:47.850754 => 15:16:47.862725
[0m15:16:47.869705 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m15:16:47.932539 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m15:16:47.935585 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m15:16:47.936926 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m15:16:47.938518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:48.043256 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:16:48.045274 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m15:16:48.046235 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_demo"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m15:16:48.061229 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:16:48.069207 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m15:16:48.070223 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:16:48.073196 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:16:48.077863 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m15:16:48.079146 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m15:16:48.081137 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m15:16:48.084129 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:16:48.091110 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m15:16:48.092656 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m15:16:48.094163 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:16:48.098093 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 15:16:47.872236 => 15:16:48.098093
[0m15:16:48.100087 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m15:16:48.102741 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a5ec851-b20d-439a-9443-eb1a44f40e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001424879A4D0>]}
[0m15:16:48.105073 [info ] [Thread-1 (]: 4 of 4 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.26s]
[0m15:16:48.109065 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m15:16:48.113054 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:48.114115 [debug] [MainThread]: On master: BEGIN
[0m15:16:48.116044 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:16:48.341830 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:16:48.343814 [debug] [MainThread]: On master: COMMIT
[0m15:16:48.345805 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:48.346800 [debug] [MainThread]: On master: COMMIT
[0m15:16:48.348797 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:16:48.350844 [debug] [MainThread]: On master: Close
[0m15:16:48.352785 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:16:48.354980 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m15:16:48.355819 [debug] [MainThread]: Connection 'list_flights_demo_flights_wh' was properly closed.
[0m15:16:48.356776 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m15:16:48.359767 [info ] [MainThread]: 
[0m15:16:48.362763 [info ] [MainThread]: Finished running 2 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 2.98 seconds (2.98s).
[0m15:16:48.367780 [debug] [MainThread]: Command end result
[0m15:16:48.390932 [info ] [MainThread]: 
[0m15:16:48.396683 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:16:48.402660 [info ] [MainThread]: 
[0m15:16:48.405647 [error] [MainThread]: [33mDatabase Error in model Dim_aircraft (models\dimension\Dim_aircraft.sql)[0m
[0m15:16:48.409635 [error] [MainThread]:   column "dim_aircraft_id" does not exist
[0m15:16:48.414634 [error] [MainThread]:   LINE 7:                 dim_aircraft_id) in (
[0m15:16:48.419608 [error] [MainThread]:                           ^
[0m15:16:48.423597 [error] [MainThread]:   compiled Code at target\run\flights_dbt\models\dimension\Dim_aircraft.sql
[0m15:16:48.427585 [info ] [MainThread]: 
[0m15:16:48.433612 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m15:16:48.438735 [debug] [MainThread]: Command `dbt run` failed at 15:16:48.438735 after 4.04 seconds
[0m15:16:48.440552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000142477E7AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014247E8FA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001424150EBD0>]}
[0m15:16:48.443542 [debug] [MainThread]: Flushing usage events
[0m15:18:13.601057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA4C0D2FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA4BD48D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA4BDFCE50>]}


============================== 15:18:13.612496 | 85108c1f-76a8-4ae0-83d1-217535c26410 ==============================
[0m15:18:13.612496 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:18:13.614909 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:18:13.783992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85108c1f-76a8-4ae0-83d1-217535c26410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA4C4A00D0>]}
[0m15:18:13.813912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85108c1f-76a8-4ae0-83d1-217535c26410', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA4C715CD0>]}
[0m15:18:13.815909 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:18:13.843832 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:18:14.309134 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:18:14.313122 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models\dimension\schema.yml
[0m15:18:14.408849 [debug] [MainThread]: 1603: static parser failed on dimension\Dim_aircraft.sql
[0m15:18:14.448525 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimension\Dim_aircraft.sql
[0m15:18:14.477446 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models\dimension\schema.yml @ models: {'name': 'Dim_aircraft', 'description': 'Dim_aircraft', 'columns': [{'name': None, 'description': None, 'tests': None}], 'original_file_path': 'models\\dimension\\schema.yml', 'yaml_key': 'models', 'package_name': 'flights_dbt'} - at path ['columns'][0]['name']: None is not of type 'string'
[0m15:18:14.482383 [debug] [MainThread]: Command `dbt run` failed at 15:18:14.482383 after 0.93 seconds
[0m15:18:14.483427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA4C03F990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA4C785E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA4C496F10>]}
[0m15:18:14.485375 [debug] [MainThread]: Flushing usage events
[0m15:18:53.837338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B6639690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B66C5D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B66B6F50>]}


============================== 15:18:53.848354 | 837eaa90-1faf-4ce6-9c9d-d741d3d0ca89 ==============================
[0m15:18:53.848354 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:18:53.852299 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:18:54.068849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '837eaa90-1faf-4ce6-9c9d-d741d3d0ca89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B3A162D0>]}
[0m15:18:54.097790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '837eaa90-1faf-4ce6-9c9d-d741d3d0ca89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B3A162D0>]}
[0m15:18:54.099510 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:18:54.126453 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:18:54.262094 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:18:54.264040 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models\dimension\schema.yml
[0m15:18:54.305968 [debug] [MainThread]: 1603: static parser failed on dimension\Dim_aircraft.sql
[0m15:18:54.342830 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimension\Dim_aircraft.sql
[0m15:18:54.371752 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models\dimension\schema.yml @ models: {'name': 'Dim_aircraft', 'description': 'Dim_aircraft', 'columns': [{'name': None, 'description': None, 'tests': None}], 'original_file_path': 'models\\dimension\\schema.yml', 'yaml_key': 'models', 'package_name': 'flights_dbt'} - at path ['columns'][0]['name']: None is not of type 'string'
[0m15:18:54.376506 [debug] [MainThread]: Command `dbt run` failed at 15:18:54.376506 after 0.59 seconds
[0m15:18:54.378186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B66B6F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B6D75E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B664CD50>]}
[0m15:18:54.379321 [debug] [MainThread]: Flushing usage events
[0m15:19:30.530993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001872A232FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001872A233250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001872A323250>]}


============================== 15:19:30.538005 | 32ab0477-5915-487b-811b-4a2c3306e046 ==============================
[0m15:19:30.538005 [info ] [MainThread]: Running with dbt=1.5.3
[0m15:19:30.540984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m15:19:30.698442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32ab0477-5915-487b-811b-4a2c3306e046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018729F28710>]}
[0m15:19:30.727362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32ab0477-5915-487b-811b-4a2c3306e046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018729FDC150>]}
[0m15:19:30.729319 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m15:19:30.752294 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m15:19:30.880663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:19:30.882062 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models\dimension\schema.yml
[0m15:19:30.924551 [debug] [MainThread]: 1603: static parser failed on dimension\Dim_aircraft.sql
[0m15:19:30.966399 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimension\Dim_aircraft.sql
[0m15:19:31.006292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32ab0477-5915-487b-811b-4a2c3306e046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001872AAE33D0>]}
[0m15:19:31.026848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32ab0477-5915-487b-811b-4a2c3306e046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001872A9CE490>]}
[0m15:19:31.028843 [info ] [MainThread]: Found 5 models, 6 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m15:19:31.030836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32ab0477-5915-487b-811b-4a2c3306e046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000187266A3110>]}
[0m15:19:31.035355 [info ] [MainThread]: 
[0m15:19:31.039348 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:19:31.044364 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m15:19:31.079266 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m15:19:31.081256 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m15:19:31.083235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:31.238695 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m15:19:31.243044 [debug] [ThreadPool]: On list_flights_demo: Close
[0m15:19:31.247671 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo_flights_wh'
[0m15:19:31.261629 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m15:19:31.262627 [debug] [ThreadPool]: On list_flights_demo_flights_wh: BEGIN
[0m15:19:31.264583 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:31.396232 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m15:19:31.398241 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m15:19:31.399237 [debug] [ThreadPool]: On list_flights_demo_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo_flights_wh"} */
select
      'flights_demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m15:19:31.433313 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m15:19:31.438304 [debug] [ThreadPool]: On list_flights_demo_flights_wh: ROLLBACK
[0m15:19:31.441285 [debug] [ThreadPool]: On list_flights_demo_flights_wh: Close
[0m15:19:31.463185 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:31.465180 [debug] [MainThread]: On master: BEGIN
[0m15:19:31.467173 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:19:31.620608 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:19:31.622602 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:31.624595 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:19:31.748272 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m15:19:31.755253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32ab0477-5915-487b-811b-4a2c3306e046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018729D15690>]}
[0m15:19:31.757248 [debug] [MainThread]: On master: ROLLBACK
[0m15:19:31.759256 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:31.761242 [debug] [MainThread]: On master: BEGIN
[0m15:19:31.764190 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:19:31.765232 [debug] [MainThread]: On master: COMMIT
[0m15:19:31.767227 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:31.769380 [debug] [MainThread]: On master: COMMIT
[0m15:19:31.772171 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:19:31.774202 [debug] [MainThread]: On master: Close
[0m15:19:31.778151 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:19:31.781481 [info ] [MainThread]: 
[0m15:19:31.806078 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_Airport
[0m15:19:31.808071 [info ] [Thread-1 (]: 1 of 4 START sql incremental model flights_wh.Dim_Airport ...................... [RUN]
[0m15:19:31.814053 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flights_dbt.Dim_Airport'
[0m15:19:31.816050 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_Airport
[0m15:19:31.833047 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_Airport"
[0m15:19:31.837993 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (compile): 15:19:31.818047 => 15:19:31.837037
[0m15:19:31.839988 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_Airport
[0m15:19:32.022540 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m15:19:32.024358 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

    
  
    

  create temporary table "Dim_Airport__dbt_tmp151931968686"
  
  
    as
  
  (
    

select *,
    jsonb_extract_path(airport_name, 'en' )as airport_name_eng, 
    jsonb_extract_path(city, 'en' )as city_eng,
    jsonb_extract_path(airport_name, 'ru' )as airport_name_rus,
    jsonb_extract_path(city, 'en' )as city_rus,

'2023-08-16 12:19:30'::timestamp as dbt_time

from stg.airports_data
  );
  
  
[0m15:19:32.024492 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:19:32.192197 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m15:19:32.218169 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m15:19:32.221164 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: BEGIN
[0m15:19:32.224152 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:19:32.227252 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m15:19:32.229136 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport__dbt_tmp151931968686'
        
      order by ordinal_position

  
[0m15:19:32.305144 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m15:19:32.326086 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m15:19:32.328338 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m15:19:32.343044 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m15:19:32.377950 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m15:19:32.379946 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m15:19:32.393860 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m15:19:32.463724 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_Airport"
[0m15:19:32.468667 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m15:19:32.470702 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      
        
            delete from "flights_demo"."flights_wh"."Dim_Airport"
            where (
                airport_code) in (
                select (airport_code)
                from "Dim_Airport__dbt_tmp151931968686"
            );

        
    

    insert into "flights_demo"."flights_wh"."Dim_Airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time"
        from "Dim_Airport__dbt_tmp151931968686"
    )
  
[0m15:19:32.488747 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m15:19:32.544599 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m15:19:32.546584 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m15:19:32.547537 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m15:19:32.550532 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:19:32.552561 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (execute): 15:19:31.841984 => 15:19:32.552561
[0m15:19:32.554136 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: Close
[0m15:19:32.555517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ab0477-5915-487b-811b-4a2c3306e046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001872AA3DAD0>]}
[0m15:19:32.557511 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model flights_wh.Dim_Airport ................. [[32mINSERT 0 104[0m in 0.74s]
[0m15:19:32.559506 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_Airport
[0m15:19:32.561501 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_aircraft
[0m15:19:32.563643 [info ] [Thread-1 (]: 2 of 4 START sql incremental model flights_wh.Dim_aircraft ..................... [RUN]
[0m15:19:32.566488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_Airport, now model.flights_dbt.Dim_aircraft)
[0m15:19:32.568482 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_aircraft
[0m15:19:32.577492 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_aircraft"
[0m15:19:32.584480 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (compile): 15:19:32.569479 => 15:19:32.583631
[0m15:19:32.585840 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_aircraft
[0m15:19:32.600431 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m15:19:32.602394 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

    
  
    

  create temporary table "Dim_aircraft__dbt_tmp151932590458"
  
  
    as
  
  (
    

select 
    row_number () over() as dim_aircraft_id,

    ad.aircraft_code,
    ad.model,
    ad.range,
    ad.last_update,

    s. seat_no,
    s.fare_conditions,

    case when range >= 5600 then 'High'
        when range < 5600 then 'Low'
        else 'Null'
        end as range_L_H,
    jsonb_extract_path(model, 'en' )as Model_English,
    jsonb_extract_path(model, 'ru' )as Model_Russian,

'2023-08-16 12:19:30'::timestamp as dbt_time

from flights_demo.stg.aircrafts_data ad 
join flights_demo.stg.seats s 
	on s.aircraft_code = ad.aircraft_code
  );
  
  
[0m15:19:32.603423 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:32.754685 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m15:19:32.766696 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m15:19:32.769645 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: BEGIN
[0m15:19:32.773157 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:19:32.775632 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m15:19:32.777666 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft__dbt_tmp151932590458'
        
      order by ordinal_position

  
[0m15:19:32.838236 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m15:19:32.852200 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m15:19:32.854359 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m15:19:32.868151 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m15:19:32.881117 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m15:19:32.883111 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m15:19:32.897032 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m15:19:32.909997 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_aircraft"
[0m15:19:32.914179 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m15:19:32.915988 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      
        
            delete from "flights_demo"."flights_wh"."Dim_aircraft"
            where (
                dim_aircraft_id) in (
                select (dim_aircraft_id)
                from "Dim_aircraft__dbt_tmp151932590458"
            );

        
    

    insert into "flights_demo"."flights_wh"."Dim_aircraft" ("aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time")
    (
        select "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time"
        from "Dim_aircraft__dbt_tmp151932590458"
    )
  
[0m15:19:32.929149 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "dim_aircraft_id" does not exist
LINE 7:                 dim_aircraft_id) in (
                        ^

[0m15:19:32.931143 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: ROLLBACK
[0m15:19:32.935130 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (execute): 15:19:32.586435 => 15:19:32.933524
[0m15:19:32.937137 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: Close
[0m15:19:32.964426 [debug] [Thread-1 (]: Database Error in model Dim_aircraft (models\dimension\Dim_aircraft.sql)
  column "dim_aircraft_id" does not exist
  LINE 7:                 dim_aircraft_id) in (
                          ^
  compiled Code at target\run\flights_dbt\models\dimension\Dim_aircraft.sql
[0m15:19:32.966421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ab0477-5915-487b-811b-4a2c3306e046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018729FDCB50>]}
[0m15:19:32.969414 [error] [Thread-1 (]: 2 of 4 ERROR creating sql incremental model flights_wh.Dim_aircraft ............ [[31mERROR[0m in 0.40s]
[0m15:19:32.973080 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_aircraft
[0m15:19:32.975845 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m15:19:32.977880 [info ] [Thread-1 (]: 3 of 4 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m15:19:32.982826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_aircraft, now model.flights_dbt.my_first_dbt_model)
[0m15:19:32.985421 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m15:19:33.004767 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m15:19:33.012748 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 15:19:32.986816 => 15:19:33.010612
[0m15:19:33.015739 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m15:19:33.082592 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m15:19:33.085552 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m15:19:33.086578 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m15:19:33.087627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:33.185418 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:19:33.186764 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m15:19:33.188452 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m15:19:33.204372 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m15:19:33.222323 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m15:19:33.224467 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:19:33.228268 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:19:33.238281 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m15:19:33.239279 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:19:33.242279 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:19:33.266207 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m15:19:33.268318 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m15:19:33.270197 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m15:19:33.273865 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:19:33.291264 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m15:19:33.292553 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_demo"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m15:19:33.330752 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m15:19:33.334790 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 15:19:33.016736 => 15:19:33.334790
[0m15:19:33.336785 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m15:19:33.338732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ab0477-5915-487b-811b-4a2c3306e046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001872A231750>]}
[0m15:19:33.340774 [info ] [Thread-1 (]: 3 of 4 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.36s]
[0m15:19:33.343720 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m15:19:33.345714 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m15:19:33.346710 [info ] [Thread-1 (]: 4 of 4 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m15:19:33.349733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m15:19:33.351698 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m15:19:33.359675 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m15:19:33.366700 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 15:19:33.352695 => 15:19:33.364670
[0m15:19:33.368697 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m15:19:33.437472 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m15:19:33.439940 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m15:19:33.441461 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m15:19:33.444456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:33.548895 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m15:19:33.550957 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m15:19:33.551919 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_demo"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m15:19:33.569641 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m15:19:33.578145 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m15:19:33.580153 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:19:33.584091 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m15:19:33.592069 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m15:19:33.595061 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m15:19:33.597054 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m15:19:33.602861 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m15:19:33.614825 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m15:19:33.617249 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m15:19:33.619755 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m15:19:33.630726 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 15:19:33.369648 => 15:19:33.628730
[0m15:19:33.632720 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m15:19:33.636710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ab0477-5915-487b-811b-4a2c3306e046', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018729AC8ED0>]}
[0m15:19:33.641703 [info ] [Thread-1 (]: 4 of 4 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.29s]
[0m15:19:33.647681 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m15:19:33.653713 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:33.656717 [debug] [MainThread]: On master: BEGIN
[0m15:19:33.659696 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:19:33.790388 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m15:19:33.791436 [debug] [MainThread]: On master: COMMIT
[0m15:19:33.793097 [debug] [MainThread]: Using postgres connection "master"
[0m15:19:33.793382 [debug] [MainThread]: On master: COMMIT
[0m15:19:33.795770 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m15:19:33.796422 [debug] [MainThread]: On master: Close
[0m15:19:33.798367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:19:33.800361 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m15:19:33.801390 [debug] [MainThread]: Connection 'list_flights_demo_flights_wh' was properly closed.
[0m15:19:33.803354 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m15:19:33.806382 [info ] [MainThread]: 
[0m15:19:33.808342 [info ] [MainThread]: Finished running 2 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 2.77 seconds (2.77s).
[0m15:19:33.812381 [debug] [MainThread]: Command end result
[0m15:19:33.827291 [info ] [MainThread]: 
[0m15:19:33.829284 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:19:33.831284 [info ] [MainThread]: 
[0m15:19:33.833277 [error] [MainThread]: [33mDatabase Error in model Dim_aircraft (models\dimension\Dim_aircraft.sql)[0m
[0m15:19:33.835317 [error] [MainThread]:   column "dim_aircraft_id" does not exist
[0m15:19:33.837266 [error] [MainThread]:   LINE 7:                 dim_aircraft_id) in (
[0m15:19:33.839433 [error] [MainThread]:                           ^
[0m15:19:33.842900 [error] [MainThread]:   compiled Code at target\run\flights_dbt\models\dimension\Dim_aircraft.sql
[0m15:19:33.845242 [info ] [MainThread]: 
[0m15:19:33.847241 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m15:19:33.850231 [debug] [MainThread]: Command `dbt run` failed at 15:19:33.850231 after 3.35 seconds
[0m15:19:33.852224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001872A2C0950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001872A2BB4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001872A00E150>]}
[0m15:19:33.853854 [debug] [MainThread]: Flushing usage events
[0m17:27:47.810455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A8BE6750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A8BE61D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A9295FD0>]}


============================== 17:27:47.816553 | 78109be6-bead-484b-a861-1b0903f0ca36 ==============================
[0m17:27:47.816553 [info ] [MainThread]: Running with dbt=1.5.3
[0m17:27:47.816553 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:27:47.908359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78109be6-bead-484b-a861-1b0903f0ca36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A8BE61D0>]}
[0m17:27:47.923322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '78109be6-bead-484b-a861-1b0903f0ca36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A9296010>]}
[0m17:27:47.925317 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m17:27:47.939307 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m17:27:48.050981 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:27:48.051978 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:27:48.059956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78109be6-bead-484b-a861-1b0903f0ca36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A8F38350>]}
[0m17:27:48.070928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78109be6-bead-484b-a861-1b0903f0ca36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A95439D0>]}
[0m17:27:48.071926 [info ] [MainThread]: Found 5 models, 6 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m17:27:48.073920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78109be6-bead-484b-a861-1b0903f0ca36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A52B3090>]}
[0m17:27:48.076951 [info ] [MainThread]: 
[0m17:27:48.078907 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:27:48.080906 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m17:27:48.095862 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m17:27:48.096868 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m17:27:48.096868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:48.184060 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m17:27:48.185056 [debug] [ThreadPool]: On list_flights_demo: Close
[0m17:27:48.189056 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo_flights_wh'
[0m17:27:48.195030 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m17:27:48.196028 [debug] [ThreadPool]: On list_flights_demo_flights_wh: BEGIN
[0m17:27:48.196028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:48.244897 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:27:48.245895 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m17:27:48.245895 [debug] [ThreadPool]: On list_flights_demo_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo_flights_wh"} */
select
      'flights_demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m17:27:48.259857 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m17:27:48.260855 [debug] [ThreadPool]: On list_flights_demo_flights_wh: ROLLBACK
[0m17:27:48.261852 [debug] [ThreadPool]: On list_flights_demo_flights_wh: Close
[0m17:27:48.268835 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:48.268835 [debug] [MainThread]: On master: BEGIN
[0m17:27:48.269832 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:27:48.314710 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:27:48.315708 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:48.315708 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:27:48.354645 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m17:27:48.355627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78109be6-bead-484b-a861-1b0903f0ca36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A8E1A9D0>]}
[0m17:27:48.356624 [debug] [MainThread]: On master: ROLLBACK
[0m17:27:48.357623 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:48.357623 [debug] [MainThread]: On master: BEGIN
[0m17:27:48.358593 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:27:48.358593 [debug] [MainThread]: On master: COMMIT
[0m17:27:48.359590 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:48.359590 [debug] [MainThread]: On master: COMMIT
[0m17:27:48.360588 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:27:48.360588 [debug] [MainThread]: On master: Close
[0m17:27:48.361585 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:27:48.362584 [info ] [MainThread]: 
[0m17:27:48.369420 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_Airport
[0m17:27:48.370417 [info ] [Thread-1 (]: 1 of 4 START sql incremental model flights_wh.Dim_Airport ...................... [RUN]
[0m17:27:48.371664 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flights_dbt.Dim_Airport'
[0m17:27:48.372695 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_Airport
[0m17:27:48.375657 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_Airport"
[0m17:27:48.376987 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (compile): 17:27:48.372695 => 17:27:48.376987
[0m17:27:48.377988 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_Airport
[0m17:27:48.452813 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m17:27:48.453786 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

    
  
    

  create temporary table "Dim_Airport__dbt_tmp172748418915"
  
  
    as
  
  (
    

select *,
    jsonb_extract_path(airport_name, 'en' )as airport_name_eng, 
    jsonb_extract_path(city, 'en' )as city_eng,
    jsonb_extract_path(airport_name, 'ru' )as airport_name_rus,
    jsonb_extract_path(city, 'en' )as city_rus,

'2023-08-16 14:27:47'::timestamp as dbt_time

from stg.airports_data
  );
  
  
[0m17:27:48.453786 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:27:48.534747 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m17:27:48.542727 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m17:27:48.543723 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: BEGIN
[0m17:27:48.547719 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:27:48.548718 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m17:27:48.549707 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport__dbt_tmp172748418915'
        
      order by ordinal_position

  
[0m17:27:48.589599 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:27:48.596581 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m17:27:48.597578 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:27:48.601567 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:27:48.612539 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m17:27:48.613534 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:27:48.617526 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:27:48.638471 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_Airport"
[0m17:27:48.640464 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m17:27:48.641461 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      
        
            delete from "flights_demo"."flights_wh"."Dim_Airport"
            where (
                airport_code) in (
                select (airport_code)
                from "Dim_Airport__dbt_tmp172748418915"
            );

        
    

    insert into "flights_demo"."flights_wh"."Dim_Airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time"
        from "Dim_Airport__dbt_tmp172748418915"
    )
  
[0m17:27:48.648442 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m17:27:48.664401 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m17:27:48.665396 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m17:27:48.665396 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m17:27:48.667392 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:27:48.668389 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (execute): 17:27:48.377988 => 17:27:48.668389
[0m17:27:48.669386 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: Close
[0m17:27:48.671381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78109be6-bead-484b-a861-1b0903f0ca36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A8E6D310>]}
[0m17:27:48.673376 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model flights_wh.Dim_Airport ................. [[32mINSERT 0 104[0m in 0.30s]
[0m17:27:48.675370 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_Airport
[0m17:27:48.675370 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_aircraft
[0m17:27:48.676369 [info ] [Thread-1 (]: 2 of 4 START sql incremental model flights_wh.Dim_aircraft ..................... [RUN]
[0m17:27:48.678362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_Airport, now model.flights_dbt.Dim_aircraft)
[0m17:27:48.679360 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_aircraft
[0m17:27:48.682350 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_aircraft"
[0m17:27:48.683377 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (compile): 17:27:48.679360 => 17:27:48.683377
[0m17:27:48.684346 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_aircraft
[0m17:27:48.690359 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m17:27:48.691356 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

    
  
    

  create temporary table "Dim_aircraft__dbt_tmp172748687339"
  
  
    as
  
  (
    

select 
    row_number () over() as dim_aircraft_id,

    ad.aircraft_code,
    ad.model,
    ad.range,
    ad.last_update,

    s. seat_no,
    s.fare_conditions,

    case when range >= 5600 then 'High'
        when range < 5600 then 'Low'
        else 'Null'
        end as range_L_H,
    jsonb_extract_path(model, 'en' )as Model_English,
    jsonb_extract_path(model, 'ru' )as Model_Russian,

'2023-08-16 14:27:47'::timestamp as dbt_time

from flights_demo.stg.aircrafts_data ad 
join flights_demo.stg.seats s 
	on s.aircraft_code = ad.aircraft_code
  );
  
  
[0m17:27:48.691356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:48.759535 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m17:27:48.763545 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m17:27:48.764540 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: BEGIN
[0m17:27:48.765501 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:27:48.765501 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m17:27:48.766500 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft__dbt_tmp172748687339'
        
      order by ordinal_position

  
[0m17:27:48.791441 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:27:48.795424 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m17:27:48.795424 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:27:48.800408 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m17:27:48.805432 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m17:27:48.806394 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:27:48.810381 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.0 seconds
[0m17:27:48.813374 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_aircraft"
[0m17:27:48.814371 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m17:27:48.814371 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      
        
            delete from "flights_demo"."flights_wh"."Dim_aircraft"
            where (
                dim_aircraft_id) in (
                select (dim_aircraft_id)
                from "Dim_aircraft__dbt_tmp172748687339"
            );

        
    

    insert into "flights_demo"."flights_wh"."Dim_aircraft" ("aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time")
    (
        select "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time"
        from "Dim_aircraft__dbt_tmp172748687339"
    )
  
[0m17:27:48.817363 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "dim_aircraft_id" does not exist
LINE 7:                 dim_aircraft_id) in (
                        ^

[0m17:27:48.818397 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: ROLLBACK
[0m17:27:48.820358 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (execute): 17:27:48.684346 => 17:27:48.820358
[0m17:27:48.822350 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: Close
[0m17:27:48.831160 [debug] [Thread-1 (]: Database Error in model Dim_aircraft (models\dimension\Dim_aircraft.sql)
  column "dim_aircraft_id" does not exist
  LINE 7:                 dim_aircraft_id) in (
                          ^
  compiled Code at target\run\flights_dbt\models\dimension\Dim_aircraft.sql
[0m17:27:48.831160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78109be6-bead-484b-a861-1b0903f0ca36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A964C850>]}
[0m17:27:48.832158 [error] [Thread-1 (]: 2 of 4 ERROR creating sql incremental model flights_wh.Dim_aircraft ............ [[31mERROR[0m in 0.15s]
[0m17:27:48.833140 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_aircraft
[0m17:27:48.834142 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m17:27:48.834142 [info ] [Thread-1 (]: 3 of 4 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m17:27:48.837139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_aircraft, now model.flights_dbt.my_first_dbt_model)
[0m17:27:48.838131 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m17:27:48.842147 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m17:27:48.843286 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 17:27:48.839137 => 17:27:48.843286
[0m17:27:48.844287 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m17:27:48.857286 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m17:27:48.859254 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m17:27:48.859254 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m17:27:48.860245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:49.008849 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:27:49.009846 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m17:27:49.009846 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m17:27:49.014833 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m17:27:49.020815 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m17:27:49.021812 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:27:49.022809 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:27:49.025800 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m17:27:49.026797 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:27:49.027796 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:27:49.034811 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m17:27:49.035810 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m17:27:49.037772 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m17:27:49.039483 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:27:49.044472 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m17:27:49.044472 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_demo"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m17:27:49.049882 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:27:49.051879 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 17:27:48.844287 => 17:27:49.051879
[0m17:27:49.051879 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m17:27:49.054872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78109be6-bead-484b-a861-1b0903f0ca36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A9542CD0>]}
[0m17:27:49.055872 [info ] [Thread-1 (]: 3 of 4 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.22s]
[0m17:27:49.057866 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m17:27:49.058862 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m17:27:49.059858 [info ] [Thread-1 (]: 4 of 4 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m17:27:49.061125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m17:27:49.061125 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m17:27:49.065140 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m17:27:49.066137 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 17:27:49.061125 => 17:27:49.066137
[0m17:27:49.067126 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m17:27:49.091043 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m17:27:49.092037 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m17:27:49.093032 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m17:27:49.094036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:49.154521 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:27:49.157518 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m17:27:49.158501 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_demo"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m17:27:49.167690 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:27:49.172679 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m17:27:49.172679 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:27:49.174763 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:27:49.176759 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m17:27:49.176759 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m17:27:49.177757 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m17:27:49.179275 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:27:49.182271 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m17:27:49.182271 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m17:27:49.183267 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:27:49.185261 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 17:27:49.068099 => 17:27:49.184264
[0m17:27:49.185261 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m17:27:49.188260 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '78109be6-bead-484b-a861-1b0903f0ca36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A95E8250>]}
[0m17:27:49.189252 [info ] [Thread-1 (]: 4 of 4 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.13s]
[0m17:27:49.190509 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m17:27:49.192508 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:49.193539 [debug] [MainThread]: On master: BEGIN
[0m17:27:49.193539 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:27:49.244066 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:27:49.245103 [debug] [MainThread]: On master: COMMIT
[0m17:27:49.245103 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:49.246064 [debug] [MainThread]: On master: COMMIT
[0m17:27:49.246064 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:27:49.247060 [debug] [MainThread]: On master: Close
[0m17:27:49.248064 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:27:49.248064 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m17:27:49.248064 [debug] [MainThread]: Connection 'list_flights_demo_flights_wh' was properly closed.
[0m17:27:49.249056 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m17:27:49.250080 [info ] [MainThread]: 
[0m17:27:49.251064 [info ] [MainThread]: Finished running 2 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 1.17 seconds (1.17s).
[0m17:27:49.252111 [debug] [MainThread]: Command end result
[0m17:27:49.266030 [info ] [MainThread]: 
[0m17:27:49.267025 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:27:49.268032 [info ] [MainThread]: 
[0m17:27:49.269020 [error] [MainThread]: [33mDatabase Error in model Dim_aircraft (models\dimension\Dim_aircraft.sql)[0m
[0m17:27:49.275005 [error] [MainThread]:   column "dim_aircraft_id" does not exist
[0m17:27:49.278029 [error] [MainThread]:   LINE 7:                 dim_aircraft_id) in (
[0m17:27:49.279994 [error] [MainThread]:                           ^
[0m17:27:49.280988 [error] [MainThread]:   compiled Code at target\run\flights_dbt\models\dimension\Dim_aircraft.sql
[0m17:27:49.281986 [info ] [MainThread]: 
[0m17:27:49.282985 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m17:27:49.285989 [debug] [MainThread]: Command `dbt run` failed at 17:27:49.285989 after 1.50 seconds
[0m17:27:49.290981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A2C769D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A2C74250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278A2C74190>]}
[0m17:27:49.295955 [debug] [MainThread]: Flushing usage events
[0m17:32:06.395785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019848B352D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001984928FB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019848ED5D50>]}


============================== 17:32:06.406763 | 332a6613-639d-4935-8854-7113ee7dee34 ==============================
[0m17:32:06.406763 [info ] [MainThread]: Running with dbt=1.5.3
[0m17:32:06.411749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m17:32:06.607224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '332a6613-639d-4935-8854-7113ee7dee34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019848F15D90>]}
[0m17:32:06.642131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '332a6613-639d-4935-8854-7113ee7dee34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019848B6E050>]}
[0m17:32:06.644126 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m17:32:06.677039 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m17:32:06.782468 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:32:06.784457 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models\dimension\Dim_aircraft.sql
[0m17:32:06.816369 [debug] [MainThread]: 1603: static parser failed on dimension\Dim_aircraft.sql
[0m17:32:06.833349 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimension\Dim_aircraft.sql
[0m17:32:06.843325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '332a6613-639d-4935-8854-7113ee7dee34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198495661D0>]}
[0m17:32:06.854268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '332a6613-639d-4935-8854-7113ee7dee34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198492A0190>]}
[0m17:32:06.855265 [info ] [MainThread]: Found 5 models, 6 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m17:32:06.856262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '332a6613-639d-4935-8854-7113ee7dee34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198452B32D0>]}
[0m17:32:06.859284 [info ] [MainThread]: 
[0m17:32:06.860253 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:32:06.864241 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m17:32:06.879204 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m17:32:06.881196 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m17:32:06.883196 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:07.036781 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m17:32:07.038776 [debug] [ThreadPool]: On list_flights_demo: Close
[0m17:32:07.041767 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo_flights_wh'
[0m17:32:07.050746 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m17:32:07.051741 [debug] [ThreadPool]: On list_flights_demo_flights_wh: BEGIN
[0m17:32:07.051741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:07.102604 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m17:32:07.103601 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m17:32:07.104604 [debug] [ThreadPool]: On list_flights_demo_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo_flights_wh"} */
select
      'flights_demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m17:32:07.118560 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m17:32:07.120555 [debug] [ThreadPool]: On list_flights_demo_flights_wh: ROLLBACK
[0m17:32:07.121552 [debug] [ThreadPool]: On list_flights_demo_flights_wh: Close
[0m17:32:07.127536 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:07.128534 [debug] [MainThread]: On master: BEGIN
[0m17:32:07.130546 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:32:07.207326 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:32:07.208320 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:07.210315 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:32:07.269160 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m17:32:07.271155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '332a6613-639d-4935-8854-7113ee7dee34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019848E38A50>]}
[0m17:32:07.272150 [debug] [MainThread]: On master: ROLLBACK
[0m17:32:07.273155 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:07.273155 [debug] [MainThread]: On master: BEGIN
[0m17:32:07.274146 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:32:07.275144 [debug] [MainThread]: On master: COMMIT
[0m17:32:07.275144 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:07.276150 [debug] [MainThread]: On master: COMMIT
[0m17:32:07.277139 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:32:07.277139 [debug] [MainThread]: On master: Close
[0m17:32:07.281128 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:32:07.284120 [info ] [MainThread]: 
[0m17:32:07.298082 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_Airport
[0m17:32:07.301104 [info ] [Thread-1 (]: 1 of 4 START sql incremental model flights_wh.Dim_Airport ...................... [RUN]
[0m17:32:07.304068 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flights_dbt.Dim_Airport'
[0m17:32:07.305065 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_Airport
[0m17:32:07.318028 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_Airport"
[0m17:32:07.327007 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (compile): 17:32:07.306062 => 17:32:07.326014
[0m17:32:07.329002 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_Airport
[0m17:32:07.497559 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m17:32:07.500541 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

    
  
    

  create temporary table "Dim_Airport__dbt_tmp173207432720"
  
  
    as
  
  (
    

select *,
    jsonb_extract_path(airport_name, 'en' )as airport_name_eng, 
    jsonb_extract_path(city, 'en' )as city_eng,
    jsonb_extract_path(airport_name, 'ru' )as airport_name_rus,
    jsonb_extract_path(city, 'en' )as city_rus,

'2023-08-16 14:32:06'::timestamp as dbt_time

from stg.airports_data
  );
  
  
[0m17:32:07.502536 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:32:07.692032 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m17:32:07.706989 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m17:32:07.706989 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: BEGIN
[0m17:32:07.708982 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:32:07.708982 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m17:32:07.709980 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport__dbt_tmp173207432720'
        
      order by ordinal_position

  
[0m17:32:07.764844 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:32:07.770817 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m17:32:07.771814 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:32:07.780800 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:32:07.788770 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m17:32:07.789773 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m17:32:07.799743 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m17:32:07.825672 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_Airport"
[0m17:32:07.829664 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m17:32:07.831655 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      
        
            delete from "flights_demo"."flights_wh"."Dim_Airport"
            where (
                airport_code) in (
                select (airport_code)
                from "Dim_Airport__dbt_tmp173207432720"
            );

        
    

    insert into "flights_demo"."flights_wh"."Dim_Airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time"
        from "Dim_Airport__dbt_tmp173207432720"
    )
  
[0m17:32:07.848610 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m17:32:07.897487 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m17:32:07.898479 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m17:32:07.899474 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m17:32:07.901467 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:32:07.902464 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (execute): 17:32:07.337979 => 17:32:07.902464
[0m17:32:07.903461 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: Close
[0m17:32:07.905457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '332a6613-639d-4935-8854-7113ee7dee34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198495EBF90>]}
[0m17:32:07.906454 [info ] [Thread-1 (]: 1 of 4 OK created sql incremental model flights_wh.Dim_Airport ................. [[32mINSERT 0 104[0m in 0.60s]
[0m17:32:07.908518 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_Airport
[0m17:32:07.909446 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_aircraft
[0m17:32:07.910444 [info ] [Thread-1 (]: 2 of 4 START sql incremental model flights_wh.Dim_aircraft ..................... [RUN]
[0m17:32:07.917427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_Airport, now model.flights_dbt.Dim_aircraft)
[0m17:32:07.919420 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_aircraft
[0m17:32:07.926402 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_aircraft"
[0m17:32:07.940367 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (compile): 17:32:07.920418 => 17:32:07.934390
[0m17:32:07.942368 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_aircraft
[0m17:32:07.985244 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_aircraft"
[0m17:32:07.993254 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m17:32:08.002203 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: BEGIN
[0m17:32:08.005195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:08.074006 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:32:08.074006 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m17:32:08.075003 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      
  
    

  create  table "flights_demo"."flights_wh"."Dim_aircraft"
  
  
    as
  
  (
    

select 
    row_number() over() as dim_aircraft_id,

    ad.aircraft_code,
    ad.model,
    ad.range,
    ad.last_update,

    s. seat_no,
    s.fare_conditions,

    case when range >= 5600 then 'High'
        when range < 5600 then 'Low'
        else 'Null'
        end as range_L_H,
    jsonb_extract_path(model, 'en' )as Model_English,
    jsonb_extract_path(model, 'ru' )as Model_Russian,

'2023-08-16 14:32:06'::timestamp as dbt_time

from flights_demo.stg.aircrafts_data ad 
join flights_demo.stg.seats s 
	on s.aircraft_code = ad.aircraft_code
  );
  
  
[0m17:32:08.100935 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m17:32:08.107916 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m17:32:08.109910 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m17:32:08.110906 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m17:32:08.113900 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:32:08.115893 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (execute): 17:32:07.943360 => 17:32:08.114898
[0m17:32:08.116892 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: Close
[0m17:32:08.117890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '332a6613-639d-4935-8854-7113ee7dee34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019848D90110>]}
[0m17:32:08.119884 [info ] [Thread-1 (]: 2 of 4 OK created sql incremental model flights_wh.Dim_aircraft ................ [[32mSELECT 1339[0m in 0.20s]
[0m17:32:08.121879 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_aircraft
[0m17:32:08.122876 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m17:32:08.123874 [info ] [Thread-1 (]: 3 of 4 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m17:32:08.126865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_aircraft, now model.flights_dbt.my_first_dbt_model)
[0m17:32:08.128861 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m17:32:08.137837 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m17:32:08.149807 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 17:32:08.129857 => 17:32:08.146852
[0m17:32:08.152796 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m17:32:08.256518 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m17:32:08.258514 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m17:32:08.259511 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m17:32:08.265505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:08.321344 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:32:08.322342 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m17:32:08.323339 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m17:32:08.328327 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m17:32:08.335307 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m17:32:08.336306 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:32:08.337304 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:32:08.341291 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m17:32:08.342289 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:32:08.343287 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:32:08.348273 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m17:32:08.349271 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m17:32:08.349271 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m17:32:08.351266 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:32:08.357249 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m17:32:08.358248 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_demo"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m17:32:08.363234 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m17:32:08.366225 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 17:32:08.155798 => 17:32:08.365228
[0m17:32:08.367224 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m17:32:08.368219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '332a6613-639d-4935-8854-7113ee7dee34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001984976F750>]}
[0m17:32:08.369219 [info ] [Thread-1 (]: 3 of 4 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.24s]
[0m17:32:08.371212 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m17:32:08.373208 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m17:32:08.374204 [info ] [Thread-1 (]: 4 of 4 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m17:32:08.375203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m17:32:08.376197 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m17:32:08.379191 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m17:32:08.381185 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 17:32:08.376197 => 17:32:08.381185
[0m17:32:08.382183 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m17:32:08.410108 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m17:32:08.416092 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m17:32:08.417102 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m17:32:08.418087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:08.485907 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m17:32:08.486903 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m17:32:08.487901 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_demo"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m17:32:08.495879 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m17:32:08.499867 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m17:32:08.499867 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:32:08.500865 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m17:32:08.502860 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m17:32:08.503857 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m17:32:08.503857 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m17:32:08.504854 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m17:32:08.507845 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m17:32:08.508844 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m17:32:08.508844 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m17:32:08.511837 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 17:32:08.383181 => 17:32:08.511837
[0m17:32:08.511837 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m17:32:08.512833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '332a6613-639d-4935-8854-7113ee7dee34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198496C09D0>]}
[0m17:32:08.513831 [info ] [Thread-1 (]: 4 of 4 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.14s]
[0m17:32:08.515824 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m17:32:08.517820 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:08.517820 [debug] [MainThread]: On master: BEGIN
[0m17:32:08.518817 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:32:08.578662 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m17:32:08.579656 [debug] [MainThread]: On master: COMMIT
[0m17:32:08.580652 [debug] [MainThread]: Using postgres connection "master"
[0m17:32:08.581648 [debug] [MainThread]: On master: COMMIT
[0m17:32:08.582647 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m17:32:08.583645 [debug] [MainThread]: On master: Close
[0m17:32:08.584642 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:32:08.584642 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m17:32:08.585638 [debug] [MainThread]: Connection 'list_flights_demo_flights_wh' was properly closed.
[0m17:32:08.585638 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m17:32:08.587633 [info ] [MainThread]: 
[0m17:32:08.588631 [info ] [MainThread]: Finished running 2 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 1.73 seconds (1.73s).
[0m17:32:08.591622 [debug] [MainThread]: Command end result
[0m17:32:08.604589 [info ] [MainThread]: 
[0m17:32:08.606583 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:32:08.608577 [info ] [MainThread]: 
[0m17:32:08.609576 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:32:08.615558 [debug] [MainThread]: Command `dbt run` succeeded at 17:32:08.615558 after 2.29 seconds
[0m17:32:08.617554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001984928FB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019848F366D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019848C172D0>]}
[0m17:32:08.618554 [debug] [MainThread]: Flushing usage events
[0m18:14:31.381685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024388D90E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024388D61CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024388D39250>]}


============================== 18:14:31.389662 | 1672ba6c-ccb5-4a1a-85ed-176edc0c4d14 ==============================
[0m18:14:31.389662 [info ] [MainThread]: Running with dbt=1.5.3
[0m18:14:31.392694 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:14:31.536886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1672ba6c-ccb5-4a1a-85ed-176edc0c4d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024388DF2E50>]}
[0m18:14:31.559823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1672ba6c-ccb5-4a1a-85ed-176edc0c4d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024388A7E850>]}
[0m18:14:31.560820 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m18:14:31.577774 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m18:14:31.848179 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:14:31.849142 [debug] [MainThread]: Partial parsing: added file: flights_dbt://models\Facts\schema.yml
[0m18:14:31.850145 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models\Facts\Fact_flights.sql
[0m18:14:31.880060 [debug] [MainThread]: 1699: static parser successfully parsed Facts\Fact_flights.sql
[0m18:14:31.917959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1672ba6c-ccb5-4a1a-85ed-176edc0c4d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024389498990>]}
[0m18:14:31.930955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1672ba6c-ccb5-4a1a-85ed-176edc0c4d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243895FA910>]}
[0m18:14:31.930955 [info ] [MainThread]: Found 5 models, 6 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:14:31.931921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1672ba6c-ccb5-4a1a-85ed-176edc0c4d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243851D32D0>]}
[0m18:14:31.934940 [info ] [MainThread]: 
[0m18:14:31.935909 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:14:31.938904 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m18:14:31.954860 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m18:14:31.955857 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m18:14:31.956856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:32.088502 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m18:14:32.091494 [debug] [ThreadPool]: On list_flights_demo: Close
[0m18:14:32.095483 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo_flights_wh'
[0m18:14:32.103464 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:14:32.104461 [debug] [ThreadPool]: On list_flights_demo_flights_wh: BEGIN
[0m18:14:32.104461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:32.181255 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:14:32.182254 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:14:32.183249 [debug] [ThreadPool]: On list_flights_demo_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo_flights_wh"} */
select
      'flights_demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:14:32.222145 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m18:14:32.225137 [debug] [ThreadPool]: On list_flights_demo_flights_wh: ROLLBACK
[0m18:14:32.227144 [debug] [ThreadPool]: On list_flights_demo_flights_wh: Close
[0m18:14:32.259090 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:32.263038 [debug] [MainThread]: On master: BEGIN
[0m18:14:32.264033 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:14:32.405654 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:14:32.407649 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:32.408645 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:14:32.463017 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:14:32.466010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1672ba6c-ccb5-4a1a-85ed-176edc0c4d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002438949C050>]}
[0m18:14:32.468999 [debug] [MainThread]: On master: ROLLBACK
[0m18:14:32.469997 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:32.470993 [debug] [MainThread]: On master: BEGIN
[0m18:14:32.471992 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:14:32.472989 [debug] [MainThread]: On master: COMMIT
[0m18:14:32.472989 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:32.473986 [debug] [MainThread]: On master: COMMIT
[0m18:14:32.474983 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:14:32.478991 [debug] [MainThread]: On master: Close
[0m18:14:32.487949 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:14:32.493933 [info ] [MainThread]: 
[0m18:14:32.552362 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_Airport
[0m18:14:32.555354 [info ] [Thread-1 (]: 1 of 5 START sql incremental model flights_wh.Dim_Airport ...................... [RUN]
[0m18:14:32.570313 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flights_dbt.Dim_Airport'
[0m18:14:32.574307 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_Airport
[0m18:14:32.630154 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_Airport"
[0m18:14:32.640129 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (compile): 18:14:32.576314 => 18:14:32.638138
[0m18:14:32.644117 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_Airport
[0m18:14:32.954121 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:14:32.955119 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

    
  
    

  create temporary table "Dim_Airport__dbt_tmp181432859539"
  
  
    as
  
  (
    

select *,
    jsonb_extract_path(airport_name, 'en' )as airport_name_eng, 
    jsonb_extract_path(city, 'en' )as city_eng,
    jsonb_extract_path(airport_name, 'ru' )as airport_name_rus,
    jsonb_extract_path(city, 'en' )as city_rus,

'2023-08-16 15:14:31'::timestamp as dbt_time

from stg.airports_data
  );
  
  
[0m18:14:32.955119 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:14:33.112719 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:14:33.135641 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:14:33.137199 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: BEGIN
[0m18:14:33.140164 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:14:33.141160 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:14:33.142158 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport__dbt_tmp181432859539'
        
      order by ordinal_position

  
[0m18:14:33.221945 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:14:33.245404 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:14:33.247398 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:14:33.290286 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:14:33.306240 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:14:33.308234 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:14:33.315215 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:14:33.386039 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_Airport"
[0m18:14:33.391018 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:14:33.393009 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      
        
            delete from "flights_demo"."flights_wh"."Dim_Airport"
            where (
                airport_code) in (
                select (airport_code)
                from "Dim_Airport__dbt_tmp181432859539"
            );

        
    

    insert into "flights_demo"."flights_wh"."Dim_Airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time"
        from "Dim_Airport__dbt_tmp181432859539"
    )
  
[0m18:14:33.407967 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m18:14:33.442874 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:14:33.443870 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:14:33.444868 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:14:33.446863 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:14:33.449856 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (execute): 18:14:32.647108 => 18:14:33.448858
[0m18:14:33.450853 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: Close
[0m18:14:33.451851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1672ba6c-ccb5-4a1a-85ed-176edc0c4d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000243895E4FD0>]}
[0m18:14:33.453844 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model flights_wh.Dim_Airport ................. [[32mINSERT 0 104[0m in 0.89s]
[0m18:14:33.456837 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_Airport
[0m18:14:33.458833 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_aircraft
[0m18:14:33.465815 [info ] [Thread-1 (]: 2 of 5 START sql incremental model flights_wh.Dim_aircraft ..................... [RUN]
[0m18:14:33.471801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_Airport, now model.flights_dbt.Dim_aircraft)
[0m18:14:33.475791 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_aircraft
[0m18:14:33.558059 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_aircraft"
[0m18:14:33.580002 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (compile): 18:14:33.478814 => 18:14:33.577027
[0m18:14:33.590970 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_aircraft
[0m18:14:33.641833 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:14:33.642829 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

    
  
    

  create temporary table "Dim_aircraft__dbt_tmp181433607925"
  
  
    as
  
  (
    

select 
    row_number() over() as dim_aircraft_id,

    ad.aircraft_code,
    ad.model,
    ad.range,
    ad.last_update,

    s. seat_no,
    s.fare_conditions,

    case when range >= 5600 then 'High'
        when range < 5600 then 'Low'
        else 'Null'
        end as range_L_H,
    jsonb_extract_path(model, 'en' )as Model_English,
    jsonb_extract_path(model, 'ru' )as Model_Russian,

'2023-08-16 15:14:31'::timestamp as dbt_time

from flights_demo.stg.aircrafts_data ad 
join flights_demo.stg.seats s 
	on s.aircraft_code = ad.aircraft_code
  );
  
  
[0m18:14:33.643828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:33.874210 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m18:14:33.879198 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:14:33.880196 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: BEGIN
[0m18:14:33.882189 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:14:33.882189 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:14:33.883186 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft__dbt_tmp181433607925'
        
      order by ordinal_position

  
[0m18:14:33.903131 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:14:33.909115 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:14:33.910114 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:14:33.917098 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:14:33.922082 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:14:33.923079 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:14:33.931060 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:14:33.956989 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_aircraft"
[0m18:14:33.960978 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:14:33.960978 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      insert into "flights_demo"."flights_wh"."Dim_aircraft" ("dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time")
    (
        select "dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time"
        from "Dim_aircraft__dbt_tmp181433607925"
    )


  
[0m18:14:33.972971 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m18:14:33.975965 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:14:33.976934 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:14:33.976934 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:14:33.979954 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:14:33.981950 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (execute): 18:14:33.593963 => 18:14:33.981950
[0m18:14:33.982946 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: Close
[0m18:14:33.984914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1672ba6c-ccb5-4a1a-85ed-176edc0c4d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024389650590>]}
[0m18:14:33.987907 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model flights_wh.Dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.51s]
[0m18:14:33.990935 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_aircraft
[0m18:14:33.991929 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_flights
[0m18:14:33.992928 [info ] [Thread-1 (]: 3 of 5 START sql incremental model flights_wh.Fact_flights ..................... [RUN]
[0m18:14:33.995892 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_aircraft, now model.flights_dbt.Fact_flights)
[0m18:14:33.997921 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_flights
[0m18:14:34.006859 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_flights"
[0m18:14:34.016831 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (compile): 18:14:33.998880 => 18:14:34.015832
[0m18:14:34.026965 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_flights
[0m18:14:34.041778 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_flights"
[0m18:14:34.048742 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:14:34.052734 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: BEGIN
[0m18:14:34.060716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:34.201335 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:14:34.202332 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:14:34.203329 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      
  
    

  create  table "flights_demo"."flights_wh"."Fact_flights"
  
  
    as
  
  (
    

with dim_flight_mod as (	
			select *,
			extract(day from (scheduled_arrival - scheduled_departure)*24) + extract(hour from (scheduled_arrival - scheduled_departure)) as flight_duration_expected,
			extract(day from (actual_arrival - actual_departure)*24) + extract(hour from (actual_arrival - actual_departure)) as duration_actual_hours
			from flights f 
			)
select *,
    case 	when duration_actual_hours > flight_duration_expected 
                then 'Longer'
            when duration_actual_hours < flight_duration_expected 
                then 'Shorter'
            when duration_actual_hours = flight_duration_expected 
                then 'As Expected'
            else null
            end as flight_duration_case
from dim_flight_mod
  );
  
  
[0m18:14:34.207321 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "flights" does not exist
LINE 19:    from flights f 
                 ^

[0m18:14:34.208316 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: ROLLBACK
[0m18:14:34.209315 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (execute): 18:14:34.027800 => 18:14:34.209315
[0m18:14:34.210312 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: Close
[0m18:14:34.224274 [debug] [Thread-1 (]: Database Error in model Fact_flights (models\Facts\Fact_flights.sql)
  relation "flights" does not exist
  LINE 19:    from flights f 
                   ^
  compiled Code at target\run\flights_dbt\models\Facts\Fact_flights.sql
[0m18:14:34.225270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1672ba6c-ccb5-4a1a-85ed-176edc0c4d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024389653F90>]}
[0m18:14:34.226268 [error] [Thread-1 (]: 3 of 5 ERROR creating sql incremental model flights_wh.Fact_flights ............ [[31mERROR[0m in 0.23s]
[0m18:14:34.228262 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_flights
[0m18:14:34.229261 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m18:14:34.230258 [info ] [Thread-1 (]: 4 of 5 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m18:14:34.232251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_flights, now model.flights_dbt.my_first_dbt_model)
[0m18:14:34.233249 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m18:14:34.239234 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m18:14:34.243225 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 18:14:34.233249 => 18:14:34.242226
[0m18:14:34.244222 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m18:14:34.268250 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m18:14:34.278225 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:14:34.279222 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m18:14:34.280222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:34.394911 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:14:34.395908 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:14:34.396906 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:14:34.403888 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m18:14:34.415857 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:14:34.417851 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:14:34.421840 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:14:34.433809 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:14:34.434806 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:14:34.436801 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:14:34.454751 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:14:34.455748 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:14:34.456746 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:14:34.458742 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:14:34.469712 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:14:34.470708 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_demo"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:14:34.485668 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:14:34.490656 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 18:14:34.244222 => 18:14:34.490656
[0m18:14:34.492651 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m18:14:34.495647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1672ba6c-ccb5-4a1a-85ed-176edc0c4d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024389658310>]}
[0m18:14:34.498638 [info ] [Thread-1 (]: 4 of 5 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.26s]
[0m18:14:34.503636 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m18:14:34.506615 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m18:14:34.522582 [info ] [Thread-1 (]: 5 of 5 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:14:34.534551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m18:14:34.538530 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m18:14:34.576429 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m18:14:34.586401 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 18:14:34.547695 => 18:14:34.585405
[0m18:14:34.589429 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m18:14:34.750965 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m18:14:34.768931 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:14:34.776893 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m18:14:34.779885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:14:34.921505 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:14:34.922501 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:14:34.923497 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_demo"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:14:34.936463 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:14:34.944441 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:14:34.946436 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:14:34.949432 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:14:34.959403 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:14:34.960400 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:14:34.961396 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:14:34.964389 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:14:34.978351 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:14:34.979349 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:14:34.981345 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:14:34.986330 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 18:14:34.591394 => 18:14:34.985334
[0m18:14:34.986330 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m18:14:34.988325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1672ba6c-ccb5-4a1a-85ed-176edc0c4d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024389AC7ED0>]}
[0m18:14:34.989323 [info ] [Thread-1 (]: 5 of 5 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.46s]
[0m18:14:34.992314 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m18:14:34.994309 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:34.995308 [debug] [MainThread]: On master: BEGIN
[0m18:14:34.996304 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:14:35.312645 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:14:35.314626 [debug] [MainThread]: On master: COMMIT
[0m18:14:35.316622 [debug] [MainThread]: Using postgres connection "master"
[0m18:14:35.317619 [debug] [MainThread]: On master: COMMIT
[0m18:14:35.319615 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:14:35.320612 [debug] [MainThread]: On master: Close
[0m18:14:35.323604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:14:35.325597 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m18:14:35.326596 [debug] [MainThread]: Connection 'list_flights_demo_flights_wh' was properly closed.
[0m18:14:35.327593 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m18:14:35.331581 [info ] [MainThread]: 
[0m18:14:35.333576 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 3.39 seconds (3.39s).
[0m18:14:35.342390 [debug] [MainThread]: Command end result
[0m18:14:35.375599 [info ] [MainThread]: 
[0m18:14:35.378562 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:14:35.380557 [info ] [MainThread]: 
[0m18:14:35.387544 [error] [MainThread]: [33mDatabase Error in model Fact_flights (models\Facts\Fact_flights.sql)[0m
[0m18:14:35.396515 [error] [MainThread]:   relation "flights" does not exist
[0m18:14:35.404511 [error] [MainThread]:   LINE 19:    from flights f 
[0m18:14:35.419523 [error] [MainThread]:                    ^
[0m18:14:35.424520 [error] [MainThread]:   compiled Code at target\run\flights_dbt\models\Facts\Fact_flights.sql
[0m18:14:35.441468 [info ] [MainThread]: 
[0m18:14:35.457424 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m18:14:35.472383 [debug] [MainThread]: Command `dbt run` failed at 18:14:35.471384 after 4.15 seconds
[0m18:14:35.475373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024388A7D310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002438281EB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002438281DFD0>]}
[0m18:14:35.481357 [debug] [MainThread]: Flushing usage events
[0m18:16:08.613925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF84F67710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF852D1D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF85333090>]}


============================== 18:16:08.620907 | 4a3e8b52-fbd9-4922-80fe-34b4f68f83f5 ==============================
[0m18:16:08.620907 [info ] [MainThread]: Running with dbt=1.5.3
[0m18:16:08.622901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:16:08.785470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a3e8b52-fbd9-4922-80fe-34b4f68f83f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF85049C90>]}
[0m18:16:08.840324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a3e8b52-fbd9-4922-80fe-34b4f68f83f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF85049C90>]}
[0m18:16:08.842311 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m18:16:08.890218 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m18:16:09.112589 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:16:09.114583 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models\Facts\Fact_flights.sql
[0m18:16:09.161097 [debug] [MainThread]: 1699: static parser successfully parsed Facts\Fact_flights.sql
[0m18:16:09.195006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a3e8b52-fbd9-4922-80fe-34b4f68f83f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF85A461D0>]}
[0m18:16:09.206974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a3e8b52-fbd9-4922-80fe-34b4f68f83f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF85A988D0>]}
[0m18:16:09.207971 [info ] [MainThread]: Found 5 models, 6 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:16:09.209966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a3e8b52-fbd9-4922-80fe-34b4f68f83f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF81723090>]}
[0m18:16:09.211996 [info ] [MainThread]: 
[0m18:16:09.213954 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:16:09.215949 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m18:16:09.231911 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m18:16:09.232905 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m18:16:09.233905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:09.383512 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m18:16:09.389489 [debug] [ThreadPool]: On list_flights_demo: Close
[0m18:16:09.392478 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo_flights_wh'
[0m18:16:09.401453 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:16:09.402450 [debug] [ThreadPool]: On list_flights_demo_flights_wh: BEGIN
[0m18:16:09.403448 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:16:09.471008 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:16:09.472008 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:16:09.472008 [debug] [ThreadPool]: On list_flights_demo_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo_flights_wh"} */
select
      'flights_demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:16:09.488962 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m18:16:09.491954 [debug] [ThreadPool]: On list_flights_demo_flights_wh: ROLLBACK
[0m18:16:09.492949 [debug] [ThreadPool]: On list_flights_demo_flights_wh: Close
[0m18:16:09.502924 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:09.503919 [debug] [MainThread]: On master: BEGIN
[0m18:16:09.504921 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:16:09.575610 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:16:09.577612 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:09.578602 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:16:09.626473 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:16:09.628467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a3e8b52-fbd9-4922-80fe-34b4f68f83f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF85A14290>]}
[0m18:16:09.629465 [debug] [MainThread]: On master: ROLLBACK
[0m18:16:09.630463 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:09.631479 [debug] [MainThread]: On master: BEGIN
[0m18:16:09.632456 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:16:09.632456 [debug] [MainThread]: On master: COMMIT
[0m18:16:09.633454 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:09.633454 [debug] [MainThread]: On master: COMMIT
[0m18:16:09.634452 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:16:09.635449 [debug] [MainThread]: On master: Close
[0m18:16:09.636446 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:16:09.638442 [info ] [MainThread]: 
[0m18:16:09.648414 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_Airport
[0m18:16:09.650409 [info ] [Thread-1 (]: 1 of 5 START sql incremental model flights_wh.Dim_Airport ...................... [RUN]
[0m18:16:09.651406 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flights_dbt.Dim_Airport'
[0m18:16:09.652405 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_Airport
[0m18:16:09.657390 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_Airport"
[0m18:16:09.665371 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (compile): 18:16:09.653402 => 18:16:09.660394
[0m18:16:09.666368 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_Airport
[0m18:16:09.781094 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:16:09.782092 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

    
  
    

  create temporary table "Dim_Airport__dbt_tmp181609734186"
  
  
    as
  
  (
    

select *,
    jsonb_extract_path(airport_name, 'en' )as airport_name_eng, 
    jsonb_extract_path(city, 'en' )as city_eng,
    jsonb_extract_path(airport_name, 'ru' )as airport_name_rus,
    jsonb_extract_path(city, 'en' )as city_rus,

'2023-08-16 15:16:08'::timestamp as dbt_time

from stg.airports_data
  );
  
  
[0m18:16:09.783089 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:16:09.866834 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:16:09.879798 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:16:09.880794 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: BEGIN
[0m18:16:09.882801 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:16:09.883789 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:16:09.884786 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport__dbt_tmp181609734186'
        
      order by ordinal_position

  
[0m18:16:09.920689 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:16:09.929662 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:16:09.930660 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:16:09.935646 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:16:09.951604 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:16:09.952602 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:16:09.958584 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:16:09.991497 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_Airport"
[0m18:16:09.994489 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:16:09.995487 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      
        
            delete from "flights_demo"."flights_wh"."Dim_Airport"
            where (
                airport_code) in (
                select (airport_code)
                from "Dim_Airport__dbt_tmp181609734186"
            );

        
    

    insert into "flights_demo"."flights_wh"."Dim_Airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time"
        from "Dim_Airport__dbt_tmp181609734186"
    )
  
[0m18:16:10.005483 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m18:16:10.025405 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:16:10.026403 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:16:10.027401 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:16:10.029431 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:16:10.031423 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (execute): 18:16:09.667368 => 18:16:10.030426
[0m18:16:10.031423 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: Close
[0m18:16:10.033418 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a3e8b52-fbd9-4922-80fe-34b4f68f83f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF85B80750>]}
[0m18:16:10.034384 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model flights_wh.Dim_Airport ................. [[32mINSERT 0 104[0m in 0.38s]
[0m18:16:10.037376 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_Airport
[0m18:16:10.039372 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_aircraft
[0m18:16:10.040366 [info ] [Thread-1 (]: 2 of 5 START sql incremental model flights_wh.Dim_aircraft ..................... [RUN]
[0m18:16:10.045367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_Airport, now model.flights_dbt.Dim_aircraft)
[0m18:16:10.046354 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_aircraft
[0m18:16:10.054366 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_aircraft"
[0m18:16:10.055360 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (compile): 18:16:10.047359 => 18:16:10.055360
[0m18:16:10.056323 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_aircraft
[0m18:16:10.065301 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:16:10.066300 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

    
  
    

  create temporary table "Dim_aircraft__dbt_tmp181610060314"
  
  
    as
  
  (
    

select 
    row_number() over() as dim_aircraft_id,

    ad.aircraft_code,
    ad.model,
    ad.range,
    ad.last_update,

    s. seat_no,
    s.fare_conditions,

    case when range >= 5600 then 'High'
        when range < 5600 then 'Low'
        else 'Null'
        end as range_L_H,
    jsonb_extract_path(model, 'en' )as Model_English,
    jsonb_extract_path(model, 'ru' )as Model_Russian,

'2023-08-16 15:16:08'::timestamp as dbt_time

from flights_demo.stg.aircrafts_data ad 
join flights_demo.stg.seats s 
	on s.aircraft_code = ad.aircraft_code
  );
  
  
[0m18:16:10.075276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:16:10.213906 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m18:16:10.219886 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:16:10.220883 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: BEGIN
[0m18:16:10.221884 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:16:10.222878 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:16:10.223875 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft__dbt_tmp181610060314'
        
      order by ordinal_position

  
[0m18:16:10.246815 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:16:10.250803 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:16:10.251801 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:16:10.257786 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:16:10.263768 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:16:10.264765 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:16:10.269753 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:16:10.283715 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_aircraft"
[0m18:16:10.285709 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:16:10.286708 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      insert into "flights_demo"."flights_wh"."Dim_aircraft" ("dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time")
    (
        select "dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time"
        from "Dim_aircraft__dbt_tmp181610060314"
    )


  
[0m18:16:10.298681 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m18:16:10.301668 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:16:10.302665 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:16:10.303662 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:16:10.305656 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:16:10.307652 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (execute): 18:16:10.057321 => 18:16:10.307652
[0m18:16:10.308649 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: Close
[0m18:16:10.309647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a3e8b52-fbd9-4922-80fe-34b4f68f83f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF85C0C590>]}
[0m18:16:10.311640 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model flights_wh.Dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.27s]
[0m18:16:10.312638 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_aircraft
[0m18:16:10.313635 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_flights
[0m18:16:10.314633 [info ] [Thread-1 (]: 3 of 5 START sql incremental model flights_wh.Fact_flights ..................... [RUN]
[0m18:16:10.317625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_aircraft, now model.flights_dbt.Fact_flights)
[0m18:16:10.317625 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_flights
[0m18:16:10.322611 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_flights"
[0m18:16:10.323609 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (compile): 18:16:10.318622 => 18:16:10.323609
[0m18:16:10.324606 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_flights
[0m18:16:10.331587 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_flights"
[0m18:16:10.333583 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:16:10.334580 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: BEGIN
[0m18:16:10.335593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:16:10.534047 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:16:10.536041 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:16:10.538039 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      
  
    

  create  table "flights_demo"."flights_wh"."Fact_flights"
  
  
    as
  
  (
    

with dim_flight_mod as (	
			select *,
			extract(day from (scheduled_arrival - scheduled_departure)*24) + extract(hour from (scheduled_arrival - scheduled_departure)) as flight_duration_expected,
			extract(day from (actual_arrival - actual_departure)*24) + extract(hour from (actual_arrival - actual_departure)) as duration_actual_hours
			from flights_demo.stg.flights f 
			)
select *,
    case 	when duration_actual_hours > flight_duration_expected 
                then 'Longer'
            when duration_actual_hours < flight_duration_expected 
                then 'Shorter'
            when duration_actual_hours = flight_duration_expected 
                then 'As Expected'
            else null
            end as flight_duration_case
from dim_flight_mod
  );
  
  
[0m18:16:10.763980 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m18:16:10.771958 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:16:10.772955 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:16:10.773952 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:16:10.783929 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:16:10.785885 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (execute): 18:16:10.325603 => 18:16:10.784917
[0m18:16:10.786884 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: Close
[0m18:16:10.787882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a3e8b52-fbd9-4922-80fe-34b4f68f83f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF85B9F390>]}
[0m18:16:10.789877 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model flights_wh.Fact_flights ................ [[32mSELECT 33121[0m in 0.47s]
[0m18:16:10.792871 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_flights
[0m18:16:10.793896 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m18:16:10.795862 [info ] [Thread-1 (]: 4 of 5 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m18:16:10.799852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_flights, now model.flights_dbt.my_first_dbt_model)
[0m18:16:10.800851 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m18:16:10.806832 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m18:16:10.811838 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 18:16:10.801848 => 18:16:10.807828
[0m18:16:10.814810 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m18:16:10.854706 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m18:16:10.858694 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:16:10.862688 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m18:16:10.865680 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:16:10.971392 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:16:10.972403 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:16:10.973385 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:16:10.982360 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m18:16:10.994329 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:16:10.995329 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:16:10.997322 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:16:11.003305 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:16:11.004302 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:16:11.005866 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:16:11.011837 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:16:11.014831 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:16:11.014831 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:16:11.016825 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:16:11.024803 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:16:11.025800 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_demo"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:16:11.032782 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:16:11.035776 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 18:16:10.815812 => 18:16:11.034778
[0m18:16:11.036772 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m18:16:11.038767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a3e8b52-fbd9-4922-80fe-34b4f68f83f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF859DD450>]}
[0m18:16:11.040761 [info ] [Thread-1 (]: 4 of 5 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.24s]
[0m18:16:11.043752 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m18:16:11.045747 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m18:16:11.047742 [info ] [Thread-1 (]: 5 of 5 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:16:11.050735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m18:16:11.052729 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m18:16:11.066693 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m18:16:11.071682 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 18:16:11.052729 => 18:16:11.069686
[0m18:16:11.072675 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m18:16:11.164431 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m18:16:11.170416 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:16:11.172411 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m18:16:11.174404 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:16:11.256185 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:16:11.257183 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:16:11.258179 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_demo"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:16:11.266158 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:16:11.273139 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:16:11.274136 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:16:11.275134 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:16:11.278126 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:16:11.279124 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:16:11.281118 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:16:11.283113 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:16:11.287103 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:16:11.289098 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:16:11.291091 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:16:11.294084 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 18:16:11.074673 => 18:16:11.293126
[0m18:16:11.295081 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m18:16:11.299070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a3e8b52-fbd9-4922-80fe-34b4f68f83f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF85C30590>]}
[0m18:16:11.300070 [info ] [Thread-1 (]: 5 of 5 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.25s]
[0m18:16:11.303094 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m18:16:11.305087 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:11.306054 [debug] [MainThread]: On master: BEGIN
[0m18:16:11.306054 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:16:11.417754 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:16:11.419751 [debug] [MainThread]: On master: COMMIT
[0m18:16:11.420746 [debug] [MainThread]: Using postgres connection "master"
[0m18:16:11.421743 [debug] [MainThread]: On master: COMMIT
[0m18:16:11.423739 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:16:11.425744 [debug] [MainThread]: On master: Close
[0m18:16:11.429723 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:16:11.431717 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m18:16:11.433710 [debug] [MainThread]: Connection 'list_flights_demo_flights_wh' was properly closed.
[0m18:16:11.434707 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m18:16:11.436708 [info ] [MainThread]: 
[0m18:16:11.439695 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 2.22 seconds (2.22s).
[0m18:16:11.450669 [debug] [MainThread]: Command end result
[0m18:16:11.499537 [info ] [MainThread]: 
[0m18:16:11.502534 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:16:11.504527 [info ] [MainThread]: 
[0m18:16:11.512517 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:16:11.525472 [debug] [MainThread]: Command `dbt run` succeeded at 18:16:11.524471 after 2.95 seconds
[0m18:16:11.529456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF85049E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BF84E42D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFFEDCECD0>]}
[0m18:16:11.531453 [debug] [MainThread]: Flushing usage events
[0m18:17:32.467752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A26AD4A090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A26A97AFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A26A9BEB90>]}


============================== 18:17:32.474769 | 0738d4d2-9fb6-4f1a-8cb7-ff5412d3bf9e ==============================
[0m18:17:32.474769 [info ] [MainThread]: Running with dbt=1.5.3
[0m18:17:32.477725 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:17:32.626330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0738d4d2-9fb6-4f1a-8cb7-ff5412d3bf9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A26A60FF50>]}
[0m18:17:32.650267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0738d4d2-9fb6-4f1a-8cb7-ff5412d3bf9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A26A574AD0>]}
[0m18:17:32.651263 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m18:17:32.680185 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m18:17:32.947069 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:17:32.948039 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models\Facts\Fact_flights.sql
[0m18:17:32.988932 [debug] [MainThread]: 1603: static parser failed on Facts\Fact_flights.sql
[0m18:17:33.012899 [debug] [MainThread]: 1602: parser fallback to jinja rendering on Facts\Fact_flights.sql
[0m18:17:33.025864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0738d4d2-9fb6-4f1a-8cb7-ff5412d3bf9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A26A925450>]}
[0m18:17:33.045780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0738d4d2-9fb6-4f1a-8cb7-ff5412d3bf9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A26AD6B310>]}
[0m18:17:33.047776 [info ] [MainThread]: Found 5 models, 6 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:17:33.050767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0738d4d2-9fb6-4f1a-8cb7-ff5412d3bf9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A266D632D0>]}
[0m18:17:33.052760 [info ] [MainThread]: 
[0m18:17:33.055753 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:17:33.059746 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m18:17:33.098639 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m18:17:33.103641 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m18:17:33.107642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:33.239262 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m18:17:33.241255 [debug] [ThreadPool]: On list_flights_demo: Close
[0m18:17:33.243250 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo_flights_wh'
[0m18:17:33.254223 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:17:33.255220 [debug] [ThreadPool]: On list_flights_demo_flights_wh: BEGIN
[0m18:17:33.256219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:33.319086 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:17:33.320047 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:17:33.321045 [debug] [ThreadPool]: On list_flights_demo_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo_flights_wh"} */
select
      'flights_demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:17:33.334033 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:17:33.336005 [debug] [ThreadPool]: On list_flights_demo_flights_wh: ROLLBACK
[0m18:17:33.337002 [debug] [ThreadPool]: On list_flights_demo_flights_wh: Close
[0m18:17:33.345011 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:33.346008 [debug] [MainThread]: On master: BEGIN
[0m18:17:33.346973 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:17:33.412797 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:17:33.412797 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:33.413794 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:17:33.448701 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:17:33.451693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0738d4d2-9fb6-4f1a-8cb7-ff5412d3bf9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A269EF2490>]}
[0m18:17:33.452690 [debug] [MainThread]: On master: ROLLBACK
[0m18:17:33.452690 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:33.453688 [debug] [MainThread]: On master: BEGIN
[0m18:17:33.454684 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:17:33.454684 [debug] [MainThread]: On master: COMMIT
[0m18:17:33.455683 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:33.456680 [debug] [MainThread]: On master: COMMIT
[0m18:17:33.457678 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:17:33.457678 [debug] [MainThread]: On master: Close
[0m18:17:33.459677 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:17:33.462672 [info ] [MainThread]: 
[0m18:17:33.475629 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_Airport
[0m18:17:33.476663 [info ] [Thread-1 (]: 1 of 5 START sql incremental model flights_wh.Dim_Airport ...................... [RUN]
[0m18:17:33.479624 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flights_dbt.Dim_Airport'
[0m18:17:33.480620 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_Airport
[0m18:17:33.485607 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_Airport"
[0m18:17:33.494581 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (compile): 18:17:33.480620 => 18:17:33.491612
[0m18:17:33.496574 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_Airport
[0m18:17:33.620244 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:17:33.621240 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

    
  
    

  create temporary table "Dim_Airport__dbt_tmp181733576365"
  
  
    as
  
  (
    

select *,
    jsonb_extract_path(airport_name, 'en' )as airport_name_eng, 
    jsonb_extract_path(city, 'en' )as city_eng,
    jsonb_extract_path(airport_name, 'ru' )as airport_name_rus,
    jsonb_extract_path(city, 'en' )as city_rus,

'2023-08-16 15:17:32'::timestamp as dbt_time

from stg.airports_data
  );
  
  
[0m18:17:33.622239 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:17:33.704017 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:17:33.713995 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:17:33.714990 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: BEGIN
[0m18:17:33.716987 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:17:33.717985 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:17:33.719976 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport__dbt_tmp181733576365'
        
      order by ordinal_position

  
[0m18:17:33.748900 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:17:33.760868 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:17:33.761865 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:17:33.766850 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:17:33.778819 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:17:33.779817 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:17:33.785802 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:17:33.813751 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_Airport"
[0m18:17:33.815720 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:17:33.816718 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      
        
            delete from "flights_demo"."flights_wh"."Dim_Airport"
            where (
                airport_code) in (
                select (airport_code)
                from "Dim_Airport__dbt_tmp181733576365"
            );

        
    

    insert into "flights_demo"."flights_wh"."Dim_Airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time"
        from "Dim_Airport__dbt_tmp181733576365"
    )
  
[0m18:17:33.825693 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m18:17:33.848631 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:17:33.850629 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:17:33.851625 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:17:33.854617 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:17:33.856612 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (execute): 18:17:33.496574 => 18:17:33.856612
[0m18:17:33.858604 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: Close
[0m18:17:33.859603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0738d4d2-9fb6-4f1a-8cb7-ff5412d3bf9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A26A6AF7D0>]}
[0m18:17:33.861598 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model flights_wh.Dim_Airport ................. [[32mINSERT 0 104[0m in 0.38s]
[0m18:17:33.862593 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_Airport
[0m18:17:33.863591 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_aircraft
[0m18:17:33.865587 [info ] [Thread-1 (]: 2 of 5 START sql incremental model flights_wh.Dim_aircraft ..................... [RUN]
[0m18:17:33.866584 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_Airport, now model.flights_dbt.Dim_aircraft)
[0m18:17:33.867608 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_aircraft
[0m18:17:33.871595 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_aircraft"
[0m18:17:33.873564 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (compile): 18:17:33.867608 => 18:17:33.872592
[0m18:17:33.874562 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_aircraft
[0m18:17:33.891517 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:17:33.893513 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

    
  
    

  create temporary table "Dim_aircraft__dbt_tmp181733884538"
  
  
    as
  
  (
    

select 
    row_number() over() as dim_aircraft_id,

    ad.aircraft_code,
    ad.model,
    ad.range,
    ad.last_update,

    s. seat_no,
    s.fare_conditions,

    case when range >= 5600 then 'High'
        when range < 5600 then 'Low'
        else 'Null'
        end as range_L_H,
    jsonb_extract_path(model, 'en' )as Model_English,
    jsonb_extract_path(model, 'ru' )as Model_Russian,

'2023-08-16 15:17:32'::timestamp as dbt_time

from flights_demo.stg.aircrafts_data ad 
join flights_demo.stg.seats s 
	on s.aircraft_code = ad.aircraft_code
  );
  
  
[0m18:17:33.894510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:34.000228 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m18:17:34.004242 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:17:34.004242 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: BEGIN
[0m18:17:34.006213 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:17:34.009238 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:17:34.011198 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft__dbt_tmp181733884538'
        
      order by ordinal_position

  
[0m18:17:34.037128 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:17:34.046104 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:17:34.047102 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:17:34.059086 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:17:34.066051 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:17:34.067047 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:17:34.077055 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:17:34.089004 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_aircraft"
[0m18:17:34.090999 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:17:34.091987 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      insert into "flights_demo"."flights_wh"."Dim_aircraft" ("dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time")
    (
        select "dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time"
        from "Dim_aircraft__dbt_tmp181733884538"
    )


  
[0m18:17:34.098962 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m18:17:34.101954 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:17:34.102953 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:17:34.103949 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:17:34.106943 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:17:34.108936 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (execute): 18:17:33.874562 => 18:17:34.108936
[0m18:17:34.109933 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: Close
[0m18:17:34.111928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0738d4d2-9fb6-4f1a-8cb7-ff5412d3bf9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A26B1EF7D0>]}
[0m18:17:34.112926 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model flights_wh.Dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.24s]
[0m18:17:34.116918 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_aircraft
[0m18:17:34.118913 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_flights
[0m18:17:34.120908 [info ] [Thread-1 (]: 3 of 5 START sql incremental model flights_wh.Fact_flights ..................... [RUN]
[0m18:17:34.122900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_aircraft, now model.flights_dbt.Fact_flights)
[0m18:17:34.123933 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_flights
[0m18:17:34.141852 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_flights"
[0m18:17:34.144843 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (compile): 18:17:34.124896 => 18:17:34.143846
[0m18:17:34.145841 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_flights
[0m18:17:34.171767 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:17:34.172766 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

    
  
    

  create temporary table "Fact_flights__dbt_tmp181734159800"
  
  
    as
  
  (
    

with dim_flight_mod as (	
			select *,
			extract(day from (scheduled_arrival - scheduled_departure)*24) + extract(hour from (scheduled_arrival - scheduled_departure)) as flight_duration_expected,
			extract(day from (actual_arrival - actual_departure)*24) + extract(hour from (actual_arrival - actual_departure)) as duration_actual_hours
			from flights_demo.stg.flights f 
			)
select *,
    case 	when duration_actual_hours > flight_duration_expected 
                then 'Longer'
            when duration_actual_hours < flight_duration_expected 
                then 'Shorter'
            when duration_actual_hours = flight_duration_expected 
                then 'As Expected'
            else null
            end as flight_duration_case,

'2023-08-16 15:17:32'::timestamp as dbt_time

from dim_flight_mod
  );
  
  
[0m18:17:34.173763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:34.408219 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m18:17:34.413162 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:17:34.414162 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: BEGIN
[0m18:17:34.415191 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:17:34.416188 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:17:34.417185 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights__dbt_tmp181734159800'
        
      order by ordinal_position

  
[0m18:17:34.437098 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:17:34.441112 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:17:34.442109 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:17:34.447071 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.0 seconds
[0m18:17:34.452058 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:17:34.453055 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:17:34.458041 [debug] [Thread-1 (]: SQL status: SELECT 14 in 0.0 seconds
[0m18:17:34.462031 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_flights"
[0m18:17:34.464025 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:17:34.465024 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      
        
            delete from "flights_demo"."flights_wh"."Fact_flights"
            where (
                flight_id) in (
                select (flight_id)
                from "Fact_flights__dbt_tmp181734159800"
            );

        
    

    insert into "flights_demo"."flights_wh"."Fact_flights" ("flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case")
    (
        select "flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case"
        from "Fact_flights__dbt_tmp181734159800"
    )
  
[0m18:17:34.704383 [debug] [Thread-1 (]: SQL status: INSERT 0 33121 in 0.0 seconds
[0m18:17:34.708374 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:17:34.709373 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:17:34.710401 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:17:34.723332 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:17:34.725353 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (execute): 18:17:34.146837 => 18:17:34.724357
[0m18:17:34.725353 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: Close
[0m18:17:34.726326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0738d4d2-9fb6-4f1a-8cb7-ff5412d3bf9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A26B1E2D10>]}
[0m18:17:34.728320 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model flights_wh.Fact_flights ................ [[32mINSERT 0 33121[0m in 0.60s]
[0m18:17:34.731311 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_flights
[0m18:17:34.732313 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m18:17:34.733305 [info ] [Thread-1 (]: 4 of 5 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m18:17:34.735300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_flights, now model.flights_dbt.my_first_dbt_model)
[0m18:17:34.736297 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m18:17:34.740291 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m18:17:34.742283 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 18:17:34.736297 => 18:17:34.741284
[0m18:17:34.742283 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m18:17:34.784204 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m18:17:34.787168 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:17:34.791162 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m18:17:34.793149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:34.874935 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:17:34.876924 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:17:34.877919 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:17:34.883903 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m18:17:34.891881 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:17:34.892879 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:17:34.895870 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:17:34.902854 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:17:34.903852 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:17:34.904850 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:17:34.919809 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:17:34.920806 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:17:34.920806 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:17:34.924794 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:17:34.933769 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:17:34.934767 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_demo"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:17:34.939754 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:17:34.941749 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 18:17:34.743280 => 18:17:34.941749
[0m18:17:34.942745 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m18:17:34.943743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0738d4d2-9fb6-4f1a-8cb7-ff5412d3bf9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A26B14BE90>]}
[0m18:17:34.945738 [info ] [Thread-1 (]: 4 of 5 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.21s]
[0m18:17:34.948731 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m18:17:34.949727 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m18:17:34.950724 [info ] [Thread-1 (]: 5 of 5 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:17:34.952719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m18:17:34.953718 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m18:17:34.958706 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m18:17:34.962694 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 18:17:34.954717 => 18:17:34.960701
[0m18:17:34.965697 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m18:17:35.043480 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m18:17:35.045471 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:17:35.046469 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m18:17:35.048467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:35.107305 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:17:35.108303 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:17:35.108303 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_demo"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:17:35.116282 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:17:35.120271 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:17:35.121267 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:17:35.123264 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:17:35.126255 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:17:35.127253 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:17:35.128250 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:17:35.132239 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:17:35.137227 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:17:35.138223 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:17:35.140217 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:17:35.142212 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 18:17:34.970674 => 18:17:35.141215
[0m18:17:35.143209 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m18:17:35.144206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0738d4d2-9fb6-4f1a-8cb7-ff5412d3bf9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A26B009450>]}
[0m18:17:35.145205 [info ] [Thread-1 (]: 5 of 5 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.19s]
[0m18:17:35.148203 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m18:17:35.150190 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:35.151188 [debug] [MainThread]: On master: BEGIN
[0m18:17:35.151188 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:17:35.225989 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:17:35.226988 [debug] [MainThread]: On master: COMMIT
[0m18:17:35.226988 [debug] [MainThread]: Using postgres connection "master"
[0m18:17:35.227983 [debug] [MainThread]: On master: COMMIT
[0m18:17:35.229982 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:17:35.232979 [debug] [MainThread]: On master: Close
[0m18:17:35.234964 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:35.235962 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m18:17:35.236963 [debug] [MainThread]: Connection 'list_flights_demo_flights_wh' was properly closed.
[0m18:17:35.236963 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m18:17:35.239952 [info ] [MainThread]: 
[0m18:17:35.241946 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 2.18 seconds (2.18s).
[0m18:17:35.243973 [debug] [MainThread]: Command end result
[0m18:17:35.253961 [info ] [MainThread]: 
[0m18:17:35.255909 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:17:35.257938 [info ] [MainThread]: 
[0m18:17:35.260902 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:17:35.263888 [debug] [MainThread]: Command `dbt run` succeeded at 18:17:35.263888 after 2.82 seconds
[0m18:17:35.264886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A26A60EE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A26A9BEB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A26A69F650>]}
[0m18:17:35.265883 [debug] [MainThread]: Flushing usage events
[0m18:18:23.952737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA036C2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA0653150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA0651FD0>]}


============================== 18:18:23.958684 | 71809c32-7ef2-4be8-8f6c-d94dd40a9764 ==============================
[0m18:18:23.958684 [info ] [MainThread]: Running with dbt=1.5.3
[0m18:18:23.960679 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:18:24.100827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71809c32-7ef2-4be8-8f6c-d94dd40a9764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA071F750>]}
[0m18:18:24.124764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71809c32-7ef2-4be8-8f6c-d94dd40a9764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA0AADD10>]}
[0m18:18:24.127119 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m18:18:24.145041 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m18:18:24.269229 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:18:24.270227 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:18:24.279236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71809c32-7ef2-4be8-8f6c-d94dd40a9764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA037F950>]}
[0m18:18:24.289186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71809c32-7ef2-4be8-8f6c-d94dd40a9764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA0D43850>]}
[0m18:18:24.290174 [info ] [MainThread]: Found 5 models, 6 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:18:24.291172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71809c32-7ef2-4be8-8f6c-d94dd40a9764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB9CAC3090>]}
[0m18:18:24.293199 [info ] [MainThread]: 
[0m18:18:24.295160 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:18:24.298152 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m18:18:24.313145 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m18:18:24.314176 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m18:18:24.316107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:24.452779 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m18:18:24.454766 [debug] [ThreadPool]: On list_flights_demo: Close
[0m18:18:24.457727 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo_flights_wh'
[0m18:18:24.465705 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:18:24.467703 [debug] [ThreadPool]: On list_flights_demo_flights_wh: BEGIN
[0m18:18:24.468699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:18:24.541502 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:18:24.542501 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:18:24.543498 [debug] [ThreadPool]: On list_flights_demo_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo_flights_wh"} */
select
      'flights_demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:18:24.555464 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m18:18:24.558458 [debug] [ThreadPool]: On list_flights_demo_flights_wh: ROLLBACK
[0m18:18:24.559457 [debug] [ThreadPool]: On list_flights_demo_flights_wh: Close
[0m18:18:24.568430 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:24.569427 [debug] [MainThread]: On master: BEGIN
[0m18:18:24.570424 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:18:24.629268 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:18:24.630320 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:24.631261 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:18:24.665211 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:18:24.669163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71809c32-7ef2-4be8-8f6c-d94dd40a9764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA0D9FE10>]}
[0m18:18:24.670160 [debug] [MainThread]: On master: ROLLBACK
[0m18:18:24.671192 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:24.671192 [debug] [MainThread]: On master: BEGIN
[0m18:18:24.672185 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:18:24.673182 [debug] [MainThread]: On master: COMMIT
[0m18:18:24.673182 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:24.674148 [debug] [MainThread]: On master: COMMIT
[0m18:18:24.675143 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:18:24.675143 [debug] [MainThread]: On master: Close
[0m18:18:24.676170 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:18:24.678136 [info ] [MainThread]: 
[0m18:18:24.687115 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_Airport
[0m18:18:24.688111 [info ] [Thread-1 (]: 1 of 5 START sql incremental model flights_wh.Dim_Airport ...................... [RUN]
[0m18:18:24.692103 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flights_dbt.Dim_Airport'
[0m18:18:24.694098 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_Airport
[0m18:18:24.705065 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_Airport"
[0m18:18:24.709056 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (compile): 18:18:24.696108 => 18:18:24.708062
[0m18:18:24.710053 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_Airport
[0m18:18:24.830730 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:18:24.830730 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

    
  
    

  create temporary table "Dim_Airport__dbt_tmp181824776874"
  
  
    as
  
  (
    

select *,
    jsonb_extract_path(airport_name, 'en' )as airport_name_eng, 
    jsonb_extract_path(city, 'en' )as city_eng,
    jsonb_extract_path(airport_name, 'ru' )as airport_name_rus,
    jsonb_extract_path(city, 'en' )as city_rus,

'2023-08-16 15:18:23'::timestamp as dbt_time

from stg.airports_data
  );
  
  
[0m18:18:24.831727 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:18:24.915517 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:18:24.924525 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:18:24.925492 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: BEGIN
[0m18:18:24.926489 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:18:24.927487 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:18:24.927487 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport__dbt_tmp181824776874'
        
      order by ordinal_position

  
[0m18:18:24.958428 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:18:24.970382 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:18:24.971374 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:18:24.977353 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:18:24.989320 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:18:24.990317 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:18:24.995306 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:18:25.027220 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_Airport"
[0m18:18:25.030211 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:18:25.031211 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      
        
            delete from "flights_demo"."flights_wh"."Dim_Airport"
            where (
                airport_code) in (
                select (airport_code)
                from "Dim_Airport__dbt_tmp181824776874"
            );

        
    

    insert into "flights_demo"."flights_wh"."Dim_Airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time"
        from "Dim_Airport__dbt_tmp181824776874"
    )
  
[0m18:18:25.042179 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m18:18:25.087058 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:18:25.088056 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:18:25.090051 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:18:25.093044 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:18:25.096034 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (execute): 18:18:24.711051 => 18:18:25.096034
[0m18:18:25.098030 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: Close
[0m18:18:25.102024 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71809c32-7ef2-4be8-8f6c-d94dd40a9764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA0E10390>]}
[0m18:18:25.106011 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model flights_wh.Dim_Airport ................. [[32mINSERT 0 104[0m in 0.41s]
[0m18:18:25.111993 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_Airport
[0m18:18:25.112990 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_aircraft
[0m18:18:25.114984 [info ] [Thread-1 (]: 2 of 5 START sql incremental model flights_wh.Dim_aircraft ..................... [RUN]
[0m18:18:25.116979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_Airport, now model.flights_dbt.Dim_aircraft)
[0m18:18:25.118974 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_aircraft
[0m18:18:25.128947 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_aircraft"
[0m18:18:25.132939 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (compile): 18:18:25.119972 => 18:18:25.130942
[0m18:18:25.135497 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_aircraft
[0m18:18:25.182347 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:18:25.189325 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

    
  
    

  create temporary table "Dim_aircraft__dbt_tmp181825160402"
  
  
    as
  
  (
    

select 
    row_number() over() as dim_aircraft_id,

    ad.aircraft_code,
    ad.model,
    ad.range,
    ad.last_update,

    s. seat_no,
    s.fare_conditions,

    case when range >= 5600 then 'High'
        when range < 5600 then 'Low'
        else 'Null'
        end as range_L_H,
    jsonb_extract_path(model, 'en' )as Model_English,
    jsonb_extract_path(model, 'ru' )as Model_Russian,

'2023-08-16 15:18:23'::timestamp as dbt_time

from flights_demo.stg.aircrafts_data ad 
join flights_demo.stg.seats s 
	on s.aircraft_code = ad.aircraft_code
  );
  
  
[0m18:18:25.199298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:25.338923 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m18:18:25.344906 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:18:25.345903 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: BEGIN
[0m18:18:25.348898 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:18:25.350892 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:18:25.353883 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft__dbt_tmp181825160402'
        
      order by ordinal_position

  
[0m18:18:25.385796 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:18:25.395772 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:18:25.397768 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:18:25.408739 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:18:25.419708 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:18:25.420704 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:18:25.428683 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:18:25.445637 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_aircraft"
[0m18:18:25.447635 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:18:25.449629 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      insert into "flights_demo"."flights_wh"."Dim_aircraft" ("dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time")
    (
        select "dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time"
        from "Dim_aircraft__dbt_tmp181825160402"
    )


  
[0m18:18:25.457604 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m18:18:25.462593 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:18:25.463589 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:18:25.465585 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:18:25.469573 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:18:25.472566 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (execute): 18:18:25.145444 => 18:18:25.472566
[0m18:18:25.474561 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: Close
[0m18:18:25.476555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71809c32-7ef2-4be8-8f6c-d94dd40a9764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA0EFDD50>]}
[0m18:18:25.478550 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model flights_wh.Dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.36s]
[0m18:18:25.482539 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_aircraft
[0m18:18:25.483536 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_flights
[0m18:18:25.485531 [info ] [Thread-1 (]: 3 of 5 START sql incremental model flights_wh.Fact_flights ..................... [RUN]
[0m18:18:25.488524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_aircraft, now model.flights_dbt.Fact_flights)
[0m18:18:25.489520 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_flights
[0m18:18:25.502486 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_flights"
[0m18:18:25.517449 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (compile): 18:18:25.491517 => 18:18:25.508480
[0m18:18:25.519443 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_flights
[0m18:18:25.542379 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_flights"
[0m18:18:25.545371 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:18:25.546367 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: BEGIN
[0m18:18:25.547366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:25.677328 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:18:25.679322 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:18:25.680320 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      
  
    

  create  table "flights_demo"."flights_wh"."Fact_flights"
  
  
    as
  
  (
    

with dim_flight_mod as (	
			select *,
			extract(day from (scheduled_arrival - scheduled_departure)*24) + extract(hour from (scheduled_arrival - scheduled_departure)) as flight_duration_expected,
			extract(day from (actual_arrival - actual_departure)*24) + extract(hour from (actual_arrival - actual_departure)) as duration_actual_hours
			from flights_demo.stg.flights f 
			)
select *,
    case 	when duration_actual_hours > flight_duration_expected 
                then 'Longer'
            when duration_actual_hours < flight_duration_expected 
                then 'Shorter'
            when duration_actual_hours = flight_duration_expected 
                then 'As Expected'
            else null
            end as flight_duration_case,

'2023-08-16 15:18:23'::timestamp as dbt_time

from dim_flight_mod
  );
  
  
[0m18:18:26.079750 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m18:18:26.096706 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:18:26.099699 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:18:26.102688 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:18:26.119645 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:18:26.121638 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (execute): 18:18:25.524428 => 18:18:26.121638
[0m18:18:26.122635 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: Close
[0m18:18:26.124636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71809c32-7ef2-4be8-8f6c-d94dd40a9764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA0D48790>]}
[0m18:18:26.127627 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model flights_wh.Fact_flights ................ [[32mSELECT 33121[0m in 0.64s]
[0m18:18:26.130615 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_flights
[0m18:18:26.132611 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m18:18:26.133608 [info ] [Thread-1 (]: 4 of 5 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m18:18:26.136599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_flights, now model.flights_dbt.my_first_dbt_model)
[0m18:18:26.138592 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m18:18:26.144576 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m18:18:26.150586 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 18:18:26.139590 => 18:18:26.146571
[0m18:18:26.156547 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m18:18:26.209409 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m18:18:26.216406 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:18:26.223369 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m18:18:26.224363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:26.313126 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:18:26.314125 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:18:26.316118 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:18:26.327091 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m18:18:26.346037 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:18:26.348032 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:18:26.354018 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:18:26.360001 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:18:26.360997 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:18:26.361995 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:18:26.369974 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:18:26.370971 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:18:26.371969 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:18:26.373966 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:18:26.385930 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:18:26.386928 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_demo"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:18:26.393909 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:18:26.397898 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 18:18:26.158543 => 18:18:26.396901
[0m18:18:26.399894 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m18:18:26.401888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71809c32-7ef2-4be8-8f6c-d94dd40a9764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA0FAA3D0>]}
[0m18:18:26.403885 [info ] [Thread-1 (]: 4 of 5 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.27s]
[0m18:18:26.406878 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m18:18:26.408870 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m18:18:26.409868 [info ] [Thread-1 (]: 5 of 5 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:18:26.412859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m18:18:26.413857 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m18:18:26.421835 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m18:18:26.424829 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 18:18:26.414856 => 18:18:26.423829
[0m18:18:26.425826 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m18:18:26.505613 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m18:18:26.508605 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:18:26.509600 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m18:18:26.510598 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:18:26.590385 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:18:26.591381 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:18:26.592378 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_demo"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:18:26.608338 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:18:26.613323 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:18:26.614320 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:18:26.616319 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:18:26.620304 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:18:26.620304 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:18:26.621301 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:18:26.623296 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:18:26.629291 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:18:26.631274 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:18:26.633269 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:18:26.636261 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 18:18:26.427827 => 18:18:26.636261
[0m18:18:26.637259 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m18:18:26.639279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71809c32-7ef2-4be8-8f6c-d94dd40a9764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA0D60E50>]}
[0m18:18:26.641248 [info ] [Thread-1 (]: 5 of 5 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.23s]
[0m18:18:26.644241 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m18:18:26.648231 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:26.651227 [debug] [MainThread]: On master: BEGIN
[0m18:18:26.653223 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:18:26.756948 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:18:26.756948 [debug] [MainThread]: On master: COMMIT
[0m18:18:26.757943 [debug] [MainThread]: Using postgres connection "master"
[0m18:18:26.758942 [debug] [MainThread]: On master: COMMIT
[0m18:18:26.759939 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:18:26.759939 [debug] [MainThread]: On master: Close
[0m18:18:26.761933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:18:26.762930 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m18:18:26.762930 [debug] [MainThread]: Connection 'list_flights_demo_flights_wh' was properly closed.
[0m18:18:26.763929 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m18:18:26.765932 [info ] [MainThread]: 
[0m18:18:26.767917 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 2.47 seconds (2.47s).
[0m18:18:26.770910 [debug] [MainThread]: Command end result
[0m18:18:26.785875 [info ] [MainThread]: 
[0m18:18:26.787864 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:18:26.789859 [info ] [MainThread]: 
[0m18:18:26.790856 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:18:26.796842 [debug] [MainThread]: Command `dbt run` succeeded at 18:18:26.796842 after 2.87 seconds
[0m18:18:26.803836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA03EFC90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA059D650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA042EED0>]}
[0m18:18:26.807815 [debug] [MainThread]: Flushing usage events
[0m18:19:27.886978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D62FB2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D62FB290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D67ACE10>]}


============================== 18:19:27.892962 | f2905e69-07ef-4639-aa5b-882604efebff ==============================
[0m18:19:27.892962 [info ] [MainThread]: Running with dbt=1.5.3
[0m18:19:27.894929 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:19:28.030566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2905e69-07ef-4639-aa5b-882604efebff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D8873B90>]}
[0m18:19:28.050515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2905e69-07ef-4639-aa5b-882604efebff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D88DE3D0>]}
[0m18:19:28.052508 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m18:19:28.081430 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m18:19:28.212120 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:19:28.212120 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models\Facts\schema.yml
[0m18:19:28.281894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2905e69-07ef-4639-aa5b-882604efebff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D8BE6290>]}
[0m18:19:28.293863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2905e69-07ef-4639-aa5b-882604efebff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D8D39510>]}
[0m18:19:28.294860 [info ] [MainThread]: Found 5 models, 8 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:19:28.295857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2905e69-07ef-4639-aa5b-882604efebff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D9005A90>]}
[0m18:19:28.298850 [info ] [MainThread]: 
[0m18:19:28.301843 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:19:28.304833 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m18:19:28.336752 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m18:19:28.338750 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m18:19:28.341737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:28.462412 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m18:19:28.464406 [debug] [ThreadPool]: On list_flights_demo: Close
[0m18:19:28.466401 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo_flights_wh'
[0m18:19:28.473382 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:19:28.473382 [debug] [ThreadPool]: On list_flights_demo_flights_wh: BEGIN
[0m18:19:28.474381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:28.643372 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:19:28.644367 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:19:28.645365 [debug] [ThreadPool]: On list_flights_demo_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo_flights_wh"} */
select
      'flights_demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:19:28.663314 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:19:28.665312 [debug] [ThreadPool]: On list_flights_demo_flights_wh: ROLLBACK
[0m18:19:28.666307 [debug] [ThreadPool]: On list_flights_demo_flights_wh: Close
[0m18:19:28.672291 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:28.673288 [debug] [MainThread]: On master: BEGIN
[0m18:19:28.674285 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:19:28.740114 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:19:28.742104 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:28.743101 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:19:28.771066 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:19:28.773055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2905e69-07ef-4639-aa5b-882604efebff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D8B80F10>]}
[0m18:19:28.774052 [debug] [MainThread]: On master: ROLLBACK
[0m18:19:28.774052 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:28.775016 [debug] [MainThread]: On master: BEGIN
[0m18:19:28.776013 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:19:28.776013 [debug] [MainThread]: On master: COMMIT
[0m18:19:28.776013 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:28.777011 [debug] [MainThread]: On master: COMMIT
[0m18:19:28.778008 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:19:28.778008 [debug] [MainThread]: On master: Close
[0m18:19:28.779006 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:19:28.781000 [info ] [MainThread]: 
[0m18:19:28.789979 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_Airport
[0m18:19:28.789979 [info ] [Thread-1 (]: 1 of 5 START sql incremental model flights_wh.Dim_Airport ...................... [RUN]
[0m18:19:28.793971 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flights_dbt.Dim_Airport'
[0m18:19:28.794993 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_Airport
[0m18:19:28.800955 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_Airport"
[0m18:19:28.802942 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (compile): 18:19:28.794993 => 18:19:28.802942
[0m18:19:28.804944 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_Airport
[0m18:19:28.912185 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:19:28.913183 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

    
  
    

  create temporary table "Dim_Airport__dbt_tmp181928870313"
  
  
    as
  
  (
    

select *,
    jsonb_extract_path(airport_name, 'en' )as airport_name_eng, 
    jsonb_extract_path(city, 'en' )as city_eng,
    jsonb_extract_path(airport_name, 'ru' )as airport_name_rus,
    jsonb_extract_path(city, 'en' )as city_rus,

'2023-08-16 15:19:27'::timestamp as dbt_time

from stg.airports_data
  );
  
  
[0m18:19:28.914181 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:19:28.981172 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:19:28.991172 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:19:28.992141 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: BEGIN
[0m18:19:28.993136 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:19:28.994167 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:19:28.994167 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport__dbt_tmp181928870313'
        
      order by ordinal_position

  
[0m18:19:29.016097 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:19:29.024055 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:19:29.025051 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:19:29.030039 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:19:29.039016 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:19:29.039016 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:19:29.045000 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:19:29.072924 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_Airport"
[0m18:19:29.074919 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:19:29.075916 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      
        
            delete from "flights_demo"."flights_wh"."Dim_Airport"
            where (
                airport_code) in (
                select (airport_code)
                from "Dim_Airport__dbt_tmp181928870313"
            );

        
    

    insert into "flights_demo"."flights_wh"."Dim_Airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time"
        from "Dim_Airport__dbt_tmp181928870313"
    )
  
[0m18:19:29.083895 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m18:19:29.102842 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:19:29.103839 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:19:29.104837 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:19:29.112817 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:19:29.114829 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (execute): 18:19:28.808937 => 18:19:29.114829
[0m18:19:29.116806 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: Close
[0m18:19:29.119800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2905e69-07ef-4639-aa5b-882604efebff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D8FD0090>]}
[0m18:19:29.122791 [info ] [Thread-1 (]: 1 of 5 OK created sql incremental model flights_wh.Dim_Airport ................. [[32mINSERT 0 104[0m in 0.33s]
[0m18:19:29.126288 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_Airport
[0m18:19:29.127266 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_aircraft
[0m18:19:29.128262 [info ] [Thread-1 (]: 2 of 5 START sql incremental model flights_wh.Dim_aircraft ..................... [RUN]
[0m18:19:29.130257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_Airport, now model.flights_dbt.Dim_aircraft)
[0m18:19:29.131254 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_aircraft
[0m18:19:29.136240 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_aircraft"
[0m18:19:29.138236 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (compile): 18:19:29.132251 => 18:19:29.137238
[0m18:19:29.140233 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_aircraft
[0m18:19:29.168158 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:19:29.169153 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

    
  
    

  create temporary table "Dim_aircraft__dbt_tmp181929154196"
  
  
    as
  
  (
    

select 
    row_number() over() as dim_aircraft_id,

    ad.aircraft_code,
    ad.model,
    ad.range,
    ad.last_update,

    s. seat_no,
    s.fare_conditions,

    case when range >= 5600 then 'High'
        when range < 5600 then 'Low'
        else 'Null'
        end as range_L_H,
    jsonb_extract_path(model, 'en' )as Model_English,
    jsonb_extract_path(model, 'ru' )as Model_Russian,

'2023-08-16 15:19:27'::timestamp as dbt_time

from flights_demo.stg.aircrafts_data ad 
join flights_demo.stg.seats s 
	on s.aircraft_code = ad.aircraft_code
  );
  
  
[0m18:19:29.171150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:29.263900 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m18:19:29.267892 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:19:29.268890 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: BEGIN
[0m18:19:29.270881 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:19:29.270881 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:19:29.271878 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft__dbt_tmp181929154196'
        
      order by ordinal_position

  
[0m18:19:29.285841 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:19:29.290827 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:19:29.290827 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:19:29.294816 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:19:29.298807 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:19:29.300803 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:19:29.304828 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:19:29.315796 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_aircraft"
[0m18:19:29.316759 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:19:29.317757 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      insert into "flights_demo"."flights_wh"."Dim_aircraft" ("dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time")
    (
        select "dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time"
        from "Dim_aircraft__dbt_tmp181929154196"
    )


  
[0m18:19:29.321777 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m18:19:29.324769 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:19:29.324769 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:19:29.325769 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:19:29.327729 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:19:29.329754 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (execute): 18:19:29.142230 => 18:19:29.329754
[0m18:19:29.330721 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: Close
[0m18:19:29.331720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2905e69-07ef-4639-aa5b-882604efebff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D91E0090>]}
[0m18:19:29.332716 [info ] [Thread-1 (]: 2 of 5 OK created sql incremental model flights_wh.Dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.20s]
[0m18:19:29.334711 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_aircraft
[0m18:19:29.334711 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_flights
[0m18:19:29.335709 [info ] [Thread-1 (]: 3 of 5 START sql incremental model flights_wh.Fact_flights ..................... [RUN]
[0m18:19:29.336705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_aircraft, now model.flights_dbt.Fact_flights)
[0m18:19:29.337702 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_flights
[0m18:19:29.340721 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_flights"
[0m18:19:29.342689 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (compile): 18:19:29.337702 => 18:19:29.342689
[0m18:19:29.343688 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_flights
[0m18:19:29.350707 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:19:29.353696 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

    
  
    

  create temporary table "Fact_flights__dbt_tmp181929346707"
  
  
    as
  
  (
    

with dim_flight_mod as (	
			select *,
			extract(day from (scheduled_arrival - scheduled_departure)*24) + extract(hour from (scheduled_arrival - scheduled_departure)) as flight_duration_expected,
			extract(day from (actual_arrival - actual_departure)*24) + extract(hour from (actual_arrival - actual_departure)) as duration_actual_hours
			from flights_demo.stg.flights f 
			)
select *,
    case 	when duration_actual_hours > flight_duration_expected 
                then 'Longer'
            when duration_actual_hours < flight_duration_expected 
                then 'Shorter'
            when duration_actual_hours = flight_duration_expected 
                then 'As Expected'
            else null
            end as flight_duration_case,

'2023-08-16 15:19:27'::timestamp as dbt_time

from dim_flight_mod
  );
  
  
[0m18:19:29.354657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:29.671695 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m18:19:29.674714 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:19:29.675711 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: BEGIN
[0m18:19:29.676682 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:19:29.677711 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:19:29.677711 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights__dbt_tmp181929346707'
        
      order by ordinal_position

  
[0m18:19:29.694634 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:19:29.697657 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:19:29.698626 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:19:29.703619 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:19:29.710636 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:19:29.711590 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:19:29.715614 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:19:29.719569 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_flights"
[0m18:19:29.720604 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:19:29.721563 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      
        
            delete from "flights_demo"."flights_wh"."Fact_flights"
            where (
                flight_id) in (
                select (flight_id)
                from "Fact_flights__dbt_tmp181929346707"
            );

        
    

    insert into "flights_demo"."flights_wh"."Fact_flights" ("flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time")
    (
        select "flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time"
        from "Fact_flights__dbt_tmp181929346707"
    )
  
[0m18:19:29.844610 [debug] [Thread-1 (]: SQL status: INSERT 0 33121 in 0.0 seconds
[0m18:19:29.847603 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:19:29.847603 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:19:29.848601 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:19:29.860577 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:19:29.861574 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (execute): 18:19:29.344684 => 18:19:29.861574
[0m18:19:29.862572 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: Close
[0m18:19:29.864572 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2905e69-07ef-4639-aa5b-882604efebff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D91E2210>]}
[0m18:19:29.866566 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model flights_wh.Fact_flights ................ [[32mINSERT 0 33121[0m in 0.53s]
[0m18:19:29.870553 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_flights
[0m18:19:29.871553 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m18:19:29.872545 [info ] [Thread-1 (]: 4 of 5 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m18:19:29.874540 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_flights, now model.flights_dbt.my_first_dbt_model)
[0m18:19:29.874540 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m18:19:29.877568 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m18:19:29.880533 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 18:19:29.875537 => 18:19:29.879530
[0m18:19:29.881563 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m18:19:29.910445 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m18:19:29.912439 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:19:29.913436 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m18:19:29.913436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:29.987244 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:19:29.989234 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:19:29.990231 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:19:29.996213 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m18:19:30.003225 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:19:30.004221 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:19:30.006186 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:19:30.009178 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:19:30.010207 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:19:30.011173 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:19:30.020177 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:19:30.021145 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:19:30.021145 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:19:30.025144 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:19:30.032118 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:19:30.033141 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_demo"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:19:30.038127 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:19:30.040128 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 18:19:29.883532 => 18:19:30.040128
[0m18:19:30.040128 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m18:19:30.041124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2905e69-07ef-4639-aa5b-882604efebff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D8D20C90>]}
[0m18:19:30.042089 [info ] [Thread-1 (]: 4 of 5 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.17s]
[0m18:19:30.043087 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m18:19:30.044118 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m18:19:30.045113 [info ] [Thread-1 (]: 5 of 5 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:19:30.046080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m18:19:30.047079 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m18:19:30.050069 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m18:19:30.052063 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 18:19:30.047079 => 18:19:30.051067
[0m18:19:30.052063 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m18:19:30.082005 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m18:19:30.085975 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:19:30.086975 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m18:19:30.087968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:30.187701 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:19:30.188698 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:19:30.189696 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_demo"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:19:30.196678 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:19:30.201681 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:19:30.202662 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:19:30.203663 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:19:30.206652 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:19:30.207650 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:19:30.208644 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:19:30.209646 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:19:30.212634 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:19:30.213630 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:19:30.214629 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:19:30.215626 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 18:19:30.052063 => 18:19:30.215626
[0m18:19:30.216625 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m18:19:30.217622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2905e69-07ef-4639-aa5b-882604efebff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D9236850>]}
[0m18:19:30.218618 [info ] [Thread-1 (]: 5 of 5 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.17s]
[0m18:19:30.219616 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m18:19:30.221610 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:30.222607 [debug] [MainThread]: On master: BEGIN
[0m18:19:30.223605 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:19:30.294459 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:19:30.295448 [debug] [MainThread]: On master: COMMIT
[0m18:19:30.296416 [debug] [MainThread]: Using postgres connection "master"
[0m18:19:30.297415 [debug] [MainThread]: On master: COMMIT
[0m18:19:30.298440 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:19:30.299407 [debug] [MainThread]: On master: Close
[0m18:19:30.301410 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:19:30.303394 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m18:19:30.304427 [debug] [MainThread]: Connection 'list_flights_demo_flights_wh' was properly closed.
[0m18:19:30.305386 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m18:19:30.307444 [info ] [MainThread]: 
[0m18:19:30.309376 [info ] [MainThread]: Finished running 3 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 2.01 seconds (2.01s).
[0m18:19:30.311405 [debug] [MainThread]: Command end result
[0m18:19:30.318387 [info ] [MainThread]: 
[0m18:19:30.319350 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:19:30.320388 [info ] [MainThread]: 
[0m18:19:30.321344 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:19:30.323342 [debug] [MainThread]: Command `dbt run` succeeded at 18:19:30.323342 after 2.46 seconds
[0m18:19:30.324337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D62FB2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D26F6C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000284D26F4110>]}
[0m18:19:30.325370 [debug] [MainThread]: Flushing usage events
[0m18:25:37.683419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011F2A64ED90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011F2A639CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011F2A6442D0>]}


============================== 18:25:37.689404 | 65637b5e-5643-4f32-a816-938d2ce17bc6 ==============================
[0m18:25:37.689404 [info ] [MainThread]: Running with dbt=1.5.3
[0m18:25:37.690401 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:25:37.792169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65637b5e-5643-4f32-a816-938d2ce17bc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011F2A87CE50>]}
[0m18:25:37.810080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65637b5e-5643-4f32-a816-938d2ce17bc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011F2A87CC10>]}
[0m18:25:37.812075 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m18:25:37.825042 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m18:25:37.976636 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:25:37.977633 [debug] [MainThread]: Partial parsing: added file: flights_dbt://models\Facts\Fact_boarding_passes.sql
[0m18:25:38.001585 [debug] [MainThread]: 1603: static parser failed on Facts\Fact_boarding_passes.sql
[0m18:25:38.021554 [debug] [MainThread]: 1602: parser fallback to jinja rendering on Facts\Fact_boarding_passes.sql
[0m18:25:38.031522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65637b5e-5643-4f32-a816-938d2ce17bc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011F2B058750>]}
[0m18:25:38.043460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65637b5e-5643-4f32-a816-938d2ce17bc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011F2B07F150>]}
[0m18:25:38.043460 [info ] [MainThread]: Found 6 models, 8 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:25:38.046450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65637b5e-5643-4f32-a816-938d2ce17bc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011F26DA3090>]}
[0m18:25:38.048443 [info ] [MainThread]: 
[0m18:25:38.051435 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:25:38.053430 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m18:25:38.067394 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m18:25:38.068395 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m18:25:38.069389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:38.162139 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m18:25:38.164134 [debug] [ThreadPool]: On list_flights_demo: Close
[0m18:25:38.168123 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo_flights_wh'
[0m18:25:38.176101 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:25:38.177098 [debug] [ThreadPool]: On list_flights_demo_flights_wh: BEGIN
[0m18:25:38.177098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:25:38.258882 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:25:38.259878 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:25:38.259878 [debug] [ThreadPool]: On list_flights_demo_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo_flights_wh"} */
select
      'flights_demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:25:38.271847 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:25:38.273841 [debug] [ThreadPool]: On list_flights_demo_flights_wh: ROLLBACK
[0m18:25:38.274838 [debug] [ThreadPool]: On list_flights_demo_flights_wh: Close
[0m18:25:38.280821 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:38.281819 [debug] [MainThread]: On master: BEGIN
[0m18:25:38.282816 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:25:38.331687 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:25:38.332683 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:38.332683 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:25:38.356646 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:25:38.359611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65637b5e-5643-4f32-a816-938d2ce17bc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011F29F2A450>]}
[0m18:25:38.359611 [debug] [MainThread]: On master: ROLLBACK
[0m18:25:38.360644 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:38.361606 [debug] [MainThread]: On master: BEGIN
[0m18:25:38.361606 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:25:38.362638 [debug] [MainThread]: On master: COMMIT
[0m18:25:38.362638 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:38.363600 [debug] [MainThread]: On master: COMMIT
[0m18:25:38.363600 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:25:38.363600 [debug] [MainThread]: On master: Close
[0m18:25:38.365595 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:25:38.366592 [info ] [MainThread]: 
[0m18:25:38.376567 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_Airport
[0m18:25:38.376567 [info ] [Thread-1 (]: 1 of 6 START sql incremental model flights_wh.Dim_Airport ...................... [RUN]
[0m18:25:38.378563 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flights_dbt.Dim_Airport'
[0m18:25:38.379560 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_Airport
[0m18:25:38.382549 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_Airport"
[0m18:25:38.384546 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (compile): 18:25:38.379560 => 18:25:38.383547
[0m18:25:38.386540 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_Airport
[0m18:25:38.496268 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:25:38.497265 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

    
  
    

  create temporary table "Dim_Airport__dbt_tmp182538452877"
  
  
    as
  
  (
    

select *,
    jsonb_extract_path(airport_name, 'en' )as airport_name_eng, 
    jsonb_extract_path(city, 'en' )as city_eng,
    jsonb_extract_path(airport_name, 'ru' )as airport_name_rus,
    jsonb_extract_path(city, 'en' )as city_rus,

'2023-08-16 15:25:37'::timestamp as dbt_time

from stg.airports_data
  );
  
  
[0m18:25:38.498266 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:25:38.581042 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:25:38.589021 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:25:38.590053 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: BEGIN
[0m18:25:38.591065 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:38.592014 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:25:38.592014 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport__dbt_tmp182538452877'
        
      order by ordinal_position

  
[0m18:25:38.619966 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:25:38.624953 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:25:38.624953 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:25:38.632904 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:25:38.644906 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:25:38.645876 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:25:38.650868 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:25:38.678783 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_Airport"
[0m18:25:38.680778 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:25:38.681774 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      
        
            delete from "flights_demo"."flights_wh"."Dim_Airport"
            where (
                airport_code) in (
                select (airport_code)
                from "Dim_Airport__dbt_tmp182538452877"
            );

        
    

    insert into "flights_demo"."flights_wh"."Dim_Airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time"
        from "Dim_Airport__dbt_tmp182538452877"
    )
  
[0m18:25:38.689757 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m18:25:38.712711 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:25:38.712711 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:25:38.713710 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:25:38.716697 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:25:38.718683 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (execute): 18:25:38.387539 => 18:25:38.718683
[0m18:25:38.719695 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: Close
[0m18:25:38.720676 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65637b5e-5643-4f32-a816-938d2ce17bc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011F2B1B3390>]}
[0m18:25:38.722672 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model flights_wh.Dim_Airport ................. [[32mINSERT 0 104[0m in 0.34s]
[0m18:25:38.726660 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_Airport
[0m18:25:38.728656 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_aircraft
[0m18:25:38.730650 [info ] [Thread-1 (]: 2 of 6 START sql incremental model flights_wh.Dim_aircraft ..................... [RUN]
[0m18:25:38.734638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_Airport, now model.flights_dbt.Dim_aircraft)
[0m18:25:38.736634 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_aircraft
[0m18:25:38.748601 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_aircraft"
[0m18:25:38.750598 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (compile): 18:25:38.738631 => 18:25:38.750598
[0m18:25:38.751593 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_aircraft
[0m18:25:38.761573 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:25:38.763565 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

    
  
    

  create temporary table "Dim_aircraft__dbt_tmp182538755584"
  
  
    as
  
  (
    

select 
    row_number() over() as dim_aircraft_id,

    ad.aircraft_code,
    ad.model,
    ad.range,
    ad.last_update,

    s. seat_no,
    s.fare_conditions,

    case when range >= 5600 then 'High'
        when range < 5600 then 'Low'
        else 'Null'
        end as range_L_H,
    jsonb_extract_path(model, 'en' )as Model_English,
    jsonb_extract_path(model, 'ru' )as Model_Russian,

'2023-08-16 15:25:37'::timestamp as dbt_time

from flights_demo.stg.aircrafts_data ad 
join flights_demo.stg.seats s 
	on s.aircraft_code = ad.aircraft_code
  );
  
  
[0m18:25:38.765560 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:38.994940 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m18:25:38.999928 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:25:38.999928 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: BEGIN
[0m18:25:39.001921 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:39.001921 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:25:39.002937 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft__dbt_tmp182538755584'
        
      order by ordinal_position

  
[0m18:25:39.030844 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:25:39.034834 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:25:39.035867 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:25:39.039822 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:25:39.044823 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:25:39.045806 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:25:39.053787 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:25:39.063791 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_aircraft"
[0m18:25:39.064788 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:25:39.065751 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      insert into "flights_demo"."flights_wh"."Dim_aircraft" ("dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time")
    (
        select "dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time"
        from "Dim_aircraft__dbt_tmp182538755584"
    )


  
[0m18:25:39.071806 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m18:25:39.074762 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:25:39.074762 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:25:39.075760 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:25:39.078717 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:25:39.080711 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (execute): 18:25:38.751593 => 18:25:39.080711
[0m18:25:39.081737 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: Close
[0m18:25:39.082706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65637b5e-5643-4f32-a816-938d2ce17bc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011F2B1F0D50>]}
[0m18:25:39.083703 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model flights_wh.Dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.35s]
[0m18:25:39.086696 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_aircraft
[0m18:25:39.086696 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_boarding_passes
[0m18:25:39.087719 [info ] [Thread-1 (]: 3 of 6 START sql view model flights_wh.Fact_boarding_passes .................... [RUN]
[0m18:25:39.089687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_aircraft, now model.flights_dbt.Fact_boarding_passes)
[0m18:25:39.090686 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_boarding_passes
[0m18:25:39.093705 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_boarding_passes"
[0m18:25:39.097672 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_boarding_passes (compile): 18:25:39.090686 => 18:25:39.095699
[0m18:25:39.099702 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_boarding_passes
[0m18:25:39.138557 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_boarding_passes"
[0m18:25:39.140570 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:25:39.141549 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: BEGIN
[0m18:25:39.142546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:39.208370 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:39.209367 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:25:39.210376 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

  create view "flights_demo"."flights_wh"."Fact_boarding_passes__dbt_tmp"
    
    
  as (
    select *,

'2023-08-16 15:25:37'::timestamp as dbt_time

from flights_demo.stg.ticket_flights tf 
join flights_demo.stg.boarding_passes bp 
	on tf.ticket_no = bp.ticket_no 
	and tf.flight_id =bp.flight_id
  );
[0m18:25:39.213356 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "ticket_no" specified more than once

[0m18:25:39.214353 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: ROLLBACK
[0m18:25:39.215351 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_boarding_passes (execute): 18:25:39.101657 => 18:25:39.215351
[0m18:25:39.216348 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: Close
[0m18:25:39.228316 [debug] [Thread-1 (]: Database Error in model Fact_boarding_passes (models\Facts\Fact_boarding_passes.sql)
  column "ticket_no" specified more than once
  compiled Code at target\run\flights_dbt\models\Facts\Fact_boarding_passes.sql
[0m18:25:39.230314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65637b5e-5643-4f32-a816-938d2ce17bc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011F2B26E910>]}
[0m18:25:39.231309 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model flights_wh.Fact_boarding_passes ........... [[31mERROR[0m in 0.14s]
[0m18:25:39.233305 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_boarding_passes
[0m18:25:39.234300 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_flights
[0m18:25:39.235340 [info ] [Thread-1 (]: 4 of 6 START sql incremental model flights_wh.Fact_flights ..................... [RUN]
[0m18:25:39.237303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_boarding_passes, now model.flights_dbt.Fact_flights)
[0m18:25:39.238290 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_flights
[0m18:25:39.244274 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_flights"
[0m18:25:39.249263 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (compile): 18:25:39.239288 => 18:25:39.248269
[0m18:25:39.250260 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_flights
[0m18:25:39.266218 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:25:39.268212 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

    
  
    

  create temporary table "Fact_flights__dbt_tmp182539256243"
  
  
    as
  
  (
    

with dim_flight_mod as (	
			select *,
			extract(day from (scheduled_arrival - scheduled_departure)*24) + extract(hour from (scheduled_arrival - scheduled_departure)) as flight_duration_expected,
			extract(day from (actual_arrival - actual_departure)*24) + extract(hour from (actual_arrival - actual_departure)) as duration_actual_hours
			from flights_demo.stg.flights f 
			)
select *,
    case 	when duration_actual_hours > flight_duration_expected 
                then 'Longer'
            when duration_actual_hours < flight_duration_expected 
                then 'Shorter'
            when duration_actual_hours = flight_duration_expected 
                then 'As Expected'
            else null
            end as flight_duration_case,

'2023-08-16 15:25:37'::timestamp as dbt_time

from dim_flight_mod
  );
  
  
[0m18:25:39.269208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:39.495637 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m18:25:39.499598 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:25:39.500624 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: BEGIN
[0m18:25:39.501586 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:39.502620 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:25:39.503581 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights__dbt_tmp182539256243'
        
      order by ordinal_position

  
[0m18:25:39.523553 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:25:39.527545 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:25:39.528514 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:25:39.532531 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:25:39.537523 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:25:39.538487 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:25:39.543476 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:25:39.546502 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_flights"
[0m18:25:39.548461 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:25:39.548461 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      
        
            delete from "flights_demo"."flights_wh"."Fact_flights"
            where (
                flight_id) in (
                select (flight_id)
                from "Fact_flights__dbt_tmp182539256243"
            );

        
    

    insert into "flights_demo"."flights_wh"."Fact_flights" ("flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time")
    (
        select "flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time"
        from "Fact_flights__dbt_tmp182539256243"
    )
  
[0m18:25:39.727981 [debug] [Thread-1 (]: SQL status: INSERT 0 33121 in 0.0 seconds
[0m18:25:39.730973 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:25:39.731971 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:25:39.731971 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:25:39.755905 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:25:39.758899 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (execute): 18:25:39.252253 => 18:25:39.757902
[0m18:25:39.759897 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: Close
[0m18:25:39.762888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65637b5e-5643-4f32-a816-938d2ce17bc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011F2A63BED0>]}
[0m18:25:39.763911 [info ] [Thread-1 (]: 4 of 6 OK created sql incremental model flights_wh.Fact_flights ................ [[32mINSERT 0 33121[0m in 0.53s]
[0m18:25:39.765881 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_flights
[0m18:25:39.766877 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m18:25:39.767951 [info ] [Thread-1 (]: 5 of 6 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m18:25:39.770867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_flights, now model.flights_dbt.my_first_dbt_model)
[0m18:25:39.771863 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m18:25:39.781873 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m18:25:39.785828 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 18:25:39.772862 => 18:25:39.785828
[0m18:25:39.786826 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m18:25:39.807801 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m18:25:39.810761 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:25:39.812755 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m18:25:39.814789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:39.882610 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:39.883565 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:25:39.884562 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:25:39.890546 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m18:25:39.898525 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:25:39.899523 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:25:39.902555 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:25:39.906503 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:25:39.907500 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:25:39.909495 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:25:39.922496 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:25:39.923494 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:25:39.923494 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:25:39.925496 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:25:39.932472 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:25:39.932472 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_demo"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:25:39.937421 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:25:39.939417 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 18:25:39.786826 => 18:25:39.939417
[0m18:25:39.940451 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m18:25:39.942408 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65637b5e-5643-4f32-a816-938d2ce17bc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011F2B6950D0>]}
[0m18:25:39.943404 [info ] [Thread-1 (]: 5 of 6 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.17s]
[0m18:25:39.947400 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m18:25:39.949391 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m18:25:39.950389 [info ] [Thread-1 (]: 6 of 6 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:25:39.952383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m18:25:39.953379 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m18:25:39.958365 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m18:25:39.962354 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 18:25:39.954377 => 18:25:39.962354
[0m18:25:39.964350 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m18:25:39.971333 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m18:25:39.973327 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:25:39.974324 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m18:25:39.974324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:25:40.042143 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:25:40.043141 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:25:40.044150 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_demo"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:25:40.054114 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:25:40.059099 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:25:40.060094 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:25:40.061093 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:25:40.064125 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:25:40.065114 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:25:40.066076 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:25:40.069073 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:25:40.075059 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:25:40.077065 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:25:40.079047 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:25:40.082038 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 18:25:39.965349 => 18:25:40.082038
[0m18:25:40.083034 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m18:25:40.085026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65637b5e-5643-4f32-a816-938d2ce17bc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011F2B0F2E90>]}
[0m18:25:40.087021 [info ] [Thread-1 (]: 6 of 6 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.13s]
[0m18:25:40.095996 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m18:25:40.097992 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:40.099986 [debug] [MainThread]: On master: BEGIN
[0m18:25:40.101981 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:25:40.171825 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:25:40.172791 [debug] [MainThread]: On master: COMMIT
[0m18:25:40.172791 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:40.172791 [debug] [MainThread]: On master: COMMIT
[0m18:25:40.173789 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:25:40.174786 [debug] [MainThread]: On master: Close
[0m18:25:40.175783 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:25:40.175783 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m18:25:40.177807 [debug] [MainThread]: Connection 'list_flights_demo_flights_wh' was properly closed.
[0m18:25:40.177807 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m18:25:40.179773 [info ] [MainThread]: 
[0m18:25:40.180770 [info ] [MainThread]: Finished running 3 incremental models, 2 view models, 1 table model in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m18:25:40.182791 [debug] [MainThread]: Command end result
[0m18:25:40.189748 [info ] [MainThread]: 
[0m18:25:40.190743 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:25:40.192738 [info ] [MainThread]: 
[0m18:25:40.194733 [error] [MainThread]: [33mDatabase Error in model Fact_boarding_passes (models\Facts\Fact_boarding_passes.sql)[0m
[0m18:25:40.198722 [error] [MainThread]:   column "ticket_no" specified more than once
[0m18:25:40.201717 [error] [MainThread]:   compiled Code at target\run\flights_dbt\models\Facts\Fact_boarding_passes.sql
[0m18:25:40.203710 [info ] [MainThread]: 
[0m18:25:40.205709 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m18:25:40.210712 [debug] [MainThread]: Command `dbt run` failed at 18:25:40.209718 after 2.58 seconds
[0m18:25:40.212694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011F2447ECD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011F2B02B350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011F24714190>]}
[0m18:25:40.213685 [debug] [MainThread]: Flushing usage events
[0m18:28:06.784654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143E38BD090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143E35B5650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143E3442D10>]}


============================== 18:28:06.791634 | b5693939-042c-489b-8828-c4d86b5ffb41 ==============================
[0m18:28:06.791634 [info ] [MainThread]: Running with dbt=1.5.3
[0m18:28:06.793629 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:28:06.926309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5693939-042c-489b-8828-c4d86b5ffb41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143E38BF710>]}
[0m18:28:06.949247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5693939-042c-489b-8828-c4d86b5ffb41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143E38D4C10>]}
[0m18:28:06.951242 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m18:28:06.970190 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m18:28:07.149887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:28:07.151881 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models\Facts\Fact_boarding_passes.sql
[0m18:28:07.186786 [debug] [MainThread]: 1603: static parser failed on Facts\Fact_boarding_passes.sql
[0m18:28:07.207764 [debug] [MainThread]: 1602: parser fallback to jinja rendering on Facts\Fact_boarding_passes.sql
[0m18:28:07.221727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5693939-042c-489b-8828-c4d86b5ffb41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143E40461D0>]}
[0m18:28:07.232665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5693939-042c-489b-8828-c4d86b5ffb41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143E40F79D0>]}
[0m18:28:07.233662 [info ] [MainThread]: Found 6 models, 8 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:28:07.236660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5693939-042c-489b-8828-c4d86b5ffb41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143DFD33090>]}
[0m18:28:07.239646 [info ] [MainThread]: 
[0m18:28:07.242653 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:28:07.246628 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m18:28:07.299486 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m18:28:07.301484 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m18:28:07.303481 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:07.413695 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m18:28:07.416686 [debug] [ThreadPool]: On list_flights_demo: Close
[0m18:28:07.419681 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo_flights_wh'
[0m18:28:07.430650 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:28:07.431648 [debug] [ThreadPool]: On list_flights_demo_flights_wh: BEGIN
[0m18:28:07.432644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:07.499465 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:28:07.500464 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:28:07.501461 [debug] [ThreadPool]: On list_flights_demo_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo_flights_wh"} */
select
      'flights_demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:28:07.517421 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:28:07.521406 [debug] [ThreadPool]: On list_flights_demo_flights_wh: ROLLBACK
[0m18:28:07.522405 [debug] [ThreadPool]: On list_flights_demo_flights_wh: Close
[0m18:28:07.530383 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:07.531380 [debug] [MainThread]: On master: BEGIN
[0m18:28:07.532378 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:28:07.695939 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:28:07.696937 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:07.697935 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:28:07.743811 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:28:07.746805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5693939-042c-489b-8828-c4d86b5ffb41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143E4106C90>]}
[0m18:28:07.747801 [debug] [MainThread]: On master: ROLLBACK
[0m18:28:07.748800 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:07.749799 [debug] [MainThread]: On master: BEGIN
[0m18:28:07.750793 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:28:07.751817 [debug] [MainThread]: On master: COMMIT
[0m18:28:07.751817 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:07.752789 [debug] [MainThread]: On master: COMMIT
[0m18:28:07.753785 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:28:07.754787 [debug] [MainThread]: On master: Close
[0m18:28:07.756779 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:28:07.758773 [info ] [MainThread]: 
[0m18:28:07.774735 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_Airport
[0m18:28:07.776726 [info ] [Thread-1 (]: 1 of 6 START sql incremental model flights_wh.Dim_Airport ...................... [RUN]
[0m18:28:07.780718 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flights_dbt.Dim_Airport'
[0m18:28:07.782742 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_Airport
[0m18:28:07.791685 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_Airport"
[0m18:28:07.793680 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (compile): 18:28:07.783706 => 18:28:07.792683
[0m18:28:07.794676 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_Airport
[0m18:28:07.921338 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:28:07.922334 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

    
  
    

  create temporary table "Dim_Airport__dbt_tmp182807872470"
  
  
    as
  
  (
    

select *,
    jsonb_extract_path(airport_name, 'en' )as airport_name_eng, 
    jsonb_extract_path(city, 'en' )as city_eng,
    jsonb_extract_path(airport_name, 'ru' )as airport_name_rus,
    jsonb_extract_path(city, 'en' )as city_rus,

'2023-08-16 15:28:06'::timestamp as dbt_time

from stg.airports_data
  );
  
  
[0m18:28:07.923358 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:28:08.002122 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:28:08.012094 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:28:08.013126 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: BEGIN
[0m18:28:08.014089 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:28:08.015123 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:28:08.016084 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport__dbt_tmp182807872470'
        
      order by ordinal_position

  
[0m18:28:08.047029 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:28:08.055976 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:28:08.056975 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:28:08.061962 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:28:08.081908 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:28:08.082907 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:28:08.088890 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:28:08.124793 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_Airport"
[0m18:28:08.126788 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:28:08.127785 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      
        
            delete from "flights_demo"."flights_wh"."Dim_Airport"
            where (
                airport_code) in (
                select (airport_code)
                from "Dim_Airport__dbt_tmp182807872470"
            );

        
    

    insert into "flights_demo"."flights_wh"."Dim_Airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time"
        from "Dim_Airport__dbt_tmp182807872470"
    )
  
[0m18:28:08.134803 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m18:28:08.159701 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:28:08.160697 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:28:08.160697 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:28:08.162692 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:28:08.164687 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (execute): 18:28:07.795678 => 18:28:08.164687
[0m18:28:08.165717 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: Close
[0m18:28:08.167684 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5693939-042c-489b-8828-c4d86b5ffb41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143E4180510>]}
[0m18:28:08.169675 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model flights_wh.Dim_Airport ................. [[32mINSERT 0 104[0m in 0.39s]
[0m18:28:08.173664 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_Airport
[0m18:28:08.175658 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_aircraft
[0m18:28:08.176655 [info ] [Thread-1 (]: 2 of 6 START sql incremental model flights_wh.Dim_aircraft ..................... [RUN]
[0m18:28:08.179649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_Airport, now model.flights_dbt.Dim_aircraft)
[0m18:28:08.181644 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_aircraft
[0m18:28:08.191616 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_aircraft"
[0m18:28:08.194609 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (compile): 18:28:08.181644 => 18:28:08.192614
[0m18:28:08.195605 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_aircraft
[0m18:28:08.206578 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:28:08.209571 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

    
  
    

  create temporary table "Dim_aircraft__dbt_tmp182808199594"
  
  
    as
  
  (
    

select 
    row_number() over() as dim_aircraft_id,

    ad.aircraft_code,
    ad.model,
    ad.range,
    ad.last_update,

    s. seat_no,
    s.fare_conditions,

    case when range >= 5600 then 'High'
        when range < 5600 then 'Low'
        else 'Null'
        end as range_L_H,
    jsonb_extract_path(model, 'en' )as Model_English,
    jsonb_extract_path(model, 'ru' )as Model_Russian,

'2023-08-16 15:28:06'::timestamp as dbt_time

from flights_demo.stg.aircrafts_data ad 
join flights_demo.stg.seats s 
	on s.aircraft_code = ad.aircraft_code
  );
  
  
[0m18:28:08.212579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:08.300339 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m18:28:08.306309 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:28:08.307306 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: BEGIN
[0m18:28:08.308303 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:28:08.309301 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:28:08.310298 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft__dbt_tmp182808199594'
        
      order by ordinal_position

  
[0m18:28:08.335915 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:28:08.340901 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:28:08.341898 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:28:08.346886 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:28:08.351872 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:28:08.352869 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:28:08.358853 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:28:08.371854 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_aircraft"
[0m18:28:08.372818 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:28:08.373817 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      insert into "flights_demo"."flights_wh"."Dim_aircraft" ("dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time")
    (
        select "dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time"
        from "Dim_aircraft__dbt_tmp182808199594"
    )


  
[0m18:28:08.378826 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m18:28:08.381818 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:28:08.381818 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:28:08.382790 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:28:08.385812 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:28:08.387776 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (execute): 18:28:08.196601 => 18:28:08.386780
[0m18:28:08.388777 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: Close
[0m18:28:08.389801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5693939-042c-489b-8828-c4d86b5ffb41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143E41C6790>]}
[0m18:28:08.390792 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model flights_wh.Dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.21s]
[0m18:28:08.392764 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_aircraft
[0m18:28:08.393762 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_boarding_passes
[0m18:28:08.394758 [info ] [Thread-1 (]: 3 of 6 START sql view model flights_wh.Fact_boarding_passes .................... [RUN]
[0m18:28:08.396754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_aircraft, now model.flights_dbt.Fact_boarding_passes)
[0m18:28:08.397776 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_boarding_passes
[0m18:28:08.401768 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_boarding_passes"
[0m18:28:08.402771 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_boarding_passes (compile): 18:28:08.397776 => 18:28:08.402771
[0m18:28:08.403735 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_boarding_passes
[0m18:28:08.439469 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_boarding_passes"
[0m18:28:08.442435 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:28:08.443431 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: BEGIN
[0m18:28:08.443431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:08.622951 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:28:08.623949 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:28:08.624946 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

  create view "flights_demo"."flights_wh"."Fact_boarding_passes__dbt_tmp"
    
    
  as (
    select 
    bp.ticket_no,
    bp.flight_id,
    bp.boarding_passes,
    bp.seat_no,
    bp.last_update,

    tf.fare_conditions,
    tf.amount,

'2023-08-16 15:28:06'::timestamp as dbt_time

from flights_demo.stg.ticket_flights tf 
join flights_demo.stg.boarding_passes bp 
	on tf.ticket_no = bp.ticket_no 
	and tf.flight_id =bp.flight_id
  );
[0m18:28:08.628936 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column bp.boarding_passes does not exist
LINE 10:     bp.boarding_passes,
             ^

[0m18:28:08.629932 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: ROLLBACK
[0m18:28:08.630930 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_boarding_passes (execute): 18:28:08.404731 => 18:28:08.630930
[0m18:28:08.631927 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: Close
[0m18:28:08.647885 [debug] [Thread-1 (]: Database Error in model Fact_boarding_passes (models\Facts\Fact_boarding_passes.sql)
  column bp.boarding_passes does not exist
  LINE 10:     bp.boarding_passes,
               ^
  compiled Code at target\run\flights_dbt\models\Facts\Fact_boarding_passes.sql
[0m18:28:08.648903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5693939-042c-489b-8828-c4d86b5ffb41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143E4188590>]}
[0m18:28:08.650878 [error] [Thread-1 (]: 3 of 6 ERROR creating sql view model flights_wh.Fact_boarding_passes ........... [[31mERROR[0m in 0.25s]
[0m18:28:08.651874 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_boarding_passes
[0m18:28:08.652890 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_flights
[0m18:28:08.653869 [info ] [Thread-1 (]: 4 of 6 START sql incremental model flights_wh.Fact_flights ..................... [RUN]
[0m18:28:08.655863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_boarding_passes, now model.flights_dbt.Fact_flights)
[0m18:28:08.656861 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_flights
[0m18:28:08.661847 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_flights"
[0m18:28:08.662879 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (compile): 18:28:08.656861 => 18:28:08.662879
[0m18:28:08.663844 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_flights
[0m18:28:08.673846 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:28:08.675816 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

    
  
    

  create temporary table "Fact_flights__dbt_tmp182808667877"
  
  
    as
  
  (
    

with dim_flight_mod as (	
			select *,
			extract(day from (scheduled_arrival - scheduled_departure)*24) + extract(hour from (scheduled_arrival - scheduled_departure)) as flight_duration_expected,
			extract(day from (actual_arrival - actual_departure)*24) + extract(hour from (actual_arrival - actual_departure)) as duration_actual_hours
			from flights_demo.stg.flights f 
			)
select *,
    case 	when duration_actual_hours > flight_duration_expected 
                then 'Longer'
            when duration_actual_hours < flight_duration_expected 
                then 'Shorter'
            when duration_actual_hours = flight_duration_expected 
                then 'As Expected'
            else null
            end as flight_duration_case,

'2023-08-16 15:28:06'::timestamp as dbt_time

from dim_flight_mod
  );
  
  
[0m18:28:08.676809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:08.894033 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m18:28:08.898023 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:28:08.899020 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: BEGIN
[0m18:28:08.901014 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:28:08.902012 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:28:08.902012 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights__dbt_tmp182808667877'
        
      order by ordinal_position

  
[0m18:28:08.926946 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:28:08.931958 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:28:08.932929 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:28:08.937942 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:28:08.941931 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:28:08.942929 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:28:08.948890 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:28:08.952912 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_flights"
[0m18:28:08.954875 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:28:08.955869 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      
        
            delete from "flights_demo"."flights_wh"."Fact_flights"
            where (
                flight_id) in (
                select (flight_id)
                from "Fact_flights__dbt_tmp182808667877"
            );

        
    

    insert into "flights_demo"."flights_wh"."Fact_flights" ("flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time")
    (
        select "flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time"
        from "Fact_flights__dbt_tmp182808667877"
    )
  
[0m18:28:09.163316 [debug] [Thread-1 (]: SQL status: INSERT 0 33121 in 0.0 seconds
[0m18:28:09.165309 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:28:09.166309 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:28:09.167305 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:28:09.174287 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:28:09.177309 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (execute): 18:28:08.664874 => 18:28:09.176285
[0m18:28:09.178275 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: Close
[0m18:28:09.180273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5693939-042c-489b-8828-c4d86b5ffb41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143E41AF210>]}
[0m18:28:09.182266 [info ] [Thread-1 (]: 4 of 6 OK created sql incremental model flights_wh.Fact_flights ................ [[32mINSERT 0 33121[0m in 0.52s]
[0m18:28:09.186254 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_flights
[0m18:28:09.188249 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m18:28:09.190247 [info ] [Thread-1 (]: 5 of 6 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m18:28:09.193236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_flights, now model.flights_dbt.my_first_dbt_model)
[0m18:28:09.193236 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m18:28:09.201251 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m18:28:09.202210 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 18:28:09.194231 => 18:28:09.202210
[0m18:28:09.204210 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m18:28:09.230135 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m18:28:09.231132 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:28:09.232129 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m18:28:09.232129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:09.305932 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:28:09.306931 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:28:09.306931 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:28:09.312915 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m18:28:09.320892 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:28:09.321889 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:28:09.324881 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:28:09.328871 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:28:09.329869 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:28:09.330866 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:28:09.344829 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:28:09.345827 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:28:09.346824 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:28:09.348819 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:28:09.355799 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:28:09.356796 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_demo"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:28:09.362781 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:28:09.364776 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 18:28:09.205205 => 18:28:09.364776
[0m18:28:09.364776 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m18:28:09.366772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5693939-042c-489b-8828-c4d86b5ffb41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143E40F7910>]}
[0m18:28:09.367801 [info ] [Thread-1 (]: 5 of 6 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.17s]
[0m18:28:09.369765 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m18:28:09.371757 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m18:28:09.372754 [info ] [Thread-1 (]: 6 of 6 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:28:09.373750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m18:28:09.374750 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m18:28:09.382730 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m18:28:09.386734 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 18:28:09.375748 => 18:28:09.385758
[0m18:28:09.387716 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m18:28:09.400679 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m18:28:09.401676 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:28:09.402673 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m18:28:09.403673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:09.481463 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:28:09.482460 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:28:09.482460 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_demo"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:28:09.492434 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:28:09.497421 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:28:09.498418 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:28:09.499417 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:28:09.502406 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:28:09.503404 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:28:09.504402 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:28:09.506397 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:28:09.511383 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:28:09.512380 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:28:09.513381 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:28:09.516370 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 18:28:09.389719 => 18:28:09.515374
[0m18:28:09.517367 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m18:28:09.519363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5693939-042c-489b-8828-c4d86b5ffb41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143E45F2350>]}
[0m18:28:09.521357 [info ] [Thread-1 (]: 6 of 6 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.15s]
[0m18:28:09.523350 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m18:28:09.525346 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:09.526343 [debug] [MainThread]: On master: BEGIN
[0m18:28:09.526343 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:28:09.595159 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:28:09.596157 [debug] [MainThread]: On master: COMMIT
[0m18:28:09.597153 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:09.597153 [debug] [MainThread]: On master: COMMIT
[0m18:28:09.598152 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:28:09.599149 [debug] [MainThread]: On master: Close
[0m18:28:09.600146 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:28:09.601144 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m18:28:09.602143 [debug] [MainThread]: Connection 'list_flights_demo_flights_wh' was properly closed.
[0m18:28:09.602143 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m18:28:09.604138 [info ] [MainThread]: 
[0m18:28:09.606131 [info ] [MainThread]: Finished running 3 incremental models, 2 view models, 1 table model in 0 hours 0 minutes and 2.36 seconds (2.36s).
[0m18:28:09.609122 [debug] [MainThread]: Command end result
[0m18:28:09.619096 [info ] [MainThread]: 
[0m18:28:09.621091 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:28:09.622087 [info ] [MainThread]: 
[0m18:28:09.623084 [error] [MainThread]: [33mDatabase Error in model Fact_boarding_passes (models\Facts\Fact_boarding_passes.sql)[0m
[0m18:28:09.624083 [error] [MainThread]:   column bp.boarding_passes does not exist
[0m18:28:09.625079 [error] [MainThread]:   LINE 10:     bp.boarding_passes,
[0m18:28:09.626077 [error] [MainThread]:                ^
[0m18:28:09.628071 [error] [MainThread]:   compiled Code at target\run\flights_dbt\models\Facts\Fact_boarding_passes.sql
[0m18:28:09.629070 [info ] [MainThread]: 
[0m18:28:09.630066 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m18:28:09.632064 [debug] [MainThread]: Command `dbt run` failed at 18:28:09.632064 after 2.90 seconds
[0m18:28:09.633057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143E359D310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143E38BF810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000143E3504890>]}
[0m18:28:09.633057 [debug] [MainThread]: Flushing usage events
[0m18:29:05.350904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1915D42D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F191638D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F19129D250>]}


============================== 18:29:05.356888 | ac35a014-b3eb-4a86-a1d6-e7473430a05d ==============================
[0m18:29:05.356888 [info ] [MainThread]: Running with dbt=1.5.3
[0m18:29:05.357885 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:29:05.476370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac35a014-b3eb-4a86-a1d6-e7473430a05d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F191443110>]}
[0m18:29:05.492361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac35a014-b3eb-4a86-a1d6-e7473430a05d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F191443110>]}
[0m18:29:05.494317 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m18:29:05.507286 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m18:29:05.615817 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:29:05.615817 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models\Facts\Fact_boarding_passes.sql
[0m18:29:05.639726 [debug] [MainThread]: 1603: static parser failed on Facts\Fact_boarding_passes.sql
[0m18:29:05.655710 [debug] [MainThread]: 1602: parser fallback to jinja rendering on Facts\Fact_boarding_passes.sql
[0m18:29:05.666655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac35a014-b3eb-4a86-a1d6-e7473430a05d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F191DADFD0>]}
[0m18:29:05.680616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac35a014-b3eb-4a86-a1d6-e7473430a05d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F191E07F10>]}
[0m18:29:05.680616 [info ] [MainThread]: Found 6 models, 8 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:29:05.682613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac35a014-b3eb-4a86-a1d6-e7473430a05d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F18DA13090>]}
[0m18:29:05.684606 [info ] [MainThread]: 
[0m18:29:05.685604 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:29:05.687598 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m18:29:05.699628 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m18:29:05.700661 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m18:29:05.702624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:29:05.909072 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m18:29:05.912060 [debug] [ThreadPool]: On list_flights_demo: Close
[0m18:29:05.916052 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo_flights_wh'
[0m18:29:05.933002 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:29:05.934000 [debug] [ThreadPool]: On list_flights_demo_flights_wh: BEGIN
[0m18:29:05.934998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:29:05.987857 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:29:05.988855 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:29:05.988855 [debug] [ThreadPool]: On list_flights_demo_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo_flights_wh"} */
select
      'flights_demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:29:05.996834 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m18:29:05.998828 [debug] [ThreadPool]: On list_flights_demo_flights_wh: ROLLBACK
[0m18:29:05.999825 [debug] [ThreadPool]: On list_flights_demo_flights_wh: Close
[0m18:29:06.006806 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:06.007804 [debug] [MainThread]: On master: BEGIN
[0m18:29:06.008807 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:29:06.056673 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:29:06.057669 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:06.057669 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:29:06.088620 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:29:06.090582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac35a014-b3eb-4a86-a1d6-e7473430a05d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1919FFAD0>]}
[0m18:29:06.091621 [debug] [MainThread]: On master: ROLLBACK
[0m18:29:06.092576 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:06.092576 [debug] [MainThread]: On master: BEGIN
[0m18:29:06.093573 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:29:06.093573 [debug] [MainThread]: On master: COMMIT
[0m18:29:06.093573 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:06.094571 [debug] [MainThread]: On master: COMMIT
[0m18:29:06.094571 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:29:06.095568 [debug] [MainThread]: On master: Close
[0m18:29:06.096566 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:29:06.097565 [info ] [MainThread]: 
[0m18:29:06.108534 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_Airport
[0m18:29:06.109559 [info ] [Thread-1 (]: 1 of 6 START sql incremental model flights_wh.Dim_Airport ...................... [RUN]
[0m18:29:06.111527 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flights_dbt.Dim_Airport'
[0m18:29:06.111527 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_Airport
[0m18:29:06.115554 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_Airport"
[0m18:29:06.119522 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (compile): 18:29:06.112524 => 18:29:06.117517
[0m18:29:06.120503 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_Airport
[0m18:29:06.207270 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:29:06.209267 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

    
  
    

  create temporary table "Dim_Airport__dbt_tmp182906166383"
  
  
    as
  
  (
    

select *,
    jsonb_extract_path(airport_name, 'en' )as airport_name_eng, 
    jsonb_extract_path(city, 'en' )as city_eng,
    jsonb_extract_path(airport_name, 'ru' )as airport_name_rus,
    jsonb_extract_path(city, 'en' )as city_rus,

'2023-08-16 15:29:05'::timestamp as dbt_time

from stg.airports_data
  );
  
  
[0m18:29:06.210262 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:29:06.388785 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:29:06.395765 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:29:06.396763 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: BEGIN
[0m18:29:06.397761 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:29:06.398757 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:29:06.398757 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport__dbt_tmp182906166383'
        
      order by ordinal_position

  
[0m18:29:06.419727 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:29:06.424722 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:29:06.425686 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:29:06.428715 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:29:06.437655 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:29:06.438652 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:29:06.443674 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:29:06.462625 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_Airport"
[0m18:29:06.464583 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:29:06.464583 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      
        
            delete from "flights_demo"."flights_wh"."Dim_Airport"
            where (
                airport_code) in (
                select (airport_code)
                from "Dim_Airport__dbt_tmp182906166383"
            );

        
    

    insert into "flights_demo"."flights_wh"."Dim_Airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time"
        from "Dim_Airport__dbt_tmp182906166383"
    )
  
[0m18:29:06.474588 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m18:29:06.491548 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:29:06.492540 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:29:06.492540 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:29:06.494502 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:29:06.495500 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (execute): 18:29:06.121502 => 18:29:06.495500
[0m18:29:06.496525 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: Close
[0m18:29:06.498495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac35a014-b3eb-4a86-a1d6-e7473430a05d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F191D7B910>]}
[0m18:29:06.500488 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model flights_wh.Dim_Airport ................. [[32mINSERT 0 104[0m in 0.39s]
[0m18:29:06.503482 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_Airport
[0m18:29:06.503482 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_aircraft
[0m18:29:06.504504 [info ] [Thread-1 (]: 2 of 6 START sql incremental model flights_wh.Dim_aircraft ..................... [RUN]
[0m18:29:06.507502 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_Airport, now model.flights_dbt.Dim_aircraft)
[0m18:29:06.508466 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_aircraft
[0m18:29:06.514449 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_aircraft"
[0m18:29:06.516443 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (compile): 18:29:06.509494 => 18:29:06.515445
[0m18:29:06.517441 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_aircraft
[0m18:29:06.522463 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:29:06.523424 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

    
  
    

  create temporary table "Dim_aircraft__dbt_tmp182906520433"
  
  
    as
  
  (
    

select 
    row_number() over() as dim_aircraft_id,

    ad.aircraft_code,
    ad.model,
    ad.range,
    ad.last_update,

    s. seat_no,
    s.fare_conditions,

    case when range >= 5600 then 'High'
        when range < 5600 then 'Low'
        else 'Null'
        end as range_L_H,
    jsonb_extract_path(model, 'en' )as Model_English,
    jsonb_extract_path(model, 'ru' )as Model_Russian,

'2023-08-16 15:29:05'::timestamp as dbt_time

from flights_demo.stg.aircrafts_data ad 
join flights_demo.stg.seats s 
	on s.aircraft_code = ad.aircraft_code
  );
  
  
[0m18:29:06.525421 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:29:06.711919 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m18:29:06.714940 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:29:06.714940 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: BEGIN
[0m18:29:06.716908 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:29:06.716908 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:29:06.717903 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft__dbt_tmp182906520433'
        
      order by ordinal_position

  
[0m18:29:06.733896 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:29:06.737876 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:29:06.737876 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:29:06.741874 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:29:06.744866 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:29:06.745863 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:29:06.749858 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:29:06.757798 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_aircraft"
[0m18:29:06.759792 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:29:06.760790 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      insert into "flights_demo"."flights_wh"."Dim_aircraft" ("dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time")
    (
        select "dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time"
        from "Dim_aircraft__dbt_tmp182906520433"
    )


  
[0m18:29:06.766774 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m18:29:06.769770 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:29:06.770763 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:29:06.770763 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:29:06.773889 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:29:06.774753 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (execute): 18:29:06.517441 => 18:29:06.774753
[0m18:29:06.775784 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: Close
[0m18:29:06.776748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac35a014-b3eb-4a86-a1d6-e7473430a05d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F191D56D10>]}
[0m18:29:06.777744 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model flights_wh.Dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.27s]
[0m18:29:06.779742 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_aircraft
[0m18:29:06.780736 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_boarding_passes
[0m18:29:06.780736 [info ] [Thread-1 (]: 3 of 6 START sql view model flights_wh.Fact_boarding_passes .................... [RUN]
[0m18:29:06.782731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_aircraft, now model.flights_dbt.Fact_boarding_passes)
[0m18:29:06.782731 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_boarding_passes
[0m18:29:06.785723 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_boarding_passes"
[0m18:29:06.787719 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_boarding_passes (compile): 18:29:06.782731 => 18:29:06.786721
[0m18:29:06.788718 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_boarding_passes
[0m18:29:06.822310 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_boarding_passes"
[0m18:29:06.824307 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:29:06.825300 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: BEGIN
[0m18:29:06.825300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:29:06.891126 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:29:06.892137 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:29:06.893138 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

  create view "flights_demo"."flights_wh"."Fact_boarding_passes__dbt_tmp"
    
    
  as (
    select 
    bp.ticket_no,
    bp.flight_id,
    bp.boarding_no,
    bp.seat_no,
    bp.last_update,

    tf.fare_conditions,
    tf.amount,

'2023-08-16 15:29:05'::timestamp as dbt_time

from flights_demo.stg.ticket_flights tf 
join flights_demo.stg.boarding_passes bp 
	on tf.ticket_no = bp.ticket_no 
	and tf.flight_id =bp.flight_id
  );
[0m18:29:06.903091 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:29:06.911070 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:29:06.911070 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */
alter table "flights_demo"."flights_wh"."Fact_boarding_passes__dbt_tmp" rename to "Fact_boarding_passes"
[0m18:29:06.914064 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:29:06.917058 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: COMMIT
[0m18:29:06.918055 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:29:06.918055 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: COMMIT
[0m18:29:06.921046 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:29:06.930023 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:29:06.931020 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */
drop view if exists "flights_demo"."flights_wh"."Fact_boarding_passes__dbt_backup" cascade
[0m18:29:06.933011 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:29:06.935008 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_boarding_passes (execute): 18:29:06.789716 => 18:29:06.935008
[0m18:29:06.936005 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: Close
[0m18:29:06.937003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac35a014-b3eb-4a86-a1d6-e7473430a05d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1912CDED0>]}
[0m18:29:06.938998 [info ] [Thread-1 (]: 3 of 6 OK created sql view model flights_wh.Fact_boarding_passes ............... [[32mCREATE VIEW[0m in 0.16s]
[0m18:29:06.939993 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_boarding_passes
[0m18:29:06.940991 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_flights
[0m18:29:06.941990 [info ] [Thread-1 (]: 4 of 6 START sql incremental model flights_wh.Fact_flights ..................... [RUN]
[0m18:29:06.942986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_boarding_passes, now model.flights_dbt.Fact_flights)
[0m18:29:06.942986 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_flights
[0m18:29:06.946983 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_flights"
[0m18:29:06.949970 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (compile): 18:29:06.943983 => 18:29:06.948973
[0m18:29:06.951963 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_flights
[0m18:29:06.962933 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:29:06.962933 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

    
  
    

  create temporary table "Fact_flights__dbt_tmp182906956948"
  
  
    as
  
  (
    

with dim_flight_mod as (	
			select *,
			extract(day from (scheduled_arrival - scheduled_departure)*24) + extract(hour from (scheduled_arrival - scheduled_departure)) as flight_duration_expected,
			extract(day from (actual_arrival - actual_departure)*24) + extract(hour from (actual_arrival - actual_departure)) as duration_actual_hours
			from flights_demo.stg.flights f 
			)
select *,
    case 	when duration_actual_hours > flight_duration_expected 
                then 'Longer'
            when duration_actual_hours < flight_duration_expected 
                then 'Shorter'
            when duration_actual_hours = flight_duration_expected 
                then 'As Expected'
            else null
            end as flight_duration_case,

'2023-08-16 15:29:05'::timestamp as dbt_time

from dim_flight_mod
  );
  
  
[0m18:29:06.963929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:29:07.141576 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m18:29:07.144587 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:29:07.144587 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: BEGIN
[0m18:29:07.145558 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:29:07.146543 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:29:07.146543 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights__dbt_tmp182906956948'
        
      order by ordinal_position

  
[0m18:29:07.164522 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:29:07.169482 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:29:07.169482 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:29:07.173498 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:29:07.177480 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:29:07.177480 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:29:07.181477 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:29:07.185459 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_flights"
[0m18:29:07.187436 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:29:07.188434 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      
        
            delete from "flights_demo"."flights_wh"."Fact_flights"
            where (
                flight_id) in (
                select (flight_id)
                from "Fact_flights__dbt_tmp182906956948"
            );

        
    

    insert into "flights_demo"."flights_wh"."Fact_flights" ("flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time")
    (
        select "flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time"
        from "Fact_flights__dbt_tmp182906956948"
    )
  
[0m18:29:07.311257 [debug] [Thread-1 (]: SQL status: INSERT 0 33121 in 0.0 seconds
[0m18:29:07.314250 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:29:07.314250 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:29:07.315248 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:29:07.330208 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:29:07.332204 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (execute): 18:29:06.952961 => 18:29:07.332204
[0m18:29:07.333210 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: Close
[0m18:29:07.334199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac35a014-b3eb-4a86-a1d6-e7473430a05d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F191347750>]}
[0m18:29:07.335195 [info ] [Thread-1 (]: 4 of 6 OK created sql incremental model flights_wh.Fact_flights ................ [[32mINSERT 0 33121[0m in 0.39s]
[0m18:29:07.337191 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_flights
[0m18:29:07.337191 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m18:29:07.338186 [info ] [Thread-1 (]: 5 of 6 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m18:29:07.340181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_flights, now model.flights_dbt.my_first_dbt_model)
[0m18:29:07.341178 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m18:29:07.343203 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m18:29:07.345168 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 18:29:07.341178 => 18:29:07.344170
[0m18:29:07.347164 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m18:29:07.373128 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m18:29:07.374129 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:29:07.375087 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m18:29:07.375087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:29:07.570565 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:29:07.571562 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:29:07.571562 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:29:07.577546 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m18:29:07.581562 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:29:07.581562 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:29:07.582533 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:29:07.585559 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:29:07.586562 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:29:07.587519 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:29:07.595538 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:29:07.596513 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:29:07.596513 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:29:07.598490 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:29:07.601515 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:29:07.601515 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_demo"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:29:07.608498 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:29:07.612490 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 18:29:07.348163 => 18:29:07.611477
[0m18:29:07.613453 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m18:29:07.615449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac35a014-b3eb-4a86-a1d6-e7473430a05d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F191F29C50>]}
[0m18:29:07.616446 [info ] [Thread-1 (]: 5 of 6 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.28s]
[0m18:29:07.618437 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m18:29:07.619440 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m18:29:07.620471 [info ] [Thread-1 (]: 6 of 6 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:29:07.621429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m18:29:07.622465 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m18:29:07.625417 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m18:29:07.627414 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 18:29:07.622465 => 18:29:07.627414
[0m18:29:07.628410 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m18:29:07.637391 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m18:29:07.641378 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:29:07.642374 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m18:29:07.643373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:29:07.706202 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:29:07.707230 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:29:07.708227 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_demo"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:29:07.713183 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:29:07.720168 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:29:07.721181 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:29:07.723182 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:29:07.725181 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:29:07.726152 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:29:07.727148 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:29:07.730138 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:29:07.733161 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:29:07.734154 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:29:07.735150 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:29:07.737148 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 18:29:07.629408 => 18:29:07.737148
[0m18:29:07.737148 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m18:29:07.739116 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac35a014-b3eb-4a86-a1d6-e7473430a05d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F191CD6350>]}
[0m18:29:07.740137 [info ] [Thread-1 (]: 6 of 6 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.12s]
[0m18:29:07.742105 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m18:29:07.743102 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:07.744110 [debug] [MainThread]: On master: BEGIN
[0m18:29:07.744110 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:29:07.895739 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:29:07.895739 [debug] [MainThread]: On master: COMMIT
[0m18:29:07.896693 [debug] [MainThread]: Using postgres connection "master"
[0m18:29:07.896693 [debug] [MainThread]: On master: COMMIT
[0m18:29:07.897689 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:29:07.897689 [debug] [MainThread]: On master: Close
[0m18:29:07.899686 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:29:07.899686 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m18:29:07.900681 [debug] [MainThread]: Connection 'list_flights_demo_flights_wh' was properly closed.
[0m18:29:07.900681 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m18:29:07.901679 [info ] [MainThread]: 
[0m18:29:07.902676 [info ] [MainThread]: Finished running 3 incremental models, 2 view models, 1 table model in 0 hours 0 minutes and 2.22 seconds (2.22s).
[0m18:29:07.904671 [debug] [MainThread]: Command end result
[0m18:29:07.913695 [info ] [MainThread]: 
[0m18:29:07.914645 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:29:07.915642 [info ] [MainThread]: 
[0m18:29:07.917639 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:29:07.919634 [debug] [MainThread]: Command `dbt run` succeeded at 18:29:07.918635 after 2.62 seconds
[0m18:29:07.920631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F191553ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1912B5510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F19126F790>]}
[0m18:29:07.921627 [debug] [MainThread]: Flushing usage events
[0m18:31:21.777187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C4D15950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C7712650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C793C150>]}


============================== 18:31:21.784171 | 7812e242-e8b1-4705-8965-3affc80c0927 ==============================
[0m18:31:21.784171 [info ] [MainThread]: Running with dbt=1.5.3
[0m18:31:21.787160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:31:21.921839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7812e242-e8b1-4705-8965-3affc80c0927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C7AD5E10>]}
[0m18:31:21.944748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7812e242-e8b1-4705-8965-3affc80c0927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C7AD5E10>]}
[0m18:31:21.946742 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m18:31:21.965693 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m18:31:22.139029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:31:22.140024 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:31:22.150997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7812e242-e8b1-4705-8965-3affc80c0927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C743ED90>]}
[0m18:31:22.164955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7812e242-e8b1-4705-8965-3affc80c0927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C7D832D0>]}
[0m18:31:22.165954 [info ] [MainThread]: Found 6 models, 8 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:31:22.166998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7812e242-e8b1-4705-8965-3affc80c0927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C3AF3090>]}
[0m18:31:22.169993 [info ] [MainThread]: 
[0m18:31:22.170992 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:31:22.174981 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m18:31:22.202907 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m18:31:22.203902 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m18:31:22.204901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:22.330071 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m18:31:22.332064 [debug] [ThreadPool]: On list_flights_demo: Close
[0m18:31:22.336054 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo_flights_wh'
[0m18:31:22.347048 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:31:22.348026 [debug] [ThreadPool]: On list_flights_demo_flights_wh: BEGIN
[0m18:31:22.350020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:22.425245 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:31:22.426203 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:31:22.426203 [debug] [ThreadPool]: On list_flights_demo_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo_flights_wh"} */
select
      'flights_demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:31:22.439169 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:31:22.441168 [debug] [ThreadPool]: On list_flights_demo_flights_wh: ROLLBACK
[0m18:31:22.442161 [debug] [ThreadPool]: On list_flights_demo_flights_wh: Close
[0m18:31:22.452134 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:22.453131 [debug] [MainThread]: On master: BEGIN
[0m18:31:22.454128 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:31:22.515482 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:31:22.516479 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:22.517476 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:31:22.554377 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m18:31:22.556372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7812e242-e8b1-4705-8965-3affc80c0927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C7707CD0>]}
[0m18:31:22.558370 [debug] [MainThread]: On master: ROLLBACK
[0m18:31:22.559365 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:22.560363 [debug] [MainThread]: On master: BEGIN
[0m18:31:22.561360 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:31:22.562357 [debug] [MainThread]: On master: COMMIT
[0m18:31:22.563390 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:22.564386 [debug] [MainThread]: On master: COMMIT
[0m18:31:22.566347 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:31:22.567348 [debug] [MainThread]: On master: Close
[0m18:31:22.569340 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:31:22.573331 [info ] [MainThread]: 
[0m18:31:22.589285 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_Airport
[0m18:31:22.590283 [info ] [Thread-1 (]: 1 of 6 START sql incremental model flights_wh.Dim_Airport ...................... [RUN]
[0m18:31:22.593275 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flights_dbt.Dim_Airport'
[0m18:31:22.595272 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_Airport
[0m18:31:22.608238 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_Airport"
[0m18:31:22.614221 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (compile): 18:31:22.597269 => 18:31:22.613228
[0m18:31:22.616214 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_Airport
[0m18:31:22.759829 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:31:22.760825 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

    
  
    

  create temporary table "Dim_Airport__dbt_tmp183122696002"
  
  
    as
  
  (
    

select *,
    jsonb_extract_path(airport_name, 'en' )as airport_name_eng, 
    jsonb_extract_path(city, 'en' )as city_eng,
    jsonb_extract_path(airport_name, 'ru' )as airport_name_rus,
    jsonb_extract_path(city, 'en' )as city_rus,

'2023-08-16 15:31:21'::timestamp as dbt_time

from stg.airports_data
  );
  
  
[0m18:31:22.760825 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:31:22.851620 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:31:22.865583 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:31:22.866579 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: BEGIN
[0m18:31:22.868575 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:31:22.870569 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:31:22.871565 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport__dbt_tmp183122696002'
        
      order by ordinal_position

  
[0m18:31:22.900516 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:31:22.911493 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:31:22.912457 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:31:22.917476 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:31:22.929410 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:31:22.930409 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:31:22.936393 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:31:22.968319 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_Airport"
[0m18:31:22.973297 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:31:22.974295 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      
        
            delete from "flights_demo"."flights_wh"."Dim_Airport"
            where (
                airport_code) in (
                select (airport_code)
                from "Dim_Airport__dbt_tmp183122696002"
            );

        
    

    insert into "flights_demo"."flights_wh"."Dim_Airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time"
        from "Dim_Airport__dbt_tmp183122696002"
    )
  
[0m18:31:22.984266 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m18:31:23.010197 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:31:23.011194 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:31:23.011194 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:31:23.013187 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:31:23.015216 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (execute): 18:31:22.618215 => 18:31:23.014218
[0m18:31:23.015216 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: Close
[0m18:31:23.017226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7812e242-e8b1-4705-8965-3affc80c0927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C73AC390>]}
[0m18:31:23.018176 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model flights_wh.Dim_Airport ................. [[32mINSERT 0 104[0m in 0.42s]
[0m18:31:23.022162 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_Airport
[0m18:31:23.023160 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_aircraft
[0m18:31:23.024192 [info ] [Thread-1 (]: 2 of 6 START sql incremental model flights_wh.Dim_aircraft ..................... [RUN]
[0m18:31:23.025156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_Airport, now model.flights_dbt.Dim_aircraft)
[0m18:31:23.026155 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_aircraft
[0m18:31:23.033138 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_aircraft"
[0m18:31:23.036140 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (compile): 18:31:23.027201 => 18:31:23.035147
[0m18:31:23.038133 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_aircraft
[0m18:31:23.052117 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:31:23.053079 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

    
  
    

  create temporary table "Dim_aircraft__dbt_tmp183123047099"
  
  
    as
  
  (
    

select 
    row_number() over() as dim_aircraft_id,

    ad.aircraft_code,
    ad.model,
    ad.range,
    ad.last_update,

    s. seat_no,
    s.fare_conditions,

    case when range >= 5600 then 'High'
        when range < 5600 then 'Low'
        else 'Null'
        end as range_L_H,
    jsonb_extract_path(model, 'en' )as Model_English,
    jsonb_extract_path(model, 'ru' )as Model_Russian,

'2023-08-16 15:31:21'::timestamp as dbt_time

from flights_demo.stg.aircrafts_data ad 
join flights_demo.stg.seats s 
	on s.aircraft_code = ad.aircraft_code
  );
  
  
[0m18:31:23.053079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:23.143838 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m18:31:23.147826 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:31:23.148825 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: BEGIN
[0m18:31:23.150820 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:31:23.150820 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:31:23.151818 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft__dbt_tmp183123047099'
        
      order by ordinal_position

  
[0m18:31:23.176750 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:31:23.181737 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:31:23.182735 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:31:23.190714 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:31:23.195699 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:31:23.196701 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:31:23.204674 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:31:23.215644 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_aircraft"
[0m18:31:23.217641 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:31:23.218636 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      insert into "flights_demo"."flights_wh"."Dim_aircraft" ("dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time")
    (
        select "dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time"
        from "Dim_aircraft__dbt_tmp183123047099"
    )


  
[0m18:31:23.227614 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m18:31:23.231604 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:31:23.233598 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:31:23.234594 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:31:23.238585 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:31:23.240578 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (execute): 18:31:23.039135 => 18:31:23.240578
[0m18:31:23.241575 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: Close
[0m18:31:23.242575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7812e242-e8b1-4705-8965-3affc80c0927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C7ADECD0>]}
[0m18:31:23.244569 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model flights_wh.Dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.22s]
[0m18:31:23.247562 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_aircraft
[0m18:31:23.248557 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_boarding_passes
[0m18:31:23.250554 [info ] [Thread-1 (]: 3 of 6 START sql view model flights_wh.Fact_boarding_passes .................... [RUN]
[0m18:31:23.254544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_aircraft, now model.flights_dbt.Fact_boarding_passes)
[0m18:31:23.256538 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_boarding_passes
[0m18:31:23.264522 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_boarding_passes"
[0m18:31:23.271501 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_boarding_passes (compile): 18:31:23.257536 => 18:31:23.270500
[0m18:31:23.274494 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_boarding_passes
[0m18:31:23.345299 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_boarding_passes"
[0m18:31:23.348291 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:31:23.349289 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: BEGIN
[0m18:31:23.350285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:23.435059 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:31:23.436061 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:31:23.437055 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

  create view "flights_demo"."flights_wh"."Fact_boarding_passes__dbt_tmp"
    
    
  as (
    select 
    bp.ticket_no,
    bp.flight_id,
    bp.boarding_no,
    bp.seat_no,
    bp.last_update,

    tf.fare_conditions,
    tf.amount,

'2023-08-16 15:31:21'::timestamp as dbt_time

from flights_demo.stg.ticket_flights tf 
join flights_demo.stg.boarding_passes bp 
	on tf.ticket_no = bp.ticket_no 
	and tf.flight_id =bp.flight_id
  );
[0m18:31:23.450018 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:31:23.463982 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:31:23.464980 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */
alter table "flights_demo"."flights_wh"."Fact_boarding_passes" rename to "Fact_boarding_passes__dbt_backup"
[0m18:31:23.467971 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:23.477943 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:31:23.478942 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */
alter table "flights_demo"."flights_wh"."Fact_boarding_passes__dbt_tmp" rename to "Fact_boarding_passes"
[0m18:31:23.480949 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:23.486922 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: COMMIT
[0m18:31:23.487918 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:31:23.489922 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: COMMIT
[0m18:31:23.492912 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:31:23.501881 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:31:23.502877 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */
drop view if exists "flights_demo"."flights_wh"."Fact_boarding_passes__dbt_backup" cascade
[0m18:31:23.506867 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:31:23.509861 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_boarding_passes (execute): 18:31:23.276492 => 18:31:23.509861
[0m18:31:23.510858 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: Close
[0m18:31:23.511855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7812e242-e8b1-4705-8965-3affc80c0927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C7FDBDD0>]}
[0m18:31:23.512853 [info ] [Thread-1 (]: 3 of 6 OK created sql view model flights_wh.Fact_boarding_passes ............... [[32mCREATE VIEW[0m in 0.26s]
[0m18:31:23.514863 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_boarding_passes
[0m18:31:23.515848 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_flights
[0m18:31:23.516853 [info ] [Thread-1 (]: 4 of 6 START sql incremental model flights_wh.Fact_flights ..................... [RUN]
[0m18:31:23.519840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_boarding_passes, now model.flights_dbt.Fact_flights)
[0m18:31:23.520836 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_flights
[0m18:31:23.525827 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_flights"
[0m18:31:23.527817 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (compile): 18:31:23.520836 => 18:31:23.526825
[0m18:31:23.528821 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_flights
[0m18:31:23.540783 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:31:23.541780 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

    
  
    

  create temporary table "Fact_flights__dbt_tmp183123534802"
  
  
    as
  
  (
    

with dim_flight_mod as (	
			select *,
			extract(day from (scheduled_arrival - scheduled_departure)*24) + extract(hour from (scheduled_arrival - scheduled_departure)) as flight_duration_expected,
			extract(day from (actual_arrival - actual_departure)*24) + extract(hour from (actual_arrival - actual_departure)) as duration_actual_hours
			from flights_demo.stg.flights f 
			)
select *,
    case 	when duration_actual_hours > flight_duration_expected 
                then 'Longer'
            when duration_actual_hours < flight_duration_expected 
                then 'Shorter'
            when duration_actual_hours = flight_duration_expected 
                then 'As Expected'
            else null
            end as flight_duration_case,

'2023-08-16 15:31:21'::timestamp as dbt_time

from dim_flight_mod
  );
  
  
[0m18:31:23.542777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:23.814140 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m18:31:23.820126 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:31:23.821125 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: BEGIN
[0m18:31:23.823125 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:31:23.824114 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:31:23.826111 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights__dbt_tmp183123534802'
        
      order by ordinal_position

  
[0m18:31:23.853040 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:31:23.861017 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:31:23.861017 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:31:23.867003 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:31:23.873983 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:31:23.874982 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:31:23.881961 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:31:23.887950 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_flights"
[0m18:31:23.890941 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:31:23.892930 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      
        
            delete from "flights_demo"."flights_wh"."Fact_flights"
            where (
                flight_id) in (
                select (flight_id)
                from "Fact_flights__dbt_tmp183123534802"
            );

        
    

    insert into "flights_demo"."flights_wh"."Fact_flights" ("flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time")
    (
        select "flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time"
        from "Fact_flights__dbt_tmp183123534802"
    )
  
[0m18:31:24.149450 [debug] [Thread-1 (]: SQL status: INSERT 0 33121 in 0.0 seconds
[0m18:31:24.155439 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:31:24.158425 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:31:24.161415 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:31:24.176375 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:31:24.179373 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (execute): 18:31:23.529821 => 18:31:24.179373
[0m18:31:24.180369 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: Close
[0m18:31:24.182363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7812e242-e8b1-4705-8965-3affc80c0927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C7FACC90>]}
[0m18:31:24.183359 [info ] [Thread-1 (]: 4 of 6 OK created sql incremental model flights_wh.Fact_flights ................ [[32mINSERT 0 33121[0m in 0.66s]
[0m18:31:24.186351 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_flights
[0m18:31:24.189344 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m18:31:24.192334 [info ] [Thread-1 (]: 5 of 6 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m18:31:24.196321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_flights, now model.flights_dbt.my_first_dbt_model)
[0m18:31:24.197322 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m18:31:24.203305 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m18:31:24.206308 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 18:31:24.198316 => 18:31:24.204301
[0m18:31:24.207294 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m18:31:24.241723 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m18:31:24.246703 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:31:24.248696 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m18:31:24.249696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:24.432206 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:31:24.433204 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:31:24.434209 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:31:24.443183 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m18:31:24.449162 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:31:24.450159 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:31:24.451156 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:24.456140 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:31:24.457139 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:31:24.459136 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:24.468109 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:31:24.469109 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:31:24.471137 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:31:24.476231 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:31:24.482075 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:31:24.483071 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_demo"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:31:24.487058 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:31:24.490054 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 18:31:24.208292 => 18:31:24.490054
[0m18:31:24.492046 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m18:31:24.494041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7812e242-e8b1-4705-8965-3affc80c0927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C7E66990>]}
[0m18:31:24.495037 [info ] [Thread-1 (]: 5 of 6 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.30s]
[0m18:31:24.499027 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m18:31:24.501021 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m18:31:24.502053 [info ] [Thread-1 (]: 6 of 6 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:31:24.505010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m18:31:24.506009 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m18:31:24.522965 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m18:31:24.526965 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 18:31:24.507006 => 18:31:24.524969
[0m18:31:24.532937 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m18:31:24.541913 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m18:31:24.546915 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:31:24.548895 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m18:31:24.550905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:24.648629 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:31:24.649626 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:31:24.650623 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_demo"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:31:24.657603 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:31:24.663587 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:31:24.663587 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:31:24.665581 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:31:24.668573 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:31:24.670570 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:31:24.671564 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:31:24.674558 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:31:24.679544 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:31:24.680542 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:31:24.681541 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:31:24.685534 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 18:31:24.534940 => 18:31:24.684552
[0m18:31:24.686527 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m18:31:24.689517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7812e242-e8b1-4705-8965-3affc80c0927', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C8011B90>]}
[0m18:31:24.690517 [info ] [Thread-1 (]: 6 of 6 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.19s]
[0m18:31:24.692511 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m18:31:24.694505 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:24.695502 [debug] [MainThread]: On master: BEGIN
[0m18:31:24.696500 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:31:24.773295 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:31:24.773295 [debug] [MainThread]: On master: COMMIT
[0m18:31:24.774292 [debug] [MainThread]: Using postgres connection "master"
[0m18:31:24.775289 [debug] [MainThread]: On master: COMMIT
[0m18:31:24.776287 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:31:24.777282 [debug] [MainThread]: On master: Close
[0m18:31:24.779279 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:24.781272 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m18:31:24.782279 [debug] [MainThread]: Connection 'list_flights_demo_flights_wh' was properly closed.
[0m18:31:24.783274 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m18:31:24.785260 [info ] [MainThread]: 
[0m18:31:24.787259 [info ] [MainThread]: Finished running 3 incremental models, 2 view models, 1 table model in 0 hours 0 minutes and 2.61 seconds (2.61s).
[0m18:31:24.791243 [debug] [MainThread]: Command end result
[0m18:31:24.811197 [info ] [MainThread]: 
[0m18:31:24.814185 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:31:24.816178 [info ] [MainThread]: 
[0m18:31:24.818177 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:31:24.823172 [debug] [MainThread]: Command `dbt run` succeeded at 18:31:24.822185 after 3.11 seconds
[0m18:31:24.825154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C7304F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C114EBD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C114DFD0>]}
[0m18:31:24.827175 [debug] [MainThread]: Flushing usage events
[0m18:33:49.624998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBF37FC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBF787150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBFAFFF90>]}


============================== 18:33:49.630981 | f67db26b-d47e-4f36-8969-784e9ece42a9 ==============================
[0m18:33:49.630981 [info ] [MainThread]: Running with dbt=1.5.3
[0m18:33:49.631978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:33:49.758642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f67db26b-d47e-4f36-8969-784e9ece42a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBF3BAF50>]}
[0m18:33:49.781578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f67db26b-d47e-4f36-8969-784e9ece42a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBF8C3A10>]}
[0m18:33:49.783573 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m18:33:49.799531 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m18:33:49.923252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:33:49.924217 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models\Facts\schema.yml
[0m18:33:50.008027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f67db26b-d47e-4f36-8969-784e9ece42a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBF3CE290>]}
[0m18:33:50.019981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f67db26b-d47e-4f36-8969-784e9ece42a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBFE2ABD0>]}
[0m18:33:50.020958 [info ] [MainThread]: Found 6 models, 10 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:33:50.022954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f67db26b-d47e-4f36-8969-784e9ece42a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBBB23090>]}
[0m18:33:50.024949 [info ] [MainThread]: 
[0m18:33:50.026944 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:33:50.030933 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m18:33:50.054870 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m18:33:50.056870 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m18:33:50.058859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:33:50.156594 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m18:33:50.158589 [debug] [ThreadPool]: On list_flights_demo: Close
[0m18:33:50.161580 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo_flights_wh'
[0m18:33:50.170557 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:33:50.171554 [debug] [ThreadPool]: On list_flights_demo_flights_wh: BEGIN
[0m18:33:50.172551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:33:50.231398 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:33:50.232395 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:33:50.232395 [debug] [ThreadPool]: On list_flights_demo_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo_flights_wh"} */
select
      'flights_demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:33:50.244398 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:33:50.246356 [debug] [ThreadPool]: On list_flights_demo_flights_wh: ROLLBACK
[0m18:33:50.247354 [debug] [ThreadPool]: On list_flights_demo_flights_wh: Close
[0m18:33:50.255363 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:50.256328 [debug] [MainThread]: On master: BEGIN
[0m18:33:50.256328 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:33:50.441832 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:33:50.442854 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:50.443827 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:33:50.482722 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m18:33:50.485715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f67db26b-d47e-4f36-8969-784e9ece42a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBFE08790>]}
[0m18:33:50.486713 [debug] [MainThread]: On master: ROLLBACK
[0m18:33:50.487709 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:50.488706 [debug] [MainThread]: On master: BEGIN
[0m18:33:50.490703 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:33:50.490703 [debug] [MainThread]: On master: COMMIT
[0m18:33:50.491745 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:50.492696 [debug] [MainThread]: On master: COMMIT
[0m18:33:50.493693 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:33:50.493693 [debug] [MainThread]: On master: Close
[0m18:33:50.495499 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:33:50.496484 [info ] [MainThread]: 
[0m18:33:50.506465 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_Airport
[0m18:33:50.506465 [info ] [Thread-1 (]: 1 of 6 START sql incremental model flights_wh.Dim_Airport ...................... [RUN]
[0m18:33:50.508453 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flights_dbt.Dim_Airport'
[0m18:33:50.509450 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_Airport
[0m18:33:50.514436 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_Airport"
[0m18:33:50.515434 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (compile): 18:33:50.510448 => 18:33:50.515434
[0m18:33:50.517447 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_Airport
[0m18:33:50.619158 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:33:50.620155 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

    
  
    

  create temporary table "Dim_Airport__dbt_tmp183350566303"
  
  
    as
  
  (
    

select *,
    jsonb_extract_path(airport_name, 'en' )as airport_name_eng, 
    jsonb_extract_path(city, 'en' )as city_eng,
    jsonb_extract_path(airport_name, 'ru' )as airport_name_rus,
    jsonb_extract_path(city, 'en' )as city_rus,

'2023-08-16 15:33:49'::timestamp as dbt_time

from stg.airports_data
  );
  
  
[0m18:33:50.620155 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:33:50.704531 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:33:50.718492 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:33:50.719490 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: BEGIN
[0m18:33:50.720487 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:33:50.721484 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:33:50.722483 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport__dbt_tmp183350566303'
        
      order by ordinal_position

  
[0m18:33:50.752405 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:33:50.762387 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:33:50.763385 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:33:50.770358 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:33:50.780329 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:33:50.781327 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:33:50.786314 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:33:50.812254 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_Airport"
[0m18:33:50.814248 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:33:50.814248 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      
        
            delete from "flights_demo"."flights_wh"."Dim_Airport"
            where (
                airport_code) in (
                select (airport_code)
                from "Dim_Airport__dbt_tmp183350566303"
            );

        
    

    insert into "flights_demo"."flights_wh"."Dim_Airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time"
        from "Dim_Airport__dbt_tmp183350566303"
    )
  
[0m18:33:50.823228 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m18:33:50.845166 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:33:50.846162 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:33:50.847161 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:33:50.848158 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:33:50.851150 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (execute): 18:33:50.518429 => 18:33:50.850151
[0m18:33:50.853146 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: Close
[0m18:33:50.857136 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f67db26b-d47e-4f36-8969-784e9ece42a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBF37F190>]}
[0m18:33:50.860124 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model flights_wh.Dim_Airport ................. [[32mINSERT 0 104[0m in 0.35s]
[0m18:33:50.863116 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_Airport
[0m18:33:50.865147 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_aircraft
[0m18:33:50.867105 [info ] [Thread-1 (]: 2 of 6 START sql incremental model flights_wh.Dim_aircraft ..................... [RUN]
[0m18:33:50.871094 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_Airport, now model.flights_dbt.Dim_aircraft)
[0m18:33:50.871094 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_aircraft
[0m18:33:50.878075 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_aircraft"
[0m18:33:50.880070 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (compile): 18:33:50.872092 => 18:33:50.879073
[0m18:33:50.880070 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_aircraft
[0m18:33:50.894071 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:33:50.895066 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

    
  
    

  create temporary table "Dim_aircraft__dbt_tmp183350887067"
  
  
    as
  
  (
    

select 
    row_number() over() as dim_aircraft_id,

    ad.aircraft_code,
    ad.model,
    ad.range,
    ad.last_update,

    s. seat_no,
    s.fare_conditions,

    case when range >= 5600 then 'High'
        when range < 5600 then 'Low'
        else 'Null'
        end as range_L_H,
    jsonb_extract_path(model, 'en' )as Model_English,
    jsonb_extract_path(model, 'ru' )as Model_Russian,

'2023-08-16 15:33:49'::timestamp as dbt_time

from flights_demo.stg.aircrafts_data ad 
join flights_demo.stg.seats s 
	on s.aircraft_code = ad.aircraft_code
  );
  
  
[0m18:33:50.896587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:51.103025 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m18:33:51.106993 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:33:51.106993 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: BEGIN
[0m18:33:51.108984 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:33:51.109982 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:33:51.110983 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft__dbt_tmp183350887067'
        
      order by ordinal_position

  
[0m18:33:51.132920 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:33:51.136942 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:33:51.137938 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:33:51.142925 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:33:51.146924 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:33:51.147879 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:33:51.152904 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:33:51.165833 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_aircraft"
[0m18:33:51.169826 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:33:51.170819 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      insert into "flights_demo"."flights_wh"."Dim_aircraft" ("dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time")
    (
        select "dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time"
        from "Dim_aircraft__dbt_tmp183350887067"
    )


  
[0m18:33:51.177801 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m18:33:51.180824 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:33:51.180824 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:33:51.181826 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:33:51.184006 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:33:51.185778 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (execute): 18:33:50.881067 => 18:33:51.185778
[0m18:33:51.186778 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: Close
[0m18:33:51.187775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f67db26b-d47e-4f36-8969-784e9ece42a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBFF602D0>]}
[0m18:33:51.189769 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model flights_wh.Dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.32s]
[0m18:33:51.191762 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_aircraft
[0m18:33:51.192760 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_boarding_passes
[0m18:33:51.193765 [info ] [Thread-1 (]: 3 of 6 START sql view model flights_wh.Fact_boarding_passes .................... [RUN]
[0m18:33:51.195753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_aircraft, now model.flights_dbt.Fact_boarding_passes)
[0m18:33:51.196754 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_boarding_passes
[0m18:33:51.201738 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_boarding_passes"
[0m18:33:51.205728 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_boarding_passes (compile): 18:33:51.197748 => 18:33:51.204740
[0m18:33:51.206723 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_boarding_passes
[0m18:33:51.257587 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_boarding_passes"
[0m18:33:51.261598 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:33:51.262574 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: BEGIN
[0m18:33:51.263573 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:51.355327 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:33:51.356323 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:33:51.357322 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

  create view "flights_demo"."flights_wh"."Fact_boarding_passes__dbt_tmp"
    
    
  as (
    select 
    bp.ticket_no,
    bp.flight_id,
    bp.boarding_no,
    bp.seat_no,
    bp.last_update,

    tf.fare_conditions,
    tf.amount,

'2023-08-16 15:33:49'::timestamp as dbt_time

from flights_demo.stg.ticket_flights tf 
join flights_demo.stg.boarding_passes bp 
	on tf.ticket_no = bp.ticket_no 
	and tf.flight_id =bp.flight_id
  );
[0m18:33:51.365298 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:33:51.374274 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:33:51.374274 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */
alter table "flights_demo"."flights_wh"."Fact_boarding_passes" rename to "Fact_boarding_passes__dbt_backup"
[0m18:33:51.377267 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:33:51.383250 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:33:51.384248 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */
alter table "flights_demo"."flights_wh"."Fact_boarding_passes__dbt_tmp" rename to "Fact_boarding_passes"
[0m18:33:51.385245 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:33:51.392226 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: COMMIT
[0m18:33:51.393224 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:33:51.394221 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: COMMIT
[0m18:33:51.396217 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:33:51.404194 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:33:51.405191 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */
drop view if exists "flights_demo"."flights_wh"."Fact_boarding_passes__dbt_backup" cascade
[0m18:33:51.408184 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:33:51.412175 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_boarding_passes (execute): 18:33:51.206723 => 18:33:51.411177
[0m18:33:51.414176 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: Close
[0m18:33:51.416164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f67db26b-d47e-4f36-8969-784e9ece42a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBF6CECD0>]}
[0m18:33:51.419165 [info ] [Thread-1 (]: 3 of 6 OK created sql view model flights_wh.Fact_boarding_passes ............... [[32mCREATE VIEW[0m in 0.22s]
[0m18:33:51.423147 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_boarding_passes
[0m18:33:51.426140 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_flights
[0m18:33:51.428135 [info ] [Thread-1 (]: 4 of 6 START sql incremental model flights_wh.Fact_flights ..................... [RUN]
[0m18:33:51.431123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_boarding_passes, now model.flights_dbt.Fact_flights)
[0m18:33:51.432120 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_flights
[0m18:33:51.438104 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_flights"
[0m18:33:51.441096 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (compile): 18:33:51.433121 => 18:33:51.440100
[0m18:33:51.442094 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_flights
[0m18:33:51.456057 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:33:51.458054 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

    
  
    

  create temporary table "Fact_flights__dbt_tmp183351448080"
  
  
    as
  
  (
    

with dim_flight_mod as (	
			select *,
			extract(day from (scheduled_arrival - scheduled_departure)*24) + extract(hour from (scheduled_arrival - scheduled_departure)) as flight_duration_expected,
			extract(day from (actual_arrival - actual_departure)*24) + extract(hour from (actual_arrival - actual_departure)) as duration_actual_hours
			from flights_demo.stg.flights f 
			)
select *,
    case 	when duration_actual_hours > flight_duration_expected 
                then 'Longer'
            when duration_actual_hours < flight_duration_expected 
                then 'Shorter'
            when duration_actual_hours = flight_duration_expected 
                then 'As Expected'
            else null
            end as flight_duration_case,

'2023-08-16 15:33:49'::timestamp as dbt_time

from dim_flight_mod
  );
  
  
[0m18:33:51.459051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:51.858060 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m18:33:51.864045 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:33:51.865044 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: BEGIN
[0m18:33:51.866041 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:33:51.867039 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:33:51.868037 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights__dbt_tmp183351448080'
        
      order by ordinal_position

  
[0m18:33:51.890975 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:33:51.894963 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:33:51.895961 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:33:51.900948 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:33:51.905934 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:33:51.905934 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:33:51.911919 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:33:51.916909 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_flights"
[0m18:33:51.919900 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:33:51.920894 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      
        
            delete from "flights_demo"."flights_wh"."Fact_flights"
            where (
                flight_id) in (
                select (flight_id)
                from "Fact_flights__dbt_tmp183351448080"
            );

        
    

    insert into "flights_demo"."flights_wh"."Fact_flights" ("flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time")
    (
        select "flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time"
        from "Fact_flights__dbt_tmp183351448080"
    )
  
[0m18:33:52.023146 [debug] [Thread-1 (]: SQL status: INSERT 0 33121 in 0.0 seconds
[0m18:33:52.025141 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:33:52.026138 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:33:52.027135 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:33:52.038201 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:33:52.040197 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (execute): 18:33:51.443091 => 18:33:52.040197
[0m18:33:52.041199 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: Close
[0m18:33:52.043190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f67db26b-d47e-4f36-8969-784e9ece42a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBC0039310>]}
[0m18:33:52.044186 [info ] [Thread-1 (]: 4 of 6 OK created sql incremental model flights_wh.Fact_flights ................ [[32mINSERT 0 33121[0m in 0.61s]
[0m18:33:52.047182 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_flights
[0m18:33:52.049174 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m18:33:52.050171 [info ] [Thread-1 (]: 5 of 6 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m18:33:52.053162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_flights, now model.flights_dbt.my_first_dbt_model)
[0m18:33:52.054159 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m18:33:52.059148 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m18:33:52.062137 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 18:33:52.055157 => 18:33:52.061140
[0m18:33:52.062137 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m18:33:52.087088 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m18:33:52.089067 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:33:52.090063 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m18:33:52.091061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:52.155886 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:33:52.156884 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:33:52.157881 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:33:52.162874 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m18:33:52.167890 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:33:52.168887 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:33:52.170875 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:33:52.175832 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:33:52.176849 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:33:52.177835 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:33:52.185839 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:33:52.185839 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:33:52.186839 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:33:52.189796 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:33:52.192813 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:33:52.193828 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_demo"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:33:52.198774 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:33:52.201798 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 18:33:52.063170 => 18:33:52.200805
[0m18:33:52.202762 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m18:33:52.203759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f67db26b-d47e-4f36-8969-784e9ece42a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBFDC0150>]}
[0m18:33:52.205669 [info ] [Thread-1 (]: 5 of 6 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.15s]
[0m18:33:52.206650 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m18:33:52.209642 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m18:33:52.210671 [info ] [Thread-1 (]: 6 of 6 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:33:52.211635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m18:33:52.212665 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m18:33:52.216623 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m18:33:52.220619 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 18:33:52.213638 => 18:33:52.219626
[0m18:33:52.221609 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m18:33:52.230585 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m18:33:52.231581 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:33:52.232579 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m18:33:52.233577 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:52.310372 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:33:52.311368 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:33:52.311368 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_demo"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:33:52.318361 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:33:52.324335 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:33:52.325333 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:33:52.327328 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:33:52.332325 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:33:52.333315 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:33:52.335307 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:33:52.339295 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:33:52.342285 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:33:52.343283 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:33:52.344280 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:33:52.347273 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 18:33:52.222606 => 18:33:52.347273
[0m18:33:52.348269 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m18:33:52.350268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f67db26b-d47e-4f36-8969-784e9ece42a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBFDA2390>]}
[0m18:33:52.353256 [info ] [Thread-1 (]: 6 of 6 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.14s]
[0m18:33:52.356249 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m18:33:52.360240 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:52.361236 [debug] [MainThread]: On master: BEGIN
[0m18:33:52.361236 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:33:52.451309 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:33:52.452306 [debug] [MainThread]: On master: COMMIT
[0m18:33:52.452306 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:52.453303 [debug] [MainThread]: On master: COMMIT
[0m18:33:52.454300 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:33:52.454300 [debug] [MainThread]: On master: Close
[0m18:33:52.455298 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:33:52.456296 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m18:33:52.457293 [debug] [MainThread]: Connection 'list_flights_demo_flights_wh' was properly closed.
[0m18:33:52.458291 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m18:33:52.459291 [info ] [MainThread]: 
[0m18:33:52.460285 [info ] [MainThread]: Finished running 3 incremental models, 2 view models, 1 table model in 0 hours 0 minutes and 2.43 seconds (2.43s).
[0m18:33:52.463277 [debug] [MainThread]: Command end result
[0m18:33:52.480236 [info ] [MainThread]: 
[0m18:33:52.482230 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:33:52.483224 [info ] [MainThread]: 
[0m18:33:52.486220 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:33:52.490205 [debug] [MainThread]: Command `dbt run` succeeded at 18:33:52.489209 after 2.92 seconds
[0m18:33:52.490205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBBF451E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBB946A2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBB922DFD0>]}
[0m18:33:52.491202 [debug] [MainThread]: Flushing usage events
[0m18:34:09.524497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C941FEF90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C941E9D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C9429D490>]}


============================== 18:34:09.531484 | 041bbbc3-0862-4b8e-9399-409ce4368010 ==============================
[0m18:34:09.531484 [info ] [MainThread]: Running with dbt=1.5.3
[0m18:34:09.533473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:34:09.632754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '041bbbc3-0862-4b8e-9399-409ce4368010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C944EBF50>]}
[0m18:34:09.653663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '041bbbc3-0862-4b8e-9399-409ce4368010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C941642D0>]}
[0m18:34:09.655690 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m18:34:09.670657 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m18:34:09.839171 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:34:09.840166 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models\Facts\Fact_boarding_passes.sql
[0m18:34:09.875072 [debug] [MainThread]: 1603: static parser failed on Facts\Fact_boarding_passes.sql
[0m18:34:09.897015 [debug] [MainThread]: 1602: parser fallback to jinja rendering on Facts\Fact_boarding_passes.sql
[0m18:34:09.958849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '041bbbc3-0862-4b8e-9399-409ce4368010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C94D6E650>]}
[0m18:34:09.969822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '041bbbc3-0862-4b8e-9399-409ce4368010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C9495B210>]}
[0m18:34:09.970853 [info ] [MainThread]: Found 6 models, 10 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:34:09.971812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '041bbbc3-0862-4b8e-9399-409ce4368010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C90953090>]}
[0m18:34:09.973843 [info ] [MainThread]: 
[0m18:34:09.974804 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:34:09.977830 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m18:34:09.990762 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m18:34:09.992766 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m18:34:09.993761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:10.093493 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m18:34:10.095484 [debug] [ThreadPool]: On list_flights_demo: Close
[0m18:34:10.099472 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo_flights_wh'
[0m18:34:10.108451 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:34:10.109448 [debug] [ThreadPool]: On list_flights_demo_flights_wh: BEGIN
[0m18:34:10.110445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:10.172279 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:34:10.172279 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:34:10.173276 [debug] [ThreadPool]: On list_flights_demo_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo_flights_wh"} */
select
      'flights_demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:34:10.181289 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:34:10.183250 [debug] [ThreadPool]: On list_flights_demo_flights_wh: ROLLBACK
[0m18:34:10.184247 [debug] [ThreadPool]: On list_flights_demo_flights_wh: Close
[0m18:34:10.192262 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:10.192262 [debug] [MainThread]: On master: BEGIN
[0m18:34:10.193255 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:34:10.254091 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:34:10.255090 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:10.255090 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:34:10.292954 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m18:34:10.295946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '041bbbc3-0862-4b8e-9399-409ce4368010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C9420E210>]}
[0m18:34:10.296947 [debug] [MainThread]: On master: ROLLBACK
[0m18:34:10.298939 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:10.299941 [debug] [MainThread]: On master: BEGIN
[0m18:34:10.301930 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:34:10.302928 [debug] [MainThread]: On master: COMMIT
[0m18:34:10.303924 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:10.304922 [debug] [MainThread]: On master: COMMIT
[0m18:34:10.304922 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:34:10.305919 [debug] [MainThread]: On master: Close
[0m18:34:10.306916 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:34:10.308912 [info ] [MainThread]: 
[0m18:34:10.314898 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_Airport
[0m18:34:10.315892 [info ] [Thread-1 (]: 1 of 6 START sql incremental model flights_wh.Dim_Airport ...................... [RUN]
[0m18:34:10.318885 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flights_dbt.Dim_Airport'
[0m18:34:10.319883 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_Airport
[0m18:34:10.326865 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_Airport"
[0m18:34:10.331851 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (compile): 18:34:10.320891 => 18:34:10.330882
[0m18:34:10.332847 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_Airport
[0m18:34:10.448538 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:34:10.450535 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

    
  
    

  create temporary table "Dim_Airport__dbt_tmp183410397678"
  
  
    as
  
  (
    

select *,
    jsonb_extract_path(airport_name, 'en' )as airport_name_eng, 
    jsonb_extract_path(city, 'en' )as city_eng,
    jsonb_extract_path(airport_name, 'ru' )as airport_name_rus,
    jsonb_extract_path(city, 'en' )as city_rus,

'2023-08-16 15:34:09'::timestamp as dbt_time

from stg.airports_data
  );
  
  
[0m18:34:10.451533 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:34:10.529503 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:34:10.540473 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:34:10.541472 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: BEGIN
[0m18:34:10.542469 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:34:10.543466 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:34:10.543466 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport__dbt_tmp183410397678'
        
      order by ordinal_position

  
[0m18:34:10.569435 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:34:10.577409 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:34:10.578373 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:34:10.584394 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:34:10.595358 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:34:10.596328 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:34:10.601344 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:34:10.629239 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_Airport"
[0m18:34:10.630236 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:34:10.631234 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      
        
            delete from "flights_demo"."flights_wh"."Dim_Airport"
            where (
                airport_code) in (
                select (airport_code)
                from "Dim_Airport__dbt_tmp183410397678"
            );

        
    

    insert into "flights_demo"."flights_wh"."Dim_Airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time"
        from "Dim_Airport__dbt_tmp183410397678"
    )
  
[0m18:34:10.635256 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m18:34:10.657378 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:34:10.658343 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:34:10.659346 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:34:10.662335 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:34:10.663332 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (execute): 18:34:10.333847 => 18:34:10.663332
[0m18:34:10.664329 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: Close
[0m18:34:10.665324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '041bbbc3-0862-4b8e-9399-409ce4368010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C9493F410>]}
[0m18:34:10.667320 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model flights_wh.Dim_Airport ................. [[32mINSERT 0 104[0m in 0.35s]
[0m18:34:10.670313 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_Airport
[0m18:34:10.671310 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_aircraft
[0m18:34:10.672306 [info ] [Thread-1 (]: 2 of 6 START sql incremental model flights_wh.Dim_aircraft ..................... [RUN]
[0m18:34:10.675305 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_Airport, now model.flights_dbt.Dim_aircraft)
[0m18:34:10.676298 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_aircraft
[0m18:34:10.685276 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_aircraft"
[0m18:34:10.690262 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (compile): 18:34:10.677300 => 18:34:10.688286
[0m18:34:10.692257 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_aircraft
[0m18:34:10.700233 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:34:10.702236 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

    
  
    

  create temporary table "Dim_aircraft__dbt_tmp183410695285"
  
  
    as
  
  (
    

select 
    row_number() over() as dim_aircraft_id,

    ad.aircraft_code,
    ad.model,
    ad.range,
    ad.last_update,

    s. seat_no,
    s.fare_conditions,

    case when range >= 5600 then 'High'
        when range < 5600 then 'Low'
        else 'Null'
        end as range_L_H,
    jsonb_extract_path(model, 'en' )as Model_English,
    jsonb_extract_path(model, 'ru' )as Model_Russian,

'2023-08-16 15:34:09'::timestamp as dbt_time

from flights_demo.stg.aircrafts_data ad 
join flights_demo.stg.seats s 
	on s.aircraft_code = ad.aircraft_code
  );
  
  
[0m18:34:10.703233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:10.804469 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m18:34:10.809456 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:34:10.809456 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: BEGIN
[0m18:34:10.811450 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:34:10.812448 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:34:10.812448 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft__dbt_tmp183410695285'
        
      order by ordinal_position

  
[0m18:34:10.835419 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:34:10.840406 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:34:10.841404 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:34:10.846358 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:34:10.851378 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:34:10.852340 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:34:10.858367 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:34:10.870331 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_aircraft"
[0m18:34:10.872288 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:34:10.872288 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      insert into "flights_demo"."flights_wh"."Dim_aircraft" ("dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time")
    (
        select "dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time"
        from "Dim_aircraft__dbt_tmp183410695285"
    )


  
[0m18:34:10.878295 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m18:34:10.881264 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:34:10.883261 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:34:10.884255 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:34:10.887284 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:34:10.889287 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (execute): 18:34:10.693253 => 18:34:10.889287
[0m18:34:10.890242 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: Close
[0m18:34:10.892235 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '041bbbc3-0862-4b8e-9399-409ce4368010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C94D3A210>]}
[0m18:34:10.894230 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model flights_wh.Dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.22s]
[0m18:34:10.896224 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_aircraft
[0m18:34:10.897223 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_boarding_passes
[0m18:34:10.899218 [info ] [Thread-1 (]: 3 of 6 START sql incremental model flights_wh.Fact_boarding_passes ............. [RUN]
[0m18:34:10.901210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_aircraft, now model.flights_dbt.Fact_boarding_passes)
[0m18:34:10.902208 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_boarding_passes
[0m18:34:10.909200 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_boarding_passes"
[0m18:34:10.911187 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_boarding_passes (compile): 18:34:10.903206 => 18:34:10.910189
[0m18:34:10.912183 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_boarding_passes
[0m18:34:10.922161 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_boarding_passes"
[0m18:34:10.925162 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:34:10.926149 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: BEGIN
[0m18:34:10.927155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:10.991000 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:34:10.992965 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:34:10.992965 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      
  
    

  create  table "flights_demo"."flights_wh"."Fact_boarding_passes__dbt_tmp"
  
  
    as
  
  (
    

select 
    bp.ticket_no,
    bp.flight_id,
    bp.boarding_no,
    bp.seat_no,
    bp.last_update,

    tf.fare_conditions,
    tf.amount,

'2023-08-16 15:34:09'::timestamp as dbt_time

from flights_demo.stg.ticket_flights tf 
join flights_demo.stg.boarding_passes bp 
	on tf.ticket_no = bp.ticket_no 
	and tf.flight_id =bp.flight_id
  );
  
  
[0m18:34:14.263629 [debug] [Thread-1 (]: SQL status: SELECT 579686 in 3.0 seconds
[0m18:34:14.275629 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:34:14.276594 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */
alter table "flights_demo"."flights_wh"."Fact_boarding_passes" rename to "Fact_boarding_passes__dbt_backup"
[0m18:34:14.279586 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:34:14.282578 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:34:14.283575 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */
alter table "flights_demo"."flights_wh"."Fact_boarding_passes__dbt_tmp" rename to "Fact_boarding_passes"
[0m18:34:14.284572 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:34:14.296546 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: COMMIT
[0m18:34:14.297548 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:34:14.299533 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: COMMIT
[0m18:34:14.311529 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:34:14.318482 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:34:14.318482 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */
drop view if exists "flights_demo"."flights_wh"."Fact_boarding_passes__dbt_backup" cascade
[0m18:34:14.324465 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:34:14.326486 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_boarding_passes (execute): 18:34:10.912183 => 18:34:14.326486
[0m18:34:14.327458 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: Close
[0m18:34:14.329453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '041bbbc3-0862-4b8e-9399-409ce4368010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C94E60F50>]}
[0m18:34:14.330466 [info ] [Thread-1 (]: 3 of 6 OK created sql incremental model flights_wh.Fact_boarding_passes ........ [[32mSELECT 579686[0m in 3.43s]
[0m18:34:14.332444 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_boarding_passes
[0m18:34:14.333468 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_flights
[0m18:34:14.334465 [info ] [Thread-1 (]: 4 of 6 START sql incremental model flights_wh.Fact_flights ..................... [RUN]
[0m18:34:14.335438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_boarding_passes, now model.flights_dbt.Fact_flights)
[0m18:34:14.336434 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_flights
[0m18:34:14.339426 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_flights"
[0m18:34:14.341420 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (compile): 18:34:14.336434 => 18:34:14.340422
[0m18:34:14.341420 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_flights
[0m18:34:14.350396 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:34:14.350396 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

    
  
    

  create temporary table "Fact_flights__dbt_tmp183414344412"
  
  
    as
  
  (
    

with dim_flight_mod as (	
			select *,
			extract(day from (scheduled_arrival - scheduled_departure)*24) + extract(hour from (scheduled_arrival - scheduled_departure)) as flight_duration_expected,
			extract(day from (actual_arrival - actual_departure)*24) + extract(hour from (actual_arrival - actual_departure)) as duration_actual_hours
			from flights_demo.stg.flights f 
			)
select *,
    case 	when duration_actual_hours > flight_duration_expected 
                then 'Longer'
            when duration_actual_hours < flight_duration_expected 
                then 'Shorter'
            when duration_actual_hours = flight_duration_expected 
                then 'As Expected'
            else null
            end as flight_duration_case,

'2023-08-16 15:34:09'::timestamp as dbt_time

from dim_flight_mod
  );
  
  
[0m18:34:14.351393 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:14.640621 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m18:34:14.643612 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:34:14.644610 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: BEGIN
[0m18:34:14.646605 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:34:14.648600 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:34:14.648600 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights__dbt_tmp183414344412'
        
      order by ordinal_position

  
[0m18:34:14.670540 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:34:14.674568 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:34:14.675560 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:34:14.681539 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:34:14.685501 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:34:14.686499 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:34:14.692483 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:34:14.699471 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_flights"
[0m18:34:14.701463 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:34:14.702458 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      
        
            delete from "flights_demo"."flights_wh"."Fact_flights"
            where (
                flight_id) in (
                select (flight_id)
                from "Fact_flights__dbt_tmp183414344412"
            );

        
    

    insert into "flights_demo"."flights_wh"."Fact_flights" ("flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time")
    (
        select "flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time"
        from "Fact_flights__dbt_tmp183414344412"
    )
  
[0m18:34:14.853564 [debug] [Thread-1 (]: SQL status: INSERT 0 33121 in 0.0 seconds
[0m18:34:14.856556 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:34:14.857553 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:34:14.858548 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:34:14.871512 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:34:14.872509 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (execute): 18:34:14.342417 => 18:34:14.872509
[0m18:34:14.873507 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: Close
[0m18:34:14.874504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '041bbbc3-0862-4b8e-9399-409ce4368010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C94E62B90>]}
[0m18:34:14.875502 [info ] [Thread-1 (]: 4 of 6 OK created sql incremental model flights_wh.Fact_flights ................ [[32mINSERT 0 33121[0m in 0.54s]
[0m18:34:14.877496 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_flights
[0m18:34:14.879493 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m18:34:14.882486 [info ] [Thread-1 (]: 5 of 6 START sql table model flights_wh.my_first_dbt_model ..................... [RUN]
[0m18:34:14.884479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_flights, now model.flights_dbt.my_first_dbt_model)
[0m18:34:14.886475 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m18:34:14.892493 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m18:34:14.895452 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 18:34:14.887469 => 18:34:14.894451
[0m18:34:14.896447 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m18:34:14.920383 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m18:34:14.922377 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:34:14.923382 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m18:34:14.924379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:15.002177 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:34:15.002177 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:34:15.003177 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  
    

  create  table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m18:34:15.011156 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.0 seconds
[0m18:34:15.019136 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:34:15.021129 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:34:15.023123 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:34:15.031101 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:34:15.032131 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:34:15.034095 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:34:15.041119 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:34:15.042072 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:34:15.043088 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:34:15.045084 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:34:15.052071 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:34:15.052071 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_demo"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:34:15.060026 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:34:15.063015 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 18:34:14.896447 => 18:34:15.063015
[0m18:34:15.064012 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m18:34:15.066007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '041bbbc3-0862-4b8e-9399-409ce4368010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C94D6A8D0>]}
[0m18:34:15.067005 [info ] [Thread-1 (]: 5 of 6 OK created sql table model flights_wh.my_first_dbt_model ................ [[32mSELECT 2[0m in 0.18s]
[0m18:34:15.069001 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m18:34:15.070995 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m18:34:15.072035 [info ] [Thread-1 (]: 6 of 6 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:34:15.073986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m18:34:15.075981 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m18:34:15.081966 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m18:34:15.083959 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 18:34:15.077019 => 18:34:15.082963
[0m18:34:15.084959 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m18:34:15.139811 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m18:34:15.141806 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:34:15.142801 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m18:34:15.143800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:15.221590 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:34:15.222588 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:34:15.223585 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_demo"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:34:15.230567 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:34:15.235587 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:34:15.235587 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:34:15.237592 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:34:15.240573 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:34:15.240573 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:34:15.241540 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:34:15.243532 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:34:15.246558 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:34:15.247555 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:34:15.249516 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:34:15.252507 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 18:34:15.084959 => 18:34:15.251537
[0m18:34:15.253537 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m18:34:15.254502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '041bbbc3-0862-4b8e-9399-409ce4368010', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C94CD0510>]}
[0m18:34:15.255501 [info ] [Thread-1 (]: 6 of 6 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.18s]
[0m18:34:15.259640 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m18:34:15.263625 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:15.264623 [debug] [MainThread]: On master: BEGIN
[0m18:34:15.265620 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:34:15.337431 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:34:15.339422 [debug] [MainThread]: On master: COMMIT
[0m18:34:15.340421 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:15.341417 [debug] [MainThread]: On master: COMMIT
[0m18:34:15.342415 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:34:15.343412 [debug] [MainThread]: On master: Close
[0m18:34:15.345408 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:15.346406 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m18:34:15.348399 [debug] [MainThread]: Connection 'list_flights_demo_flights_wh' was properly closed.
[0m18:34:15.350398 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m18:34:15.353385 [info ] [MainThread]: 
[0m18:34:15.355422 [info ] [MainThread]: Finished running 4 incremental models, 1 table model, 1 view model in 0 hours 0 minutes and 5.38 seconds (5.38s).
[0m18:34:15.361366 [debug] [MainThread]: Command end result
[0m18:34:15.378321 [info ] [MainThread]: 
[0m18:34:15.382309 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:34:15.384304 [info ] [MainThread]: 
[0m18:34:15.386298 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:34:15.389292 [debug] [MainThread]: Command `dbt run` succeeded at 18:34:15.388295 after 5.89 seconds
[0m18:34:15.390290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C93FC5A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C8E039110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C8E07DFD0>]}
[0m18:34:15.393285 [debug] [MainThread]: Flushing usage events
[0m18:34:57.200915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FF34F490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FF681190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FF3AD590>]}


============================== 18:34:57.211877 | 7f06fe1c-31e5-4a32-82c2-54a0f4d7ad39 ==============================
[0m18:34:57.211877 [info ] [MainThread]: Running with dbt=1.5.3
[0m18:34:57.214871 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:34:57.356542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f06fe1c-31e5-4a32-82c2-54a0f4d7ad39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FF111810>]}
[0m18:34:57.379542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f06fe1c-31e5-4a32-82c2-54a0f4d7ad39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FF111810>]}
[0m18:34:57.380503 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m18:34:57.393474 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m18:34:57.528107 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:34:57.530071 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models\example\my_first_dbt_model.sql
[0m18:34:57.570974 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m18:34:57.666251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f06fe1c-31e5-4a32-82c2-54a0f4d7ad39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FFDF0DD0>]}
[0m18:34:57.678217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f06fe1c-31e5-4a32-82c2-54a0f4d7ad39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FFE1B850>]}
[0m18:34:57.679215 [info ] [MainThread]: Found 6 models, 10 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:34:57.681225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f06fe1c-31e5-4a32-82c2-54a0f4d7ad39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FBAF32D0>]}
[0m18:34:57.683240 [info ] [MainThread]: 
[0m18:34:57.685238 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:34:57.689191 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m18:34:57.707141 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m18:34:57.708175 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m18:34:57.709138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:57.916496 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m18:34:57.919489 [debug] [ThreadPool]: On list_flights_demo: Close
[0m18:34:57.923481 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo_flights_wh'
[0m18:34:57.934449 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:34:57.935461 [debug] [ThreadPool]: On list_flights_demo_flights_wh: BEGIN
[0m18:34:57.936446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:58.004772 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:34:58.006776 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:34:58.008762 [debug] [ThreadPool]: On list_flights_demo_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo_flights_wh"} */
select
      'flights_demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:34:58.041677 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:34:58.049186 [debug] [ThreadPool]: On list_flights_demo_flights_wh: ROLLBACK
[0m18:34:58.052180 [debug] [ThreadPool]: On list_flights_demo_flights_wh: Close
[0m18:34:58.071123 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:58.073124 [debug] [MainThread]: On master: BEGIN
[0m18:34:58.075129 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:34:58.244658 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:34:58.245691 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:58.246655 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:34:58.287578 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:34:58.292531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f06fe1c-31e5-4a32-82c2-54a0f4d7ad39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FF38BB10>]}
[0m18:34:58.293566 [debug] [MainThread]: On master: ROLLBACK
[0m18:34:58.293566 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:58.294526 [debug] [MainThread]: On master: BEGIN
[0m18:34:58.294526 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:34:58.295553 [debug] [MainThread]: On master: COMMIT
[0m18:34:58.295553 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:58.296520 [debug] [MainThread]: On master: COMMIT
[0m18:34:58.297517 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:34:58.297517 [debug] [MainThread]: On master: Close
[0m18:34:58.298517 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:34:58.300510 [info ] [MainThread]: 
[0m18:34:58.312476 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_Airport
[0m18:34:58.313510 [info ] [Thread-1 (]: 1 of 6 START sql incremental model flights_wh.Dim_Airport ...................... [RUN]
[0m18:34:58.314472 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flights_dbt.Dim_Airport'
[0m18:34:58.315505 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_Airport
[0m18:34:58.318461 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_Airport"
[0m18:34:58.319493 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (compile): 18:34:58.315505 => 18:34:58.319493
[0m18:34:58.320456 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_Airport
[0m18:34:58.431163 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:34:58.433159 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

    
  
    

  create temporary table "Dim_Airport__dbt_tmp183458379305"
  
  
    as
  
  (
    

select *,
    jsonb_extract_path(airport_name, 'en' )as airport_name_eng, 
    jsonb_extract_path(city, 'en' )as city_eng,
    jsonb_extract_path(airport_name, 'ru' )as airport_name_rus,
    jsonb_extract_path(city, 'en' )as city_rus,

'2023-08-16 15:34:57'::timestamp as dbt_time

from stg.airports_data
  );
  
  
[0m18:34:58.435152 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:34:58.544856 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:34:58.563805 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:34:58.564802 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: BEGIN
[0m18:34:58.565802 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:34:58.565802 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:34:58.566797 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport__dbt_tmp183458379305'
        
      order by ordinal_position

  
[0m18:34:58.589739 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:34:58.595719 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:34:58.596717 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:34:58.601704 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:34:58.611678 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:34:58.612676 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:34:58.617666 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:34:58.638605 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_Airport"
[0m18:34:58.639602 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:34:58.640601 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      
        
            delete from "flights_demo"."flights_wh"."Dim_Airport"
            where (
                airport_code) in (
                select (airport_code)
                from "Dim_Airport__dbt_tmp183458379305"
            );

        
    

    insert into "flights_demo"."flights_wh"."Dim_Airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time"
        from "Dim_Airport__dbt_tmp183458379305"
    )
  
[0m18:34:58.643593 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m18:34:58.661579 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:34:58.661579 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:34:58.662541 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:34:58.663539 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:34:58.665570 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (execute): 18:34:58.320456 => 18:34:58.664577
[0m18:34:58.665570 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: Close
[0m18:34:58.667528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f06fe1c-31e5-4a32-82c2-54a0f4d7ad39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FF699150>]}
[0m18:34:58.668527 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model flights_wh.Dim_Airport ................. [[32mINSERT 0 104[0m in 0.35s]
[0m18:34:58.670521 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_Airport
[0m18:34:58.672525 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_aircraft
[0m18:34:58.673515 [info ] [Thread-1 (]: 2 of 6 START sql incremental model flights_wh.Dim_aircraft ..................... [RUN]
[0m18:34:58.677505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_Airport, now model.flights_dbt.Dim_aircraft)
[0m18:34:58.679498 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_aircraft
[0m18:34:58.685484 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_aircraft"
[0m18:34:58.690495 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (compile): 18:34:58.680499 => 18:34:58.687475
[0m18:34:58.693460 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_aircraft
[0m18:34:58.701465 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:34:58.702461 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

    
  
    

  create temporary table "Dim_aircraft__dbt_tmp183458698445"
  
  
    as
  
  (
    

select 
    row_number() over() as dim_aircraft_id,

    ad.aircraft_code,
    ad.model,
    ad.range,
    ad.last_update,

    s. seat_no,
    s.fare_conditions,

    case when range >= 5600 then 'High'
        when range < 5600 then 'Low'
        else 'Null'
        end as range_L_H,
    jsonb_extract_path(model, 'en' )as Model_English,
    jsonb_extract_path(model, 'ru' )as Model_Russian,

'2023-08-16 15:34:57'::timestamp as dbt_time

from flights_demo.stg.aircrafts_data ad 
join flights_demo.stg.seats s 
	on s.aircraft_code = ad.aircraft_code
  );
  
  
[0m18:34:58.702461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:58.784249 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m18:34:58.788217 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:34:58.789230 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: BEGIN
[0m18:34:58.790201 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:34:58.791226 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:34:58.791226 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft__dbt_tmp183458698445'
        
      order by ordinal_position

  
[0m18:34:58.812159 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:34:58.816130 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:34:58.817154 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:34:58.822141 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:34:58.825133 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:34:58.826103 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:34:58.830125 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:34:58.841123 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_aircraft"
[0m18:34:58.843062 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:34:58.844057 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      insert into "flights_demo"."flights_wh"."Dim_aircraft" ("dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time")
    (
        select "dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time"
        from "Dim_aircraft__dbt_tmp183458698445"
    )


  
[0m18:34:58.850040 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m18:34:58.853034 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:34:58.853034 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:34:58.854028 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:34:58.857021 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:34:58.859016 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (execute): 18:34:58.694457 => 18:34:58.859016
[0m18:34:58.860044 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: Close
[0m18:34:58.861011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f06fe1c-31e5-4a32-82c2-54a0f4d7ad39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FFF24250>]}
[0m18:34:58.862008 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model flights_wh.Dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.18s]
[0m18:34:58.864004 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_aircraft
[0m18:34:58.865998 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_boarding_passes
[0m18:34:58.868989 [info ] [Thread-1 (]: 3 of 6 START sql incremental model flights_wh.Fact_boarding_passes ............. [RUN]
[0m18:34:58.872980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_aircraft, now model.flights_dbt.Fact_boarding_passes)
[0m18:34:58.873981 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_boarding_passes
[0m18:34:58.882956 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_boarding_passes"
[0m18:34:58.886944 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_boarding_passes (compile): 18:34:58.874975 => 18:34:58.884953
[0m18:34:58.887942 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_boarding_passes
[0m18:34:58.896914 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:34:58.898910 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

    
  
    

  create temporary table "Fact_boarding_passes__dbt_tmp183458892927"
  
  
    as
  
  (
    

select 
    bp.ticket_no,
    bp.flight_id,
    bp.boarding_no,
    bp.seat_no,
    bp.last_update,

    tf.fare_conditions,
    tf.amount,

'2023-08-16 15:34:57'::timestamp as dbt_time

from flights_demo.stg.ticket_flights tf 
join flights_demo.stg.boarding_passes bp 
	on tf.ticket_no = bp.ticket_no 
	and tf.flight_id =bp.flight_id
  );
  
  
[0m18:34:58.899907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:01.196673 [debug] [Thread-1 (]: SQL status: SELECT 579686 in 2.0 seconds
[0m18:35:01.206613 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:35:01.208609 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: BEGIN
[0m18:35:01.210603 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:01.212596 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:35:01.213623 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Fact_boarding_passes__dbt_tmp183458892927'
        
      order by ordinal_position

  
[0m18:35:01.241519 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m18:35:01.248501 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:35:01.250500 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_boarding_passes'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:35:01.256480 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m18:35:01.262467 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:35:01.263462 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_boarding_passes'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:35:01.270445 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m18:35:01.276431 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_boarding_passes"
[0m18:35:01.279419 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:35:01.280417 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      
        
            delete from "flights_demo"."flights_wh"."Fact_boarding_passes"
            where (
                ticket_no) in (
                select (ticket_no)
                from "Fact_boarding_passes__dbt_tmp183458892927"
            );

        
    

    insert into "flights_demo"."flights_wh"."Fact_boarding_passes" ("ticket_no", "flight_id", "boarding_no", "seat_no", "last_update", "fare_conditions", "amount", "dbt_time")
    (
        select "ticket_no", "flight_id", "boarding_no", "seat_no", "last_update", "fare_conditions", "amount", "dbt_time"
        from "Fact_boarding_passes__dbt_tmp183458892927"
    )
  
[0m18:35:05.453894 [debug] [Thread-1 (]: SQL status: INSERT 0 579686 in 4.0 seconds
[0m18:35:05.457879 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: COMMIT
[0m18:35:05.458873 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:35:05.459906 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: COMMIT
[0m18:35:05.470878 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:05.472871 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_boarding_passes (execute): 18:34:58.888949 => 18:35:05.472871
[0m18:35:05.473835 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: Close
[0m18:35:05.474834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f06fe1c-31e5-4a32-82c2-54a0f4d7ad39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7800EF690>]}
[0m18:35:05.476873 [info ] [Thread-1 (]: 3 of 6 OK created sql incremental model flights_wh.Fact_boarding_passes ........ [[32mINSERT 0 579686[0m in 6.60s]
[0m18:35:05.480817 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_boarding_passes
[0m18:35:05.481814 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_flights
[0m18:35:05.483807 [info ] [Thread-1 (]: 4 of 6 START sql incremental model flights_wh.Fact_flights ..................... [RUN]
[0m18:35:05.487802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_boarding_passes, now model.flights_dbt.Fact_flights)
[0m18:35:05.489796 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_flights
[0m18:35:05.499690 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_flights"
[0m18:35:05.507675 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (compile): 18:35:05.490789 => 18:35:05.504679
[0m18:35:05.509665 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_flights
[0m18:35:05.529613 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:35:05.531603 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

    
  
    

  create temporary table "Fact_flights__dbt_tmp183505520637"
  
  
    as
  
  (
    

with dim_flight_mod as (	
			select *,
			extract(day from (scheduled_arrival - scheduled_departure)*24) + extract(hour from (scheduled_arrival - scheduled_departure)) as flight_duration_expected,
			extract(day from (actual_arrival - actual_departure)*24) + extract(hour from (actual_arrival - actual_departure)) as duration_actual_hours
			from flights_demo.stg.flights f 
			)
select *,
    case 	when duration_actual_hours > flight_duration_expected 
                then 'Longer'
            when duration_actual_hours < flight_duration_expected 
                then 'Shorter'
            when duration_actual_hours = flight_duration_expected 
                then 'As Expected'
            else null
            end as flight_duration_case,

'2023-08-16 15:34:57'::timestamp as dbt_time

from dim_flight_mod
  );
  
  
[0m18:35:05.533600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:05.879736 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m18:35:05.883724 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:35:05.883724 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: BEGIN
[0m18:35:05.885720 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:05.886719 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:35:05.887715 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights__dbt_tmp183505520637'
        
      order by ordinal_position

  
[0m18:35:05.917634 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:35:05.924617 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:35:05.925614 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:35:05.932599 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:35:05.938580 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:35:05.939578 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:35:05.945560 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:35:05.950551 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_flights"
[0m18:35:05.952541 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:35:05.953540 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      
        
            delete from "flights_demo"."flights_wh"."Fact_flights"
            where (
                flight_id) in (
                select (flight_id)
                from "Fact_flights__dbt_tmp183505520637"
            );

        
    

    insert into "flights_demo"."flights_wh"."Fact_flights" ("flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time")
    (
        select "flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time"
        from "Fact_flights__dbt_tmp183505520637"
    )
  
[0m18:35:06.160984 [debug] [Thread-1 (]: SQL status: INSERT 0 33121 in 0.0 seconds
[0m18:35:06.165971 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:35:06.166969 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:35:06.168964 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:35:06.179935 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:06.182928 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (execute): 18:35:05.511658 => 18:35:06.181930
[0m18:35:06.183924 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: Close
[0m18:35:06.184922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f06fe1c-31e5-4a32-82c2-54a0f4d7ad39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7800EEDD0>]}
[0m18:35:06.186916 [info ] [Thread-1 (]: 4 of 6 OK created sql incremental model flights_wh.Fact_flights ................ [[32mINSERT 0 33121[0m in 0.70s]
[0m18:35:06.190907 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_flights
[0m18:35:06.192898 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m18:35:06.194896 [info ] [Thread-1 (]: 5 of 6 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m18:35:06.199884 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_flights, now model.flights_dbt.my_first_dbt_model)
[0m18:35:06.201876 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m18:35:06.208857 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m18:35:06.214872 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 18:35:06.203872 => 18:35:06.211852
[0m18:35:06.216838 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m18:35:06.271698 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m18:35:06.274680 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:35:06.275678 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m18:35:06.276677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:06.384388 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:06.385386 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:35:06.386381 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:35:06.405330 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:35:06.424281 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:35:06.427274 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:35:06.432261 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:06.444229 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:35:06.446221 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:35:06.453205 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:06.469162 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:35:06.471166 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:35:06.474148 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:35:06.478137 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:06.494093 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:35:06.495090 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop table if exists "flights_demo"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:35:06.505070 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.0 seconds
[0m18:35:06.509056 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 18:35:06.218833 => 18:35:06.508060
[0m18:35:06.511048 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m18:35:06.513043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f06fe1c-31e5-4a32-82c2-54a0f4d7ad39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FFE8BA90>]}
[0m18:35:06.516037 [info ] [Thread-1 (]: 5 of 6 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.32s]
[0m18:35:06.520030 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m18:35:06.527012 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m18:35:06.529004 [info ] [Thread-1 (]: 6 of 6 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:35:06.531994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m18:35:06.532991 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m18:35:06.538978 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m18:35:06.541969 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 18:35:06.533987 => 18:35:06.540970
[0m18:35:06.542966 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m18:35:06.575876 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m18:35:06.585848 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:35:06.586847 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m18:35:06.594826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:06.704054 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:06.705052 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:35:06.706047 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_demo"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:35:06.717018 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:35:06.722005 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:35:06.724017 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:35:06.725996 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:06.730999 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:35:06.731985 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:35:06.732977 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:35:06.734971 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:06.741951 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:35:06.742948 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:35:06.743946 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:35:06.746938 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 18:35:06.543960 => 18:35:06.745942
[0m18:35:06.747936 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m18:35:06.748934 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f06fe1c-31e5-4a32-82c2-54a0f4d7ad39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FFDA45D0>]}
[0m18:35:06.750928 [info ] [Thread-1 (]: 6 of 6 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.22s]
[0m18:35:06.754918 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m18:35:06.758907 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:06.759905 [debug] [MainThread]: On master: BEGIN
[0m18:35:06.760903 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:35:06.848667 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:35:06.849666 [debug] [MainThread]: On master: COMMIT
[0m18:35:06.850661 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:06.851659 [debug] [MainThread]: On master: COMMIT
[0m18:35:06.852655 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:35:06.853653 [debug] [MainThread]: On master: Close
[0m18:35:06.855649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:06.856645 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m18:35:06.857642 [debug] [MainThread]: Connection 'list_flights_demo_flights_wh' was properly closed.
[0m18:35:06.858641 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m18:35:06.861632 [info ] [MainThread]: 
[0m18:35:06.864625 [info ] [MainThread]: Finished running 4 incremental models, 2 view models in 0 hours 0 minutes and 9.18 seconds (9.18s).
[0m18:35:06.868612 [debug] [MainThread]: Command end result
[0m18:35:06.880580 [info ] [MainThread]: 
[0m18:35:06.883577 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:35:06.886567 [info ] [MainThread]: 
[0m18:35:06.890559 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:35:06.894544 [debug] [MainThread]: Command `dbt run` succeeded at 18:35:06.893553 after 9.72 seconds
[0m18:35:06.895553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FFADEF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FFADF690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7FF659750>]}
[0m18:35:06.896539 [debug] [MainThread]: Flushing usage events
[0m18:35:50.203634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBE9396D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBE93F2650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBE93CEA10>]}


============================== 18:35:50.211645 | b32f0acd-2855-4544-87ba-c237d13d8c9c ==============================
[0m18:35:50.211645 [info ] [MainThread]: Running with dbt=1.5.3
[0m18:35:50.213608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:35:50.374179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b32f0acd-2855-4544-87ba-c237d13d8c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBE9058790>]}
[0m18:35:50.402104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b32f0acd-2855-4544-87ba-c237d13d8c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBE97B6610>]}
[0m18:35:50.404269 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m18:35:50.428040 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m18:35:50.553737 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:35:50.555695 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:35:50.564703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b32f0acd-2855-4544-87ba-c237d13d8c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBE9A70B10>]}
[0m18:35:50.575678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b32f0acd-2855-4544-87ba-c237d13d8c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBE9A6ACD0>]}
[0m18:35:50.576652 [info ] [MainThread]: Found 6 models, 10 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:35:50.577634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b32f0acd-2855-4544-87ba-c237d13d8c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBE57D3090>]}
[0m18:35:50.582621 [info ] [MainThread]: 
[0m18:35:50.584620 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:35:50.589603 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m18:35:50.605594 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m18:35:50.607572 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m18:35:50.610551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:50.728233 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m18:35:50.730230 [debug] [ThreadPool]: On list_flights_demo: Close
[0m18:35:50.734216 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo_flights_wh'
[0m18:35:50.750979 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:35:50.752991 [debug] [ThreadPool]: On list_flights_demo_flights_wh: BEGIN
[0m18:35:50.754966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:50.959588 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:35:50.960572 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:35:50.960572 [debug] [ThreadPool]: On list_flights_demo_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo_flights_wh"} */
select
      'flights_demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:35:50.979487 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:35:50.981482 [debug] [ThreadPool]: On list_flights_demo_flights_wh: ROLLBACK
[0m18:35:50.982480 [debug] [ThreadPool]: On list_flights_demo_flights_wh: Close
[0m18:35:50.989461 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:50.990492 [debug] [MainThread]: On master: BEGIN
[0m18:35:50.990492 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:35:51.036334 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:35:51.037366 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:51.039328 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:35:51.075231 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:35:51.079235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b32f0acd-2855-4544-87ba-c237d13d8c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBE9A8C550>]}
[0m18:35:51.080221 [debug] [MainThread]: On master: ROLLBACK
[0m18:35:51.081215 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:51.082258 [debug] [MainThread]: On master: BEGIN
[0m18:35:51.084209 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:35:51.085220 [debug] [MainThread]: On master: COMMIT
[0m18:35:51.086202 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:51.087200 [debug] [MainThread]: On master: COMMIT
[0m18:35:51.088199 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:35:51.089197 [debug] [MainThread]: On master: Close
[0m18:35:51.091188 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:51.093182 [info ] [MainThread]: 
[0m18:35:51.103157 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_Airport
[0m18:35:51.104155 [info ] [Thread-1 (]: 1 of 6 START sql incremental model flights_wh.Dim_Airport ...................... [RUN]
[0m18:35:51.109145 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flights_dbt.Dim_Airport'
[0m18:35:51.111137 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_Airport
[0m18:35:51.117121 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_Airport"
[0m18:35:51.119116 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (compile): 18:35:51.112134 => 18:35:51.118119
[0m18:35:51.119116 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_Airport
[0m18:35:51.243780 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:35:51.243780 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

    
  
    

  create temporary table "Dim_Airport__dbt_tmp183551204888"
  
  
    as
  
  (
    

select *,
    jsonb_extract_path(airport_name, 'en' )as airport_name_eng, 
    jsonb_extract_path(city, 'en' )as city_eng,
    jsonb_extract_path(airport_name, 'ru' )as airport_name_rus,
    jsonb_extract_path(city, 'en' )as city_rus,

'2023-08-16 15:35:50'::timestamp as dbt_time

from stg.airports_data
  );
  
  
[0m18:35:51.244778 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:35:51.307612 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:35:51.318579 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:35:51.319610 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: BEGIN
[0m18:35:51.320574 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:51.321572 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:35:51.321572 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport__dbt_tmp183551204888'
        
      order by ordinal_position

  
[0m18:35:51.343541 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:35:51.350529 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:35:51.350529 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:35:51.354484 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:35:51.363461 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:35:51.364458 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:35:51.374433 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:35:51.400363 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_Airport"
[0m18:35:51.402356 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:35:51.403353 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      
        
            delete from "flights_demo"."flights_wh"."Dim_Airport"
            where (
                airport_code) in (
                select (airport_code)
                from "Dim_Airport__dbt_tmp183551204888"
            );

        
    

    insert into "flights_demo"."flights_wh"."Dim_Airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time"
        from "Dim_Airport__dbt_tmp183551204888"
    )
  
[0m18:35:51.411331 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m18:35:51.429286 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:35:51.430281 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:35:51.431280 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:35:51.433272 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:51.435269 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (execute): 18:35:51.120111 => 18:35:51.434270
[0m18:35:51.437275 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: Close
[0m18:35:51.439292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b32f0acd-2855-4544-87ba-c237d13d8c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBE9ADE910>]}
[0m18:35:51.442250 [info ] [Thread-1 (]: 1 of 6 OK created sql incremental model flights_wh.Dim_Airport ................. [[32mINSERT 0 104[0m in 0.33s]
[0m18:35:51.444245 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_Airport
[0m18:35:51.445243 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_aircraft
[0m18:35:51.446240 [info ] [Thread-1 (]: 2 of 6 START sql incremental model flights_wh.Dim_aircraft ..................... [RUN]
[0m18:35:51.448233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_Airport, now model.flights_dbt.Dim_aircraft)
[0m18:35:51.449231 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_aircraft
[0m18:35:51.452261 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_aircraft"
[0m18:35:51.453220 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (compile): 18:35:51.449231 => 18:35:51.453220
[0m18:35:51.454258 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_aircraft
[0m18:35:51.462217 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:35:51.463193 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

    
  
    

  create temporary table "Dim_aircraft__dbt_tmp183551457226"
  
  
    as
  
  (
    

select 
    row_number() over() as dim_aircraft_id,

    ad.aircraft_code,
    ad.model,
    ad.range,
    ad.last_update,

    s. seat_no,
    s.fare_conditions,

    case when range >= 5600 then 'High'
        when range < 5600 then 'Low'
        else 'Null'
        end as range_L_H,
    jsonb_extract_path(model, 'en' )as Model_English,
    jsonb_extract_path(model, 'ru' )as Model_Russian,

'2023-08-16 15:35:50'::timestamp as dbt_time

from flights_demo.stg.aircrafts_data ad 
join flights_demo.stg.seats s 
	on s.aircraft_code = ad.aircraft_code
  );
  
  
[0m18:35:51.464191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:51.559970 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m18:35:51.567915 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:35:51.568913 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: BEGIN
[0m18:35:51.570906 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:51.571906 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:35:51.572903 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft__dbt_tmp183551457226'
        
      order by ordinal_position

  
[0m18:35:51.586869 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:35:51.595838 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:35:51.596837 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:35:51.600824 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:35:51.604815 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:35:51.604815 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:35:51.609803 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:35:51.616782 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_aircraft"
[0m18:35:51.620773 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:35:51.620773 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      insert into "flights_demo"."flights_wh"."Dim_aircraft" ("dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time")
    (
        select "dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time"
        from "Dim_aircraft__dbt_tmp183551457226"
    )


  
[0m18:35:51.628752 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m18:35:51.630745 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:35:51.631744 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:35:51.631744 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:35:51.633738 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:51.635745 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (execute): 18:35:51.454258 => 18:35:51.635745
[0m18:35:51.636732 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: Close
[0m18:35:51.638726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b32f0acd-2855-4544-87ba-c237d13d8c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBE9A50D10>]}
[0m18:35:51.640721 [info ] [Thread-1 (]: 2 of 6 OK created sql incremental model flights_wh.Dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.19s]
[0m18:35:51.644743 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_aircraft
[0m18:35:51.645730 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_boarding_passes
[0m18:35:51.646706 [info ] [Thread-1 (]: 3 of 6 START sql incremental model flights_wh.Fact_boarding_passes ............. [RUN]
[0m18:35:51.649697 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_aircraft, now model.flights_dbt.Fact_boarding_passes)
[0m18:35:51.650694 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_boarding_passes
[0m18:35:51.655679 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_boarding_passes"
[0m18:35:51.661668 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_boarding_passes (compile): 18:35:51.651729 => 18:35:51.660687
[0m18:35:51.662659 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_boarding_passes
[0m18:35:51.669677 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:35:51.670658 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

    
  
    

  create temporary table "Fact_boarding_passes__dbt_tmp183551665686"
  
  
    as
  
  (
    

select 
    bp.ticket_no,
    bp.flight_id,
    bp.boarding_no,
    bp.seat_no,
    bp.last_update,

    tf.fare_conditions,
    tf.amount,

'2023-08-16 15:35:50'::timestamp as dbt_time

from flights_demo.stg.ticket_flights tf 
join flights_demo.stg.boarding_passes bp 
	on tf.ticket_no = bp.ticket_no 
	and tf.flight_id =bp.flight_id
  );
  
  
[0m18:35:51.671636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:55.031325 [debug] [Thread-1 (]: SQL status: SELECT 579686 in 3.0 seconds
[0m18:35:55.040304 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:35:55.041301 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: BEGIN
[0m18:35:55.042298 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:55.044292 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:35:55.045291 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Fact_boarding_passes__dbt_tmp183551665686'
        
      order by ordinal_position

  
[0m18:35:55.073214 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m18:35:55.078203 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:35:55.080196 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_boarding_passes'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:35:55.087187 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m18:35:55.096153 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:35:55.097153 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_boarding_passes'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:35:55.106123 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m18:35:55.111111 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_boarding_passes"
[0m18:35:55.113105 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:35:55.113105 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      
        
            delete from "flights_demo"."flights_wh"."Fact_boarding_passes"
            where (
                ticket_no) in (
                select (ticket_no)
                from "Fact_boarding_passes__dbt_tmp183551665686"
            );

        
    

    insert into "flights_demo"."flights_wh"."Fact_boarding_passes" ("ticket_no", "flight_id", "boarding_no", "seat_no", "last_update", "fare_conditions", "amount", "dbt_time")
    (
        select "ticket_no", "flight_id", "boarding_no", "seat_no", "last_update", "fare_conditions", "amount", "dbt_time"
        from "Fact_boarding_passes__dbt_tmp183551665686"
    )
  
[0m18:35:58.556298 [debug] [Thread-1 (]: SQL status: INSERT 0 579686 in 3.0 seconds
[0m18:35:58.561283 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: COMMIT
[0m18:35:58.562281 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:35:58.563278 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: COMMIT
[0m18:35:58.574249 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:58.577242 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_boarding_passes (execute): 18:35:51.663659 => 18:35:58.576243
[0m18:35:58.578239 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: Close
[0m18:35:58.581232 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b32f0acd-2855-4544-87ba-c237d13d8c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBE9C9DF90>]}
[0m18:35:58.583224 [info ] [Thread-1 (]: 3 of 6 OK created sql incremental model flights_wh.Fact_boarding_passes ........ [[32mINSERT 0 579686[0m in 6.93s]
[0m18:35:58.586217 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_boarding_passes
[0m18:35:58.586217 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_flights
[0m18:35:58.588246 [info ] [Thread-1 (]: 4 of 6 START sql incremental model flights_wh.Fact_flights ..................... [RUN]
[0m18:35:58.591206 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_boarding_passes, now model.flights_dbt.Fact_flights)
[0m18:35:58.592220 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_flights
[0m18:35:58.597236 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_flights"
[0m18:35:58.602189 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (compile): 18:35:58.593198 => 18:35:58.601178
[0m18:35:58.605169 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_flights
[0m18:35:58.614144 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:35:58.616141 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

    
  
    

  create temporary table "Fact_flights__dbt_tmp183558610155"
  
  
    as
  
  (
    

with dim_flight_mod as (	
			select *,
			extract(day from (scheduled_arrival - scheduled_departure)*24) + extract(hour from (scheduled_arrival - scheduled_departure)) as flight_duration_expected,
			extract(day from (actual_arrival - actual_departure)*24) + extract(hour from (actual_arrival - actual_departure)) as duration_actual_hours
			from flights_demo.stg.flights f 
			)
select *,
    case 	when duration_actual_hours > flight_duration_expected 
                then 'Longer'
            when duration_actual_hours < flight_duration_expected 
                then 'Shorter'
            when duration_actual_hours = flight_duration_expected 
                then 'As Expected'
            else null
            end as flight_duration_case,

'2023-08-16 15:35:50'::timestamp as dbt_time

from dim_flight_mod
  );
  
  
[0m18:35:58.620146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:59.035748 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m18:35:59.040737 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:35:59.041733 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: BEGIN
[0m18:35:59.042700 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:59.043727 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:35:59.044692 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights__dbt_tmp183558610155'
        
      order by ordinal_position

  
[0m18:35:59.067655 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:35:59.072644 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:35:59.073634 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:35:59.079598 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:35:59.085502 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:35:59.086492 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:35:59.091475 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:35:59.095503 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_flights"
[0m18:35:59.096499 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:35:59.097459 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      
        
            delete from "flights_demo"."flights_wh"."Fact_flights"
            where (
                flight_id) in (
                select (flight_id)
                from "Fact_flights__dbt_tmp183558610155"
            );

        
    

    insert into "flights_demo"."flights_wh"."Fact_flights" ("flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time")
    (
        select "flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time"
        from "Fact_flights__dbt_tmp183558610155"
    )
  
[0m18:35:59.248056 [debug] [Thread-1 (]: SQL status: INSERT 0 33121 in 0.0 seconds
[0m18:35:59.251050 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:35:59.252047 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:35:59.253044 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:35:59.265015 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:59.267035 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (execute): 18:35:58.607164 => 18:35:59.267035
[0m18:35:59.268003 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: Close
[0m18:35:59.269002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b32f0acd-2855-4544-87ba-c237d13d8c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBE9CAE990>]}
[0m18:35:59.270001 [info ] [Thread-1 (]: 4 of 6 OK created sql incremental model flights_wh.Fact_flights ................ [[32mINSERT 0 33121[0m in 0.68s]
[0m18:35:59.271994 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_flights
[0m18:35:59.272990 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m18:35:59.274984 [info ] [Thread-1 (]: 5 of 6 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m18:35:59.276980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_flights, now model.flights_dbt.my_first_dbt_model)
[0m18:35:59.276980 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m18:35:59.280970 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m18:35:59.282968 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 18:35:59.277977 => 18:35:59.281968
[0m18:35:59.283968 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m18:35:59.323318 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m18:35:59.327308 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:35:59.328306 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m18:35:59.329299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:59.393673 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:59.395663 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:35:59.396657 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:35:59.407629 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:35:59.423587 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:35:59.425583 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:35:59.429572 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:59.435553 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:35:59.436553 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:35:59.439543 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:59.448522 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:35:59.450522 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:35:59.452511 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:35:59.456500 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:59.466471 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:35:59.467471 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:35:59.472456 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:35:59.475449 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 18:35:59.283968 => 18:35:59.475449
[0m18:35:59.476447 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m18:35:59.479439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b32f0acd-2855-4544-87ba-c237d13d8c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBE9B728D0>]}
[0m18:35:59.481434 [info ] [Thread-1 (]: 5 of 6 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.20s]
[0m18:35:59.483426 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m18:35:59.485422 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m18:35:59.486418 [info ] [Thread-1 (]: 6 of 6 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:35:59.488413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m18:35:59.490410 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m18:35:59.503378 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m18:35:59.507367 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 18:35:59.491409 => 18:35:59.506365
[0m18:35:59.508361 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m18:35:59.525316 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m18:35:59.529305 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:35:59.533297 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m18:35:59.536285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:35:59.625047 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:35:59.626046 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:35:59.627043 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_demo"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:35:59.635021 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:35:59.641008 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:35:59.643012 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:35:59.643999 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:35:59.647987 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:35:59.648984 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:35:59.649980 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:35:59.653969 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:35:59.657959 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:35:59.658958 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:35:59.662945 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:35:59.665938 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 18:35:59.510356 => 18:35:59.664942
[0m18:35:59.667935 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m18:35:59.671924 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b32f0acd-2855-4544-87ba-c237d13d8c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBE9A81390>]}
[0m18:35:59.672920 [info ] [Thread-1 (]: 6 of 6 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.18s]
[0m18:35:59.675915 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m18:35:59.679906 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:59.682896 [debug] [MainThread]: On master: BEGIN
[0m18:35:59.683893 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:35:59.768665 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:35:59.769662 [debug] [MainThread]: On master: COMMIT
[0m18:35:59.770658 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:59.770658 [debug] [MainThread]: On master: COMMIT
[0m18:35:59.771655 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:35:59.772653 [debug] [MainThread]: On master: Close
[0m18:35:59.773650 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:59.774648 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m18:35:59.775645 [debug] [MainThread]: Connection 'list_flights_demo_flights_wh' was properly closed.
[0m18:35:59.776642 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m18:35:59.779636 [info ] [MainThread]: 
[0m18:35:59.781631 [info ] [MainThread]: Finished running 4 incremental models, 2 view models in 0 hours 0 minutes and 9.19 seconds (9.19s).
[0m18:35:59.784621 [debug] [MainThread]: Command end result
[0m18:35:59.804570 [info ] [MainThread]: 
[0m18:35:59.807566 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:35:59.809555 [info ] [MainThread]: 
[0m18:35:59.812546 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:35:59.815542 [debug] [MainThread]: Command `dbt run` succeeded at 18:35:59.815542 after 9.68 seconds
[0m18:35:59.818534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBE2E7C850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBE906D350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBE906D810>]}
[0m18:35:59.819528 [debug] [MainThread]: Flushing usage events
[0m18:43:26.508486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD2272F110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD22659D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD22A32910>]}


============================== 18:43:26.516463 | a897bfa7-b1b8-4974-a125-9e250f12ef79 ==============================
[0m18:43:26.516463 [info ] [MainThread]: Running with dbt=1.5.3
[0m18:43:26.517462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:43:26.668058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a897bfa7-b1b8-4974-a125-9e250f12ef79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD225D8E10>]}
[0m18:43:26.700968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a897bfa7-b1b8-4974-a125-9e250f12ef79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD226F9910>]}
[0m18:43:26.702963 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m18:43:26.719944 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m18:43:26.900435 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:43:26.902431 [debug] [MainThread]: Partial parsing: added file: flights_dbt://models\Facts\Fact_tickets.sql
[0m18:43:26.935386 [debug] [MainThread]: 1603: static parser failed on Facts\Fact_tickets.sql
[0m18:43:26.960320 [debug] [MainThread]: 1602: parser fallback to jinja rendering on Facts\Fact_tickets.sql
[0m18:43:26.983260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a897bfa7-b1b8-4974-a125-9e250f12ef79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD229E0C90>]}
[0m18:43:26.997225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a897bfa7-b1b8-4974-a125-9e250f12ef79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD230EFDD0>]}
[0m18:43:26.999218 [info ] [MainThread]: Found 7 models, 10 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:43:27.001211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a897bfa7-b1b8-4974-a125-9e250f12ef79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD230AFA90>]}
[0m18:43:27.004203 [info ] [MainThread]: 
[0m18:43:27.008194 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:43:27.013181 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m18:43:27.039109 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m18:43:27.040106 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m18:43:27.041103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:27.136461 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m18:43:27.138456 [debug] [ThreadPool]: On list_flights_demo: Close
[0m18:43:27.141447 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo_flights_wh'
[0m18:43:27.150424 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:43:27.151422 [debug] [ThreadPool]: On list_flights_demo_flights_wh: BEGIN
[0m18:43:27.152420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:43:27.216009 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:43:27.217945 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:43:27.219938 [debug] [ThreadPool]: On list_flights_demo_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo_flights_wh"} */
select
      'flights_demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:43:27.235898 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:43:27.237891 [debug] [ThreadPool]: On list_flights_demo_flights_wh: ROLLBACK
[0m18:43:27.238891 [debug] [ThreadPool]: On list_flights_demo_flights_wh: Close
[0m18:43:27.245907 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:27.246900 [debug] [MainThread]: On master: BEGIN
[0m18:43:27.246900 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:43:27.408204 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:43:27.409202 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:27.411207 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:43:27.463252 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:43:27.465246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a897bfa7-b1b8-4974-a125-9e250f12ef79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD230EEC90>]}
[0m18:43:27.466244 [debug] [MainThread]: On master: ROLLBACK
[0m18:43:27.466244 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:27.467241 [debug] [MainThread]: On master: BEGIN
[0m18:43:27.468236 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:43:27.469234 [debug] [MainThread]: On master: COMMIT
[0m18:43:27.470232 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:27.470232 [debug] [MainThread]: On master: COMMIT
[0m18:43:27.471228 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:43:27.471228 [debug] [MainThread]: On master: Close
[0m18:43:27.473222 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:43:27.474222 [info ] [MainThread]: 
[0m18:43:27.489181 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_Airport
[0m18:43:27.490178 [info ] [Thread-1 (]: 1 of 7 START sql incremental model flights_wh.Dim_Airport ...................... [RUN]
[0m18:43:27.492172 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flights_dbt.Dim_Airport'
[0m18:43:27.493169 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_Airport
[0m18:43:27.502148 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_Airport"
[0m18:43:27.506138 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (compile): 18:43:27.494169 => 18:43:27.505145
[0m18:43:27.507137 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_Airport
[0m18:43:27.603906 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:43:27.604904 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

    
  
    

  create temporary table "Dim_Airport__dbt_tmp184327560990"
  
  
    as
  
  (
    

select *,
    jsonb_extract_path(airport_name, 'en' )as airport_name_eng, 
    jsonb_extract_path(city, 'en' )as city_eng,
    jsonb_extract_path(airport_name, 'ru' )as airport_name_rus,
    jsonb_extract_path(city, 'en' )as city_rus,

'2023-08-16 15:43:26'::timestamp as dbt_time

from stg.airports_data
  );
  
  
[0m18:43:27.604904 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:43:27.798444 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:43:27.807454 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:43:27.809447 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: BEGIN
[0m18:43:27.811410 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:27.812409 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:43:27.813405 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport__dbt_tmp184327560990'
        
      order by ordinal_position

  
[0m18:43:27.843330 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:43:27.853302 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:43:27.853302 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:43:27.859281 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:43:27.868257 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:43:27.869255 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:43:27.876239 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:43:27.905159 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_Airport"
[0m18:43:27.907156 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:43:27.909149 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      
        
            delete from "flights_demo"."flights_wh"."Dim_Airport"
            where (
                airport_code) in (
                select (airport_code)
                from "Dim_Airport__dbt_tmp184327560990"
            );

        
    

    insert into "flights_demo"."flights_wh"."Dim_Airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time"
        from "Dim_Airport__dbt_tmp184327560990"
    )
  
[0m18:43:27.921116 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m18:43:27.949044 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:43:27.951041 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:43:27.952034 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:43:27.956022 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:43:27.959016 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (execute): 18:43:27.508133 => 18:43:27.958017
[0m18:43:27.960012 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: Close
[0m18:43:27.962007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a897bfa7-b1b8-4974-a125-9e250f12ef79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD23053A10>]}
[0m18:43:27.963004 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model flights_wh.Dim_Airport ................. [[32mINSERT 0 104[0m in 0.47s]
[0m18:43:27.969987 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_Airport
[0m18:43:27.971981 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_aircraft
[0m18:43:27.972978 [info ] [Thread-1 (]: 2 of 7 START sql incremental model flights_wh.Dim_aircraft ..................... [RUN]
[0m18:43:27.975973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_Airport, now model.flights_dbt.Dim_aircraft)
[0m18:43:27.977964 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_aircraft
[0m18:43:27.998910 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_aircraft"
[0m18:43:28.001901 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (compile): 18:43:27.978962 => 18:43:28.001901
[0m18:43:28.003896 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_aircraft
[0m18:43:28.011873 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:43:28.012873 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

    
  
    

  create temporary table "Dim_aircraft__dbt_tmp184328007883"
  
  
    as
  
  (
    

select 
    row_number() over() as dim_aircraft_id,

    ad.aircraft_code,
    ad.model,
    ad.range,
    ad.last_update,

    s. seat_no,
    s.fare_conditions,

    case when range >= 5600 then 'High'
        when range < 5600 then 'Low'
        else 'Null'
        end as range_L_H,
    jsonb_extract_path(model, 'en' )as Model_English,
    jsonb_extract_path(model, 'ru' )as Model_Russian,

'2023-08-16 15:43:26'::timestamp as dbt_time

from flights_demo.stg.aircrafts_data ad 
join flights_demo.stg.seats s 
	on s.aircraft_code = ad.aircraft_code
  );
  
  
[0m18:43:28.015866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:43:28.104625 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m18:43:28.109613 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:43:28.110614 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: BEGIN
[0m18:43:28.112604 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:28.112604 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:43:28.113601 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft__dbt_tmp184328007883'
        
      order by ordinal_position

  
[0m18:43:28.131553 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:43:28.135542 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:43:28.136540 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:43:28.141526 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:43:28.147510 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:43:28.148510 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:43:28.154499 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:43:28.166491 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_aircraft"
[0m18:43:28.168456 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:43:28.169452 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      insert into "flights_demo"."flights_wh"."Dim_aircraft" ("dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time")
    (
        select "dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time"
        from "Dim_aircraft__dbt_tmp184328007883"
    )


  
[0m18:43:28.174439 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m18:43:28.176466 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:43:28.178428 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:43:28.179427 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:43:28.182418 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:43:28.184445 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (execute): 18:43:28.003896 => 18:43:28.184445
[0m18:43:28.185410 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: Close
[0m18:43:28.187407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a897bfa7-b1b8-4974-a125-9e250f12ef79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD23255E10>]}
[0m18:43:28.190398 [info ] [Thread-1 (]: 2 of 7 OK created sql incremental model flights_wh.Dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.21s]
[0m18:43:28.194385 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_aircraft
[0m18:43:28.195383 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_boarding_passes
[0m18:43:28.196380 [info ] [Thread-1 (]: 3 of 7 START sql incremental model flights_wh.Fact_boarding_passes ............. [RUN]
[0m18:43:28.198376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_aircraft, now model.flights_dbt.Fact_boarding_passes)
[0m18:43:28.199376 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_boarding_passes
[0m18:43:28.204359 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_boarding_passes"
[0m18:43:28.207353 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_boarding_passes (compile): 18:43:28.200369 => 18:43:28.206353
[0m18:43:28.208349 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_boarding_passes
[0m18:43:28.218322 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:43:28.219354 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

    
  
    

  create temporary table "Fact_boarding_passes__dbt_tmp184328213349"
  
  
    as
  
  (
    

select 
    bp.ticket_no,
    bp.flight_id,
    bp.boarding_no,
    bp.seat_no,
    bp.last_update,

    tf.fare_conditions,
    tf.amount,

'2023-08-16 15:43:26'::timestamp as dbt_time

from flights_demo.stg.ticket_flights tf 
join flights_demo.stg.boarding_passes bp 
	on tf.ticket_no = bp.ticket_no 
	and tf.flight_id =bp.flight_id
  );
  
  
[0m18:43:28.220316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:43:30.714714 [debug] [Thread-1 (]: SQL status: SELECT 579686 in 2.0 seconds
[0m18:43:30.718700 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:43:30.719696 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: BEGIN
[0m18:43:30.720693 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:30.721691 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:43:30.721691 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Fact_boarding_passes__dbt_tmp184328213349'
        
      order by ordinal_position

  
[0m18:43:30.742637 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m18:43:30.748621 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:43:30.748621 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_boarding_passes'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:43:30.753605 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m18:43:30.760588 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:43:30.761584 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_boarding_passes'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:43:30.766604 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m18:43:30.769563 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_boarding_passes"
[0m18:43:30.771558 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:43:30.772557 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      
        
            delete from "flights_demo"."flights_wh"."Fact_boarding_passes"
            where (
                ticket_no) in (
                select (ticket_no)
                from "Fact_boarding_passes__dbt_tmp184328213349"
            );

        
    

    insert into "flights_demo"."flights_wh"."Fact_boarding_passes" ("ticket_no", "flight_id", "boarding_no", "seat_no", "last_update", "fare_conditions", "amount", "dbt_time")
    (
        select "ticket_no", "flight_id", "boarding_no", "seat_no", "last_update", "fare_conditions", "amount", "dbt_time"
        from "Fact_boarding_passes__dbt_tmp184328213349"
    )
  
[0m18:43:36.597532 [debug] [Thread-1 (]: SQL status: INSERT 0 579686 in 6.0 seconds
[0m18:43:36.600523 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: COMMIT
[0m18:43:36.601523 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:43:36.601523 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: COMMIT
[0m18:43:36.613457 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:43:36.614454 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_boarding_passes (execute): 18:43:28.209382 => 18:43:36.614454
[0m18:43:36.615452 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: Close
[0m18:43:36.617452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a897bfa7-b1b8-4974-a125-9e250f12ef79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD2329D390>]}
[0m18:43:36.620444 [info ] [Thread-1 (]: 3 of 7 OK created sql incremental model flights_wh.Fact_boarding_passes ........ [[32mINSERT 0 579686[0m in 8.42s]
[0m18:43:36.623432 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_boarding_passes
[0m18:43:36.624428 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_flights
[0m18:43:36.625431 [info ] [Thread-1 (]: 4 of 7 START sql incremental model flights_wh.Fact_flights ..................... [RUN]
[0m18:43:36.627418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_boarding_passes, now model.flights_dbt.Fact_flights)
[0m18:43:36.628417 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_flights
[0m18:43:36.632405 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_flights"
[0m18:43:36.634400 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (compile): 18:43:36.629415 => 18:43:36.634400
[0m18:43:36.635397 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_flights
[0m18:43:36.642382 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:43:36.643379 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

    
  
    

  create temporary table "Fact_flights__dbt_tmp184336638394"
  
  
    as
  
  (
    

with dim_flight_mod as (	
			select *,
			extract(day from (scheduled_arrival - scheduled_departure)*24) + extract(hour from (scheduled_arrival - scheduled_departure)) as flight_duration_expected,
			extract(day from (actual_arrival - actual_departure)*24) + extract(hour from (actual_arrival - actual_departure)) as duration_actual_hours
			from flights_demo.stg.flights f 
			)
select *,
    case 	when duration_actual_hours > flight_duration_expected 
                then 'Longer'
            when duration_actual_hours < flight_duration_expected 
                then 'Shorter'
            when duration_actual_hours = flight_duration_expected 
                then 'As Expected'
            else null
            end as flight_duration_case,

'2023-08-16 15:43:26'::timestamp as dbt_time

from dim_flight_mod
  );
  
  
[0m18:43:36.644378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:43:36.870767 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m18:43:36.874791 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:43:36.875755 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: BEGIN
[0m18:43:36.876752 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:36.877749 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:43:36.877749 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights__dbt_tmp184336638394'
        
      order by ordinal_position

  
[0m18:43:36.897695 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:43:36.904679 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:43:36.905675 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:43:36.911659 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:43:36.915649 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:43:36.916681 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:43:36.920635 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:43:36.924656 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_flights"
[0m18:43:36.927691 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:43:36.928614 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      
        
            delete from "flights_demo"."flights_wh"."Fact_flights"
            where (
                flight_id) in (
                select (flight_id)
                from "Fact_flights__dbt_tmp184336638394"
            );

        
    

    insert into "flights_demo"."flights_wh"."Fact_flights" ("flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time")
    (
        select "flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time"
        from "Fact_flights__dbt_tmp184336638394"
    )
  
[0m18:43:37.097718 [debug] [Thread-1 (]: SQL status: INSERT 0 33121 in 0.0 seconds
[0m18:43:37.099714 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:43:37.100709 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:43:37.100709 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:43:37.114701 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:43:37.116675 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (execute): 18:43:36.635397 => 18:43:37.116675
[0m18:43:37.117696 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: Close
[0m18:43:37.119661 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a897bfa7-b1b8-4974-a125-9e250f12ef79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD23049C50>]}
[0m18:43:37.120657 [info ] [Thread-1 (]: 4 of 7 OK created sql incremental model flights_wh.Fact_flights ................ [[32mINSERT 0 33121[0m in 0.49s]
[0m18:43:37.122652 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_flights
[0m18:43:37.123678 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_tickets
[0m18:43:37.124647 [info ] [Thread-1 (]: 5 of 7 START sql incremental model flights_wh.Fact_tickets ..................... [RUN]
[0m18:43:37.125644 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_flights, now model.flights_dbt.Fact_tickets)
[0m18:43:37.126643 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_tickets
[0m18:43:37.129660 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_tickets"
[0m18:43:37.132625 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_tickets (compile): 18:43:37.126643 => 18:43:37.131627
[0m18:43:37.132625 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_tickets
[0m18:43:37.144600 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_tickets"
[0m18:43:37.146590 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m18:43:37.148602 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: BEGIN
[0m18:43:37.150580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:43:37.325133 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:37.326093 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m18:43:37.326093 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_tickets"} */

      
  
    

  create  table "flights_demo"."flights_wh"."Fact_tickets"
  
  
    as
  
  (
    

select *,
    jsonb_extract_path(contact_data, 'email' )as Email,
    jsonb_extract_path(contact_data, 'phone' )as Phone,

'2023-08-16 15:43:26'::timestamp as dbt_time

from bookings b 
join tickets t 
	on b.book_ref =t.book_ref
  );
  
  
[0m18:43:37.330082 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "bookings" does not exist
LINE 21: from bookings b 
              ^

[0m18:43:37.331106 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: ROLLBACK
[0m18:43:37.332104 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_tickets (execute): 18:43:37.133625 => 18:43:37.332104
[0m18:43:37.333099 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: Close
[0m18:43:37.344045 [debug] [Thread-1 (]: Database Error in model Fact_tickets (models\Facts\Fact_tickets.sql)
  relation "bookings" does not exist
  LINE 21: from bookings b 
                ^
  compiled Code at target\run\flights_dbt\models\Facts\Fact_tickets.sql
[0m18:43:37.344045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a897bfa7-b1b8-4974-a125-9e250f12ef79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD2315C910>]}
[0m18:43:37.345043 [error] [Thread-1 (]: 5 of 7 ERROR creating sql incremental model flights_wh.Fact_tickets ............ [[31mERROR[0m in 0.22s]
[0m18:43:37.347037 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_tickets
[0m18:43:37.348035 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m18:43:37.349032 [info ] [Thread-1 (]: 6 of 7 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m18:43:37.350029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_tickets, now model.flights_dbt.my_first_dbt_model)
[0m18:43:37.351026 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m18:43:37.355015 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m18:43:37.357010 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 18:43:37.351026 => 18:43:37.356013
[0m18:43:37.357010 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m18:43:37.384935 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m18:43:37.387931 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:43:37.388926 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m18:43:37.389924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:43:37.458400 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:37.460394 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:43:37.461391 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:43:37.482333 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:43:37.492307 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:43:37.493304 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:43:37.511180 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:43:37.515170 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:43:37.515170 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:43:37.521153 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:43:37.529152 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:43:37.530148 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:43:37.531128 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:43:37.539106 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:43:37.548082 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:43:37.549081 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:43:37.554066 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:43:37.557092 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 18:43:37.358008 => 18:43:37.556063
[0m18:43:37.558056 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m18:43:37.559053 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a897bfa7-b1b8-4974-a125-9e250f12ef79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD23151050>]}
[0m18:43:37.560049 [info ] [Thread-1 (]: 6 of 7 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.21s]
[0m18:43:37.561047 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m18:43:37.563042 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m18:43:37.564065 [info ] [Thread-1 (]: 7 of 7 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:43:37.565036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m18:43:37.566035 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m18:43:37.570024 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m18:43:37.572020 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 18:43:37.566035 => 18:43:37.572020
[0m18:43:37.573018 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m18:43:37.580029 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m18:43:37.581991 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:43:37.583018 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m18:43:37.583986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:43:37.764167 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:43:37.765163 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:43:37.766161 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_demo"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:43:37.775135 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:43:37.778127 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:43:37.779125 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:43:37.780122 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:43:37.782117 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:43:37.783113 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:43:37.783113 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:43:37.785108 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:43:37.789099 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:43:37.790096 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:43:37.792090 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:43:37.795086 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 18:43:37.574013 => 18:43:37.794085
[0m18:43:37.797078 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m18:43:37.799075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a897bfa7-b1b8-4974-a125-9e250f12ef79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD236FC850>]}
[0m18:43:37.801068 [info ] [Thread-1 (]: 7 of 7 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.23s]
[0m18:43:37.804059 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m18:43:37.808049 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:37.810046 [debug] [MainThread]: On master: BEGIN
[0m18:43:37.811041 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:43:37.891828 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:43:37.892823 [debug] [MainThread]: On master: COMMIT
[0m18:43:37.893820 [debug] [MainThread]: Using postgres connection "master"
[0m18:43:37.894819 [debug] [MainThread]: On master: COMMIT
[0m18:43:37.894819 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:43:37.895813 [debug] [MainThread]: On master: Close
[0m18:43:37.896811 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:43:37.897808 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m18:43:37.898808 [debug] [MainThread]: Connection 'list_flights_demo_flights_wh' was properly closed.
[0m18:43:37.899803 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m18:43:37.901796 [info ] [MainThread]: 
[0m18:43:37.903793 [info ] [MainThread]: Finished running 5 incremental models, 2 view models in 0 hours 0 minutes and 10.89 seconds (10.89s).
[0m18:43:37.907781 [debug] [MainThread]: Command end result
[0m18:43:37.916757 [info ] [MainThread]: 
[0m18:43:37.917754 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:43:37.919751 [info ] [MainThread]: 
[0m18:43:37.921745 [error] [MainThread]: [33mDatabase Error in model Fact_tickets (models\Facts\Fact_tickets.sql)[0m
[0m18:43:37.923741 [error] [MainThread]:   relation "bookings" does not exist
[0m18:43:37.924737 [error] [MainThread]:   LINE 21: from bookings b 
[0m18:43:37.925734 [error] [MainThread]:                 ^
[0m18:43:37.928726 [error] [MainThread]:   compiled Code at target\run\flights_dbt\models\Facts\Fact_tickets.sql
[0m18:43:37.931731 [info ] [MainThread]: 
[0m18:43:37.933713 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m18:43:37.938706 [debug] [MainThread]: Command `dbt run` failed at 18:43:37.937706 after 11.50 seconds
[0m18:43:37.942693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD205C6590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD22C7C290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD2272F450>]}
[0m18:43:37.944706 [debug] [MainThread]: Flushing usage events
[0m18:45:29.623306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A304A9FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A30084C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A304A9B50>]}


============================== 18:45:29.638264 | 081f2735-ff46-4e84-94b0-290467f08035 ==============================
[0m18:45:29.638264 [info ] [MainThread]: Running with dbt=1.5.3
[0m18:45:29.641254 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:45:29.820769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '081f2735-ff46-4e84-94b0-290467f08035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A3003CAD0>]}
[0m18:45:29.848698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '081f2735-ff46-4e84-94b0-290467f08035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A2FBF0F50>]}
[0m18:45:29.850693 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m18:45:29.872635 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m18:45:30.137924 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:45:30.142915 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models\Facts\Fact_tickets.sql
[0m18:45:30.206743 [debug] [MainThread]: 1603: static parser failed on Facts\Fact_tickets.sql
[0m18:45:30.253612 [debug] [MainThread]: 1602: parser fallback to jinja rendering on Facts\Fact_tickets.sql
[0m18:45:30.271568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '081f2735-ff46-4e84-94b0-290467f08035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A307F8390>]}
[0m18:45:30.293511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '081f2735-ff46-4e84-94b0-290467f08035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A307C2D90>]}
[0m18:45:30.294508 [info ] [MainThread]: Found 7 models, 10 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:45:30.295502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '081f2735-ff46-4e84-94b0-290467f08035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A2C4C32D0>]}
[0m18:45:30.299500 [info ] [MainThread]: 
[0m18:45:30.304477 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:45:30.310468 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m18:45:30.341386 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m18:45:30.343376 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m18:45:30.351353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:30.594724 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m18:45:30.599711 [debug] [ThreadPool]: On list_flights_demo: Close
[0m18:45:30.608261 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo_flights_wh'
[0m18:45:30.616237 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:45:30.617266 [debug] [ThreadPool]: On list_flights_demo_flights_wh: BEGIN
[0m18:45:30.618231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:45:30.739906 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:45:30.740904 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:45:30.741902 [debug] [ThreadPool]: On list_flights_demo_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo_flights_wh"} */
select
      'flights_demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:45:30.754868 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:45:30.756861 [debug] [ThreadPool]: On list_flights_demo_flights_wh: ROLLBACK
[0m18:45:30.758859 [debug] [ThreadPool]: On list_flights_demo_flights_wh: Close
[0m18:45:30.783788 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:30.784785 [debug] [MainThread]: On master: BEGIN
[0m18:45:30.784785 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:45:30.886515 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:45:30.887513 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:30.888509 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:45:30.949350 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:45:30.955336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '081f2735-ff46-4e84-94b0-290467f08035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A307D3710>]}
[0m18:45:30.957329 [debug] [MainThread]: On master: ROLLBACK
[0m18:45:30.960320 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:30.964327 [debug] [MainThread]: On master: BEGIN
[0m18:45:30.972284 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:45:30.973286 [debug] [MainThread]: On master: COMMIT
[0m18:45:30.974280 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:30.975278 [debug] [MainThread]: On master: COMMIT
[0m18:45:30.976276 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:45:30.977275 [debug] [MainThread]: On master: Close
[0m18:45:30.980263 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:45:30.984253 [info ] [MainThread]: 
[0m18:45:30.998237 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_Airport
[0m18:45:30.999218 [info ] [Thread-1 (]: 1 of 7 START sql incremental model flights_wh.Dim_Airport ...................... [RUN]
[0m18:45:31.001208 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flights_dbt.Dim_Airport'
[0m18:45:31.003239 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_Airport
[0m18:45:31.011084 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_Airport"
[0m18:45:31.018061 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (compile): 18:45:31.004203 => 18:45:31.015073
[0m18:45:31.022052 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_Airport
[0m18:45:31.236840 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:45:31.237837 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

    
  
    

  create temporary table "Dim_Airport__dbt_tmp184531116163"
  
  
    as
  
  (
    

select *,
    jsonb_extract_path(airport_name, 'en' )as airport_name_eng, 
    jsonb_extract_path(city, 'en' )as city_eng,
    jsonb_extract_path(airport_name, 'ru' )as airport_name_rus,
    jsonb_extract_path(city, 'en' )as city_rus,

'2023-08-16 15:45:29'::timestamp as dbt_time

from stg.airports_data
  );
  
  
[0m18:45:31.238856 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:45:31.355522 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:45:31.365493 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:45:31.367490 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: BEGIN
[0m18:45:31.371481 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:45:31.373477 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:45:31.374476 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport__dbt_tmp184531116163'
        
      order by ordinal_position

  
[0m18:45:31.405387 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:45:31.414397 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:45:31.415362 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:45:31.425336 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:45:31.438300 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:45:31.439297 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:45:31.444319 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:45:31.473206 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_Airport"
[0m18:45:31.475202 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:45:31.477196 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      
        
            delete from "flights_demo"."flights_wh"."Dim_Airport"
            where (
                airport_code) in (
                select (airport_code)
                from "Dim_Airport__dbt_tmp184531116163"
            );

        
    

    insert into "flights_demo"."flights_wh"."Dim_Airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time"
        from "Dim_Airport__dbt_tmp184531116163"
    )
  
[0m18:45:31.490162 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m18:45:31.531085 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:45:31.532049 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:45:31.532049 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:45:31.534044 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:45:31.536046 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (execute): 18:45:31.024045 => 18:45:31.536046
[0m18:45:31.537035 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: Close
[0m18:45:31.539033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '081f2735-ff46-4e84-94b0-290467f08035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A30978510>]}
[0m18:45:31.542027 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model flights_wh.Dim_Airport ................. [[32mINSERT 0 104[0m in 0.54s]
[0m18:45:31.545015 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_Airport
[0m18:45:31.547013 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_aircraft
[0m18:45:31.550004 [info ] [Thread-1 (]: 2 of 7 START sql incremental model flights_wh.Dim_aircraft ..................... [RUN]
[0m18:45:31.557981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_Airport, now model.flights_dbt.Dim_aircraft)
[0m18:45:31.560976 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_aircraft
[0m18:45:31.604858 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_aircraft"
[0m18:45:31.609844 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (compile): 18:45:31.562995 => 18:45:31.608848
[0m18:45:31.611860 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_aircraft
[0m18:45:31.628792 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:45:31.634780 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

    
  
    

  create temporary table "Dim_aircraft__dbt_tmp184531623804"
  
  
    as
  
  (
    

select 
    row_number() over() as dim_aircraft_id,

    ad.aircraft_code,
    ad.model,
    ad.range,
    ad.last_update,

    s. seat_no,
    s.fare_conditions,

    case when range >= 5600 then 'High'
        when range < 5600 then 'Low'
        else 'Null'
        end as range_L_H,
    jsonb_extract_path(model, 'en' )as Model_English,
    jsonb_extract_path(model, 'ru' )as Model_Russian,

'2023-08-16 15:45:29'::timestamp as dbt_time

from flights_demo.stg.aircrafts_data ad 
join flights_demo.stg.seats s 
	on s.aircraft_code = ad.aircraft_code
  );
  
  
[0m18:45:31.636773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:31.754453 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m18:45:31.768420 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:45:31.770416 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: BEGIN
[0m18:45:31.772410 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:45:31.773404 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:45:31.775398 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft__dbt_tmp184531623804'
        
      order by ordinal_position

  
[0m18:45:31.805318 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:45:31.811302 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:45:31.812299 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:45:31.820290 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:45:31.826262 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:45:31.827259 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:45:31.834245 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:45:31.856182 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_aircraft"
[0m18:45:31.857181 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:45:31.859176 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      insert into "flights_demo"."flights_wh"."Dim_aircraft" ("dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time")
    (
        select "dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time"
        from "Dim_aircraft__dbt_tmp184531623804"
    )


  
[0m18:45:31.865157 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m18:45:31.870145 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:45:31.875134 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:45:31.877130 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:45:31.883109 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:45:31.886102 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (execute): 18:45:31.612835 => 18:45:31.885105
[0m18:45:31.887100 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: Close
[0m18:45:31.890094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '081f2735-ff46-4e84-94b0-290467f08035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A3094E350>]}
[0m18:45:31.892087 [info ] [Thread-1 (]: 2 of 7 OK created sql incremental model flights_wh.Dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.34s]
[0m18:45:31.896077 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_aircraft
[0m18:45:31.898071 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_boarding_passes
[0m18:45:31.900069 [info ] [Thread-1 (]: 3 of 7 START sql incremental model flights_wh.Fact_boarding_passes ............. [RUN]
[0m18:45:31.904071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_aircraft, now model.flights_dbt.Fact_boarding_passes)
[0m18:45:31.906053 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_boarding_passes
[0m18:45:31.923005 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_boarding_passes"
[0m18:45:31.930001 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_boarding_passes (compile): 18:45:31.911039 => 18:45:31.927998
[0m18:45:31.932978 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_boarding_passes
[0m18:45:31.968884 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:45:31.973872 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

    
  
    

  create temporary table "Fact_boarding_passes__dbt_tmp184531940957"
  
  
    as
  
  (
    

select 
    bp.ticket_no,
    bp.flight_id,
    bp.boarding_no,
    bp.seat_no,
    bp.last_update,

    tf.fare_conditions,
    tf.amount,

'2023-08-16 15:45:29'::timestamp as dbt_time

from flights_demo.stg.ticket_flights tf 
join flights_demo.stg.boarding_passes bp 
	on tf.ticket_no = bp.ticket_no 
	and tf.flight_id =bp.flight_id
  );
  
  
[0m18:45:31.976863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:35.090776 [debug] [Thread-1 (]: SQL status: SELECT 579686 in 3.0 seconds
[0m18:45:35.102787 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:45:35.104749 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: BEGIN
[0m18:45:35.110726 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:45:35.115722 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:45:35.118707 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Fact_boarding_passes__dbt_tmp184531940957'
        
      order by ordinal_position

  
[0m18:45:35.158598 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m18:45:35.162584 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:45:35.163582 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_boarding_passes'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:45:35.168570 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m18:45:35.175558 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:45:35.177551 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_boarding_passes'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:45:35.191516 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m18:45:35.199500 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_boarding_passes"
[0m18:45:35.203486 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:45:35.204473 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      
        
            delete from "flights_demo"."flights_wh"."Fact_boarding_passes"
            where (
                ticket_no) in (
                select (ticket_no)
                from "Fact_boarding_passes__dbt_tmp184531940957"
            );

        
    

    insert into "flights_demo"."flights_wh"."Fact_boarding_passes" ("ticket_no", "flight_id", "boarding_no", "seat_no", "last_update", "fare_conditions", "amount", "dbt_time")
    (
        select "ticket_no", "flight_id", "boarding_no", "seat_no", "last_update", "fare_conditions", "amount", "dbt_time"
        from "Fact_boarding_passes__dbt_tmp184531940957"
    )
  
[0m18:45:40.205241 [debug] [Thread-1 (]: SQL status: INSERT 0 579686 in 5.0 seconds
[0m18:45:40.215213 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: COMMIT
[0m18:45:40.217205 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:45:40.218206 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: COMMIT
[0m18:45:40.232165 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:45:40.233162 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_boarding_passes (execute): 18:45:31.933975 => 18:45:40.233162
[0m18:45:40.234192 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: Close
[0m18:45:40.235157 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '081f2735-ff46-4e84-94b0-290467f08035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A307DEB90>]}
[0m18:45:40.236155 [info ] [Thread-1 (]: 3 of 7 OK created sql incremental model flights_wh.Fact_boarding_passes ........ [[32mINSERT 0 579686[0m in 8.33s]
[0m18:45:40.239146 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_boarding_passes
[0m18:45:40.240147 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_flights
[0m18:45:40.241141 [info ] [Thread-1 (]: 4 of 7 START sql incremental model flights_wh.Fact_flights ..................... [RUN]
[0m18:45:40.244133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_boarding_passes, now model.flights_dbt.Fact_flights)
[0m18:45:40.246133 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_flights
[0m18:45:40.256105 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_flights"
[0m18:45:40.268073 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (compile): 18:45:40.248124 => 18:45:40.267079
[0m18:45:40.273060 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_flights
[0m18:45:40.317940 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:45:40.326927 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

    
  
    

  create temporary table "Fact_flights__dbt_tmp184540287019"
  
  
    as
  
  (
    

with dim_flight_mod as (	
			select *,
			extract(day from (scheduled_arrival - scheduled_departure)*24) + extract(hour from (scheduled_arrival - scheduled_departure)) as flight_duration_expected,
			extract(day from (actual_arrival - actual_departure)*24) + extract(hour from (actual_arrival - actual_departure)) as duration_actual_hours
			from flights_demo.stg.flights f 
			)
select *,
    case 	when duration_actual_hours > flight_duration_expected 
                then 'Longer'
            when duration_actual_hours < flight_duration_expected 
                then 'Shorter'
            when duration_actual_hours = flight_duration_expected 
                then 'As Expected'
            else null
            end as flight_duration_case,

'2023-08-16 15:45:29'::timestamp as dbt_time

from dim_flight_mod
  );
  
  
[0m18:45:40.330902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:40.664551 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m18:45:40.672529 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:45:40.677515 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: BEGIN
[0m18:45:40.680507 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:45:40.682500 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:45:40.684492 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights__dbt_tmp184540287019'
        
      order by ordinal_position

  
[0m18:45:40.723411 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:45:40.739905 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:45:40.741900 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:45:40.754863 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:45:40.766829 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:45:40.768824 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:45:40.779795 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:45:40.787776 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_flights"
[0m18:45:40.791764 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:45:40.793759 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      
        
            delete from "flights_demo"."flights_wh"."Fact_flights"
            where (
                flight_id) in (
                select (flight_id)
                from "Fact_flights__dbt_tmp184540287019"
            );

        
    

    insert into "flights_demo"."flights_wh"."Fact_flights" ("flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time")
    (
        select "flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time"
        from "Fact_flights__dbt_tmp184540287019"
    )
  
[0m18:45:41.031123 [debug] [Thread-1 (]: SQL status: INSERT 0 33121 in 0.0 seconds
[0m18:45:41.034114 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:45:41.035112 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:45:41.038105 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:45:41.055097 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:45:41.057053 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (execute): 18:45:40.277047 => 18:45:41.057053
[0m18:45:41.059050 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: Close
[0m18:45:41.061044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '081f2735-ff46-4e84-94b0-290467f08035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A308BBB10>]}
[0m18:45:41.062039 [info ] [Thread-1 (]: 4 of 7 OK created sql incremental model flights_wh.Fact_flights ................ [[32mINSERT 0 33121[0m in 0.82s]
[0m18:45:41.067030 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_flights
[0m18:45:41.068024 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_tickets
[0m18:45:41.069022 [info ] [Thread-1 (]: 5 of 7 START sql incremental model flights_wh.Fact_tickets ..................... [RUN]
[0m18:45:41.071019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_flights, now model.flights_dbt.Fact_tickets)
[0m18:45:41.073012 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_tickets
[0m18:45:41.084982 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_tickets"
[0m18:45:41.090966 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_tickets (compile): 18:45:41.074007 => 18:45:41.088971
[0m18:45:41.093958 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_tickets
[0m18:45:41.119897 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_tickets"
[0m18:45:41.129861 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m18:45:41.131859 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: BEGIN
[0m18:45:41.132852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:41.335309 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:45:41.336307 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m18:45:41.339307 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_tickets"} */

      
  
    

  create  table "flights_demo"."flights_wh"."Fact_tickets"
  
  
    as
  
  (
    

select *,
    jsonb_extract_path(contact_data, 'email' )as Email,
    jsonb_extract_path(contact_data, 'phone' )as Phone,

'2023-08-16 15:45:29'::timestamp as dbt_time

from flights_demo.stg.bookings b 
join flights_demo.stg.tickets t
	on b.book_ref =t.book_ref
  );
  
  
[0m18:45:41.352263 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "book_ref" specified more than once

[0m18:45:41.353261 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: ROLLBACK
[0m18:45:41.354259 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_tickets (execute): 18:45:41.095952 => 18:45:41.354259
[0m18:45:41.355255 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: Close
[0m18:45:41.375216 [debug] [Thread-1 (]: Database Error in model Fact_tickets (models\Facts\Fact_tickets.sql)
  column "book_ref" specified more than once
  compiled Code at target\run\flights_dbt\models\Facts\Fact_tickets.sql
[0m18:45:41.379193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '081f2735-ff46-4e84-94b0-290467f08035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A309C6410>]}
[0m18:45:41.384182 [error] [Thread-1 (]: 5 of 7 ERROR creating sql incremental model flights_wh.Fact_tickets ............ [[31mERROR[0m in 0.31s]
[0m18:45:41.387173 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_tickets
[0m18:45:41.389166 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m18:45:41.390169 [info ] [Thread-1 (]: 6 of 7 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m18:45:41.392157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_tickets, now model.flights_dbt.my_first_dbt_model)
[0m18:45:41.393155 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m18:45:41.400140 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m18:45:41.406130 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 18:45:41.393155 => 18:45:41.403131
[0m18:45:41.408121 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m18:45:41.511845 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m18:45:41.513835 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:45:41.514833 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m18:45:41.516827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:41.607607 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:45:41.608580 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:45:41.609576 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:45:41.620550 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:45:41.635038 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:45:41.636027 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:45:41.640013 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:45:41.645996 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:45:41.646994 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:45:41.648988 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:45:41.656969 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:45:41.657967 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:45:41.658971 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:45:41.662955 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:45:41.677911 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:45:41.677911 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:45:41.681900 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:45:41.684934 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 18:45:41.413107 => 18:45:41.684934
[0m18:45:41.685889 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m18:45:41.687886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '081f2735-ff46-4e84-94b0-290467f08035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A309A3350>]}
[0m18:45:41.688910 [info ] [Thread-1 (]: 6 of 7 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.30s]
[0m18:45:41.692911 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m18:45:41.693868 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m18:45:41.694899 [info ] [Thread-1 (]: 7 of 7 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:45:41.697865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m18:45:41.700858 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m18:45:41.709833 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m18:45:41.718806 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 18:45:41.701853 => 18:45:41.716816
[0m18:45:41.721801 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m18:45:41.733797 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m18:45:41.735757 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:45:41.736756 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m18:45:41.739749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:45:42.009025 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:45:42.011021 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:45:42.012017 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_demo"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:45:42.238921 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:45:42.252882 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:45:42.254877 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:45:42.270837 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:45:42.275821 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:45:42.277816 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:45:42.278814 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:45:42.313724 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:45:42.357268 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:45:42.363255 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:45:42.368241 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:45:42.376217 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 18:45:41.724789 => 18:45:42.376217
[0m18:45:42.380221 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m18:45:42.390181 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '081f2735-ff46-4e84-94b0-290467f08035', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A30E00050>]}
[0m18:45:42.394171 [info ] [Thread-1 (]: 7 of 7 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.69s]
[0m18:45:42.400156 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m18:45:42.412122 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:42.415129 [debug] [MainThread]: On master: BEGIN
[0m18:45:42.420101 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:45:42.624758 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:45:42.628731 [debug] [MainThread]: On master: COMMIT
[0m18:45:42.629725 [debug] [MainThread]: Using postgres connection "master"
[0m18:45:42.631719 [debug] [MainThread]: On master: COMMIT
[0m18:45:42.634712 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:45:42.637704 [debug] [MainThread]: On master: Close
[0m18:45:42.643689 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:45:42.650668 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m18:45:42.652664 [debug] [MainThread]: Connection 'list_flights_demo_flights_wh' was properly closed.
[0m18:45:42.654658 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m18:45:42.659644 [info ] [MainThread]: 
[0m18:45:42.662635 [info ] [MainThread]: Finished running 5 incremental models, 2 view models in 0 hours 0 minutes and 12.35 seconds (12.35s).
[0m18:45:42.675606 [debug] [MainThread]: Command end result
[0m18:45:42.739435 [info ] [MainThread]: 
[0m18:45:42.745417 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:45:42.750407 [info ] [MainThread]: 
[0m18:45:42.756427 [error] [MainThread]: [33mDatabase Error in model Fact_tickets (models\Facts\Fact_tickets.sql)[0m
[0m18:45:42.764369 [error] [MainThread]:   column "book_ref" specified more than once
[0m18:45:42.782317 [error] [MainThread]:   compiled Code at target\run\flights_dbt\models\Facts\Fact_tickets.sql
[0m18:45:42.793294 [info ] [MainThread]: 
[0m18:45:42.797277 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m18:45:42.813236 [debug] [MainThread]: Command `dbt run` failed at 18:45:42.812240 after 13.25 seconds
[0m18:45:42.816232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A30085310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A2FAA3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A2FDF3E90>]}
[0m18:45:42.822212 [debug] [MainThread]: Flushing usage events
[0m18:49:41.226302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E23FD150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E2772650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E26AAF90>]}


============================== 18:49:41.234282 | dab2bb85-148d-4ec0-bb0f-4ccba2dbd8a4 ==============================
[0m18:49:41.234282 [info ] [MainThread]: Running with dbt=1.5.3
[0m18:49:41.236277 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:49:41.411815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dab2bb85-148d-4ec0-bb0f-4ccba2dbd8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E21715D0>]}
[0m18:49:41.439746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dab2bb85-148d-4ec0-bb0f-4ccba2dbd8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E2E18650>]}
[0m18:49:41.443734 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m18:49:41.500583 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m18:49:41.849936 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:49:41.850933 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models\Facts\Fact_tickets.sql
[0m18:49:41.894819 [debug] [MainThread]: 1603: static parser failed on Facts\Fact_tickets.sql
[0m18:49:41.922742 [debug] [MainThread]: 1602: parser fallback to jinja rendering on Facts\Fact_tickets.sql
[0m18:49:41.940696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dab2bb85-148d-4ec0-bb0f-4ccba2dbd8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E23E86D0>]}
[0m18:49:41.953658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dab2bb85-148d-4ec0-bb0f-4ccba2dbd8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E2F0B450>]}
[0m18:49:41.954657 [info ] [MainThread]: Found 7 models, 10 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:49:41.956655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dab2bb85-148d-4ec0-bb0f-4ccba2dbd8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236DEB53090>]}
[0m18:49:41.960650 [info ] [MainThread]: 
[0m18:49:41.963633 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:49:41.972611 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m18:49:42.011508 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m18:49:42.016495 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m18:49:42.020482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:42.289759 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m18:49:42.292753 [debug] [ThreadPool]: On list_flights_demo: Close
[0m18:49:42.296743 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo_flights_wh'
[0m18:49:42.307716 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:49:42.308716 [debug] [ThreadPool]: On list_flights_demo_flights_wh: BEGIN
[0m18:49:42.309708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:42.488809 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:49:42.489774 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:49:42.490771 [debug] [ThreadPool]: On list_flights_demo_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo_flights_wh"} */
select
      'flights_demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:49:42.503761 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m18:49:42.505732 [debug] [ThreadPool]: On list_flights_demo_flights_wh: ROLLBACK
[0m18:49:42.506729 [debug] [ThreadPool]: On list_flights_demo_flights_wh: Close
[0m18:49:42.524711 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:42.525675 [debug] [MainThread]: On master: BEGIN
[0m18:49:42.525675 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:49:42.611976 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:49:42.611976 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:42.612970 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:49:42.672809 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:49:42.675803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dab2bb85-148d-4ec0-bb0f-4ccba2dbd8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E2486E50>]}
[0m18:49:42.676801 [debug] [MainThread]: On master: ROLLBACK
[0m18:49:42.677798 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:42.679794 [debug] [MainThread]: On master: BEGIN
[0m18:49:42.680789 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:49:42.681787 [debug] [MainThread]: On master: COMMIT
[0m18:49:42.682790 [debug] [MainThread]: Using postgres connection "master"
[0m18:49:42.682790 [debug] [MainThread]: On master: COMMIT
[0m18:49:42.683784 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:49:42.685876 [debug] [MainThread]: On master: Close
[0m18:49:42.692857 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:49:42.695849 [info ] [MainThread]: 
[0m18:49:42.720784 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_Airport
[0m18:49:42.721777 [info ] [Thread-1 (]: 1 of 7 START sql incremental model flights_wh.Dim_Airport ...................... [RUN]
[0m18:49:42.723772 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flights_dbt.Dim_Airport'
[0m18:49:42.724769 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_Airport
[0m18:49:42.734747 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_Airport"
[0m18:49:42.740731 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (compile): 18:49:42.725766 => 18:49:42.738735
[0m18:49:42.743725 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_Airport
[0m18:49:42.974101 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:49:42.975099 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

    
  
    

  create temporary table "Dim_Airport__dbt_tmp184942903292"
  
  
    as
  
  (
    

select *,
    jsonb_extract_path(airport_name, 'en' )as airport_name_eng, 
    jsonb_extract_path(city, 'en' )as city_eng,
    jsonb_extract_path(airport_name, 'ru' )as airport_name_rus,
    jsonb_extract_path(city, 'en' )as city_rus,

'2023-08-16 15:49:41'::timestamp as dbt_time

from stg.airports_data
  );
  
  
[0m18:49:42.975099 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:49:43.100584 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:49:43.117539 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:49:43.118535 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: BEGIN
[0m18:49:43.119532 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:49:43.120530 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:49:43.121528 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport__dbt_tmp184942903292'
        
      order by ordinal_position

  
[0m18:49:43.174386 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:49:43.185357 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:49:43.186375 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:49:43.197338 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:49:43.224270 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:49:43.226255 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:49:43.232237 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:49:43.276123 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_Airport"
[0m18:49:43.280112 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:49:43.284103 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      
        
            delete from "flights_demo"."flights_wh"."Dim_Airport"
            where (
                airport_code) in (
                select (airport_code)
                from "Dim_Airport__dbt_tmp184942903292"
            );

        
    

    insert into "flights_demo"."flights_wh"."Dim_Airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time"
        from "Dim_Airport__dbt_tmp184942903292"
    )
  
[0m18:49:43.292077 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m18:49:43.333981 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:49:43.338964 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:49:43.341949 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:49:43.346938 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:49:43.352924 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (execute): 18:49:42.745714 => 18:49:43.349951
[0m18:49:43.355944 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: Close
[0m18:49:43.358903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dab2bb85-148d-4ec0-bb0f-4ccba2dbd8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E24BFE10>]}
[0m18:49:43.359897 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model flights_wh.Dim_Airport ................. [[32mINSERT 0 104[0m in 0.63s]
[0m18:49:43.363890 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_Airport
[0m18:49:43.364885 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_aircraft
[0m18:49:43.365884 [info ] [Thread-1 (]: 2 of 7 START sql incremental model flights_wh.Dim_aircraft ..................... [RUN]
[0m18:49:43.368874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_Airport, now model.flights_dbt.Dim_aircraft)
[0m18:49:43.369871 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_aircraft
[0m18:49:43.382838 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_aircraft"
[0m18:49:43.384832 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (compile): 18:49:43.370872 => 18:49:43.384832
[0m18:49:43.385828 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_aircraft
[0m18:49:43.395819 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:49:43.399792 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

    
  
    

  create temporary table "Dim_aircraft__dbt_tmp184943389817"
  
  
    as
  
  (
    

select 
    row_number() over() as dim_aircraft_id,

    ad.aircraft_code,
    ad.model,
    ad.range,
    ad.last_update,

    s. seat_no,
    s.fare_conditions,

    case when range >= 5600 then 'High'
        when range < 5600 then 'Low'
        else 'Null'
        end as range_L_H,
    jsonb_extract_path(model, 'en' )as Model_English,
    jsonb_extract_path(model, 'ru' )as Model_Russian,

'2023-08-16 15:49:41'::timestamp as dbt_time

from flights_demo.stg.aircrafts_data ad 
join flights_demo.stg.seats s 
	on s.aircraft_code = ad.aircraft_code
  );
  
  
[0m18:49:43.400790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:49:43.519472 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m18:49:43.525454 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:49:43.526454 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: BEGIN
[0m18:49:43.527450 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:49:43.528447 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:49:43.529444 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft__dbt_tmp184943389817'
        
      order by ordinal_position

  
[0m18:49:43.575320 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:49:43.587291 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:49:43.591302 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:49:43.610248 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:49:43.620201 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:49:43.621198 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:49:43.631171 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:49:43.661094 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_aircraft"
[0m18:49:43.669073 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:49:43.671067 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      insert into "flights_demo"."flights_wh"."Dim_aircraft" ("dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time")
    (
        select "dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time"
        from "Dim_aircraft__dbt_tmp184943389817"
    )


  
[0m18:49:43.683037 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m18:49:43.693008 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:49:43.695001 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:49:43.696011 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:49:43.699988 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:49:43.703977 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (execute): 18:49:43.386825 => 18:49:43.702980
[0m18:49:43.705972 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: Close
[0m18:49:43.712956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dab2bb85-148d-4ec0-bb0f-4ccba2dbd8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E2280A90>]}
[0m18:49:43.715948 [info ] [Thread-1 (]: 2 of 7 OK created sql incremental model flights_wh.Dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.34s]
[0m18:49:43.719937 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_aircraft
[0m18:49:43.721931 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_boarding_passes
[0m18:49:43.724926 [info ] [Thread-1 (]: 3 of 7 START sql incremental model flights_wh.Fact_boarding_passes ............. [RUN]
[0m18:49:43.732914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_aircraft, now model.flights_dbt.Fact_boarding_passes)
[0m18:49:43.735895 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_boarding_passes
[0m18:49:43.744871 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_boarding_passes"
[0m18:49:43.749861 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_boarding_passes (compile): 18:49:43.737894 => 18:49:43.747863
[0m18:49:43.752868 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_boarding_passes
[0m18:49:43.763817 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:49:43.768813 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

    
  
    

  create temporary table "Fact_boarding_passes__dbt_tmp184943756837"
  
  
    as
  
  (
    

select 
    bp.ticket_no,
    bp.flight_id,
    bp.boarding_no,
    bp.seat_no,
    bp.last_update,

    tf.fare_conditions,
    tf.amount,

'2023-08-16 15:49:41'::timestamp as dbt_time

from flights_demo.stg.ticket_flights tf 
join flights_demo.stg.boarding_passes bp 
	on tf.ticket_no = bp.ticket_no 
	and tf.flight_id =bp.flight_id
  );
  
  
[0m18:49:43.771800 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:49:47.271965 [debug] [Thread-1 (]: SQL status: SELECT 579686 in 4.0 seconds
[0m18:49:47.279909 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:49:47.280906 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: BEGIN
[0m18:49:47.283901 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:49:47.284931 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:49:47.286891 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Fact_boarding_passes__dbt_tmp184943756837'
        
      order by ordinal_position

  
[0m18:49:47.328789 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m18:49:47.334763 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:49:47.340786 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_boarding_passes'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:49:47.353713 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m18:49:47.362689 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:49:47.363699 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_boarding_passes'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:49:47.368705 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m18:49:47.373658 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_boarding_passes"
[0m18:49:47.374655 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:49:47.375653 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      
        
            delete from "flights_demo"."flights_wh"."Fact_boarding_passes"
            where (
                ticket_no) in (
                select (ticket_no)
                from "Fact_boarding_passes__dbt_tmp184943756837"
            );

        
    

    insert into "flights_demo"."flights_wh"."Fact_boarding_passes" ("ticket_no", "flight_id", "boarding_no", "seat_no", "last_update", "fare_conditions", "amount", "dbt_time")
    (
        select "ticket_no", "flight_id", "boarding_no", "seat_no", "last_update", "fare_conditions", "amount", "dbt_time"
        from "Fact_boarding_passes__dbt_tmp184943756837"
    )
  
[0m18:49:53.636080 [debug] [Thread-1 (]: SQL status: INSERT 0 579686 in 6.0 seconds
[0m18:49:53.645054 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: COMMIT
[0m18:49:53.647049 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:49:53.649045 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: COMMIT
[0m18:49:53.674977 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:49:53.677966 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_boarding_passes (execute): 18:49:43.753845 => 18:49:53.677966
[0m18:49:53.678964 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: Close
[0m18:49:53.681956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dab2bb85-148d-4ec0-bb0f-4ccba2dbd8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E2FA2490>]}
[0m18:49:53.683950 [info ] [Thread-1 (]: 3 of 7 OK created sql incremental model flights_wh.Fact_boarding_passes ........ [[32mINSERT 0 579686[0m in 9.95s]
[0m18:49:53.687939 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_boarding_passes
[0m18:49:53.689934 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_flights
[0m18:49:53.690932 [info ] [Thread-1 (]: 4 of 7 START sql incremental model flights_wh.Fact_flights ..................... [RUN]
[0m18:49:53.694923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_boarding_passes, now model.flights_dbt.Fact_flights)
[0m18:49:53.697919 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_flights
[0m18:49:53.717862 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_flights"
[0m18:49:53.725839 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (compile): 18:49:53.700906 => 18:49:53.723847
[0m18:49:53.729831 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_flights
[0m18:49:53.766728 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:49:53.769722 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

    
  
    

  create temporary table "Fact_flights__dbt_tmp184953742797"
  
  
    as
  
  (
    

with dim_flight_mod as (	
			select *,
			extract(day from (scheduled_arrival - scheduled_departure)*24) + extract(hour from (scheduled_arrival - scheduled_departure)) as flight_duration_expected,
			extract(day from (actual_arrival - actual_departure)*24) + extract(hour from (actual_arrival - actual_departure)) as duration_actual_hours
			from flights_demo.stg.flights f 
			)
select *,
    case 	when duration_actual_hours > flight_duration_expected 
                then 'Longer'
            when duration_actual_hours < flight_duration_expected 
                then 'Shorter'
            when duration_actual_hours = flight_duration_expected 
                then 'As Expected'
            else null
            end as flight_duration_case,

'2023-08-16 15:49:41'::timestamp as dbt_time

from dim_flight_mod
  );
  
  
[0m18:49:53.773723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:49:54.392385 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 1.0 seconds
[0m18:49:54.404355 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:49:54.407345 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: BEGIN
[0m18:49:54.410339 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:49:54.413348 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:49:54.415331 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights__dbt_tmp184953742797'
        
      order by ordinal_position

  
[0m18:49:54.463197 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:49:54.478156 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:49:54.480152 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:49:54.493120 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:49:54.511070 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:49:54.514062 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:49:54.534525 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:49:54.547488 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_flights"
[0m18:49:54.553472 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:49:54.555468 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      
        
            delete from "flights_demo"."flights_wh"."Fact_flights"
            where (
                flight_id) in (
                select (flight_id)
                from "Fact_flights__dbt_tmp184953742797"
            );

        
    

    insert into "flights_demo"."flights_wh"."Fact_flights" ("flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time")
    (
        select "flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time"
        from "Fact_flights__dbt_tmp184953742797"
    )
  
[0m18:49:54.964372 [debug] [Thread-1 (]: SQL status: INSERT 0 33121 in 0.0 seconds
[0m18:49:54.969362 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:49:54.970357 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:49:54.971354 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:49:54.986314 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:49:54.990304 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (execute): 18:49:53.731828 => 18:49:54.989306
[0m18:49:54.991301 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: Close
[0m18:49:54.997289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dab2bb85-148d-4ec0-bb0f-4ccba2dbd8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E3056350>]}
[0m18:49:55.001275 [info ] [Thread-1 (]: 4 of 7 OK created sql incremental model flights_wh.Fact_flights ................ [[32mINSERT 0 33121[0m in 1.30s]
[0m18:49:55.006259 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_flights
[0m18:49:55.007258 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_tickets
[0m18:49:55.008257 [info ] [Thread-1 (]: 5 of 7 START sql incremental model flights_wh.Fact_tickets ..................... [RUN]
[0m18:49:55.012250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_flights, now model.flights_dbt.Fact_tickets)
[0m18:49:55.014242 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_tickets
[0m18:49:55.034189 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_tickets"
[0m18:49:55.041172 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_tickets (compile): 18:49:55.015238 => 18:49:55.040174
[0m18:49:55.043162 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_tickets
[0m18:49:55.073085 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_tickets"
[0m18:49:55.083057 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m18:49:55.089043 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: BEGIN
[0m18:49:55.105002 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:49:55.259587 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:49:55.261578 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m18:49:55.262576 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_tickets"} */

      
  
    

  create  table "flights_demo"."flights_wh"."Fact_tickets"
  
  
    as
  
  (
    

select 
    b.book_ref,
    b.book_date,
    b.total_amount,

    t.ticket_no,
    t.passenger_id,
    t.passenger_name,
    t.contact_data,
    t.last_update,

    jsonb_extract_path(contact_data, 'email' )as Email,
    jsonb_extract_path(contact_data, 'phone' )as Phone,

'2023-08-16 15:49:41'::timestamp as dbt_time

from flights_demo.stg.bookings b 
join flights_demo.stg.tickets t
	on b.book_ref =t.book_ref
  );
  
  
[0m18:49:59.363244 [debug] [Thread-1 (]: SQL status: SELECT 366733 in 4.0 seconds
[0m18:49:59.372253 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: COMMIT
[0m18:49:59.373254 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m18:49:59.374249 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: COMMIT
[0m18:49:59.392168 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:49:59.396160 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_tickets (execute): 18:49:55.043162 => 18:49:59.395162
[0m18:49:59.398150 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: Close
[0m18:49:59.400147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dab2bb85-148d-4ec0-bb0f-4ccba2dbd8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E306D190>]}
[0m18:49:59.401142 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model flights_wh.Fact_tickets ................ [[32mSELECT 366733[0m in 4.39s]
[0m18:49:59.404140 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_tickets
[0m18:49:59.405135 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m18:49:59.409123 [info ] [Thread-1 (]: 6 of 7 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m18:49:59.412114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_tickets, now model.flights_dbt.my_first_dbt_model)
[0m18:49:59.414142 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m18:49:59.418098 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m18:49:59.425138 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 18:49:59.414142 => 18:49:59.422089
[0m18:49:59.428075 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m18:49:59.522817 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m18:49:59.527816 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:49:59.530798 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m18:49:59.531795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:49:59.732257 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:49:59.734254 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:49:59.735252 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:49:59.755199 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:49:59.770156 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:49:59.771153 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:49:59.774144 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:49:59.778134 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:49:59.780134 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:49:59.781127 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:49:59.788110 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:49:59.790102 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:49:59.790102 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:49:59.795103 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:49:59.802071 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:49:59.803067 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:49:59.809054 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:49:59.815037 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 18:49:59.430070 => 18:49:59.814039
[0m18:49:59.817032 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m18:49:59.820025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dab2bb85-148d-4ec0-bb0f-4ccba2dbd8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E2FD4910>]}
[0m18:49:59.822020 [info ] [Thread-1 (]: 6 of 7 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.41s]
[0m18:49:59.826010 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m18:49:59.830995 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m18:49:59.832991 [info ] [Thread-1 (]: 7 of 7 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:49:59.839972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m18:49:59.843962 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m18:49:59.855927 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m18:49:59.859921 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 18:49:59.846958 => 18:49:59.858921
[0m18:49:59.860915 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m18:49:59.869892 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m18:49:59.871884 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:49:59.872880 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m18:49:59.872880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:49:59.965633 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:49:59.966631 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:49:59.967628 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_demo"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:49:59.974609 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:49:59.978598 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:49:59.980596 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:49:59.984585 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:49:59.989573 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:49:59.990567 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:49:59.991564 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:49:59.992561 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:49:59.997548 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:49:59.998545 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:49:59.999543 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:50:00.002534 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 18:49:59.860915 => 18:50:00.001538
[0m18:50:00.002534 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m18:50:00.003532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dab2bb85-148d-4ec0-bb0f-4ccba2dbd8a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E308D510>]}
[0m18:50:00.004529 [info ] [Thread-1 (]: 7 of 7 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.17s]
[0m18:50:00.008519 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m18:50:00.015503 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:00.018495 [debug] [MainThread]: On master: BEGIN
[0m18:50:00.022482 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:50:00.128198 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:50:00.129197 [debug] [MainThread]: On master: COMMIT
[0m18:50:00.130194 [debug] [MainThread]: Using postgres connection "master"
[0m18:50:00.130194 [debug] [MainThread]: On master: COMMIT
[0m18:50:00.131190 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:50:00.132188 [debug] [MainThread]: On master: Close
[0m18:50:00.133185 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:50:00.133185 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m18:50:00.134183 [debug] [MainThread]: Connection 'list_flights_demo_flights_wh' was properly closed.
[0m18:50:00.134183 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m18:50:00.136177 [info ] [MainThread]: 
[0m18:50:00.137176 [info ] [MainThread]: Finished running 5 incremental models, 2 view models in 0 hours 0 minutes and 18.17 seconds (18.17s).
[0m18:50:00.140166 [debug] [MainThread]: Command end result
[0m18:50:00.150143 [info ] [MainThread]: 
[0m18:50:00.152137 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:50:00.156125 [info ] [MainThread]: 
[0m18:50:00.159120 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m18:50:00.162111 [debug] [MainThread]: Command `dbt run` succeeded at 18:50:00.161113 after 19.03 seconds
[0m18:50:00.164114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E24BFDD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E05CD590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236DC23DFD0>]}
[0m18:50:00.166112 [debug] [MainThread]: Flushing usage events
[0m18:53:44.310259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016662DC2C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016662B59450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016663071A90>]}


============================== 18:53:44.318232 | 9920c69f-07af-43dd-98c4-683250f890f9 ==============================
[0m18:53:44.318232 [info ] [MainThread]: Running with dbt=1.5.3
[0m18:53:44.322225 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:53:44.724146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9920c69f-07af-43dd-98c4-683250f890f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016662ADDED0>]}
[0m18:53:44.750078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9920c69f-07af-43dd-98c4-683250f890f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016662ACC190>]}
[0m18:53:44.753073 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m18:53:44.777007 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m18:53:45.182406 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:53:45.183374 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models\Facts\schema.yml
[0m18:53:45.276200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9920c69f-07af-43dd-98c4-683250f890f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166634D1ED0>]}
[0m18:53:45.291133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9920c69f-07af-43dd-98c4-683250f890f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001666364AC10>]}
[0m18:53:45.292125 [info ] [MainThread]: Found 7 models, 12 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:53:45.294122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9920c69f-07af-43dd-98c4-683250f890f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001665F2232D0>]}
[0m18:53:45.297135 [info ] [MainThread]: 
[0m18:53:45.300104 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:53:45.304127 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m18:53:45.328029 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m18:53:45.329026 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m18:53:45.331021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:45.576366 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m18:53:45.579357 [debug] [ThreadPool]: On list_flights_demo: Close
[0m18:53:45.588334 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo_flights_wh'
[0m18:53:45.598305 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:53:45.598305 [debug] [ThreadPool]: On list_flights_demo_flights_wh: BEGIN
[0m18:53:45.599305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:45.679090 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:53:45.680089 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:53:45.680089 [debug] [ThreadPool]: On list_flights_demo_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo_flights_wh"} */
select
      'flights_demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:53:45.709052 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m18:53:45.711045 [debug] [ThreadPool]: On list_flights_demo_flights_wh: ROLLBACK
[0m18:53:45.712068 [debug] [ThreadPool]: On list_flights_demo_flights_wh: Close
[0m18:53:45.727039 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:45.727039 [debug] [MainThread]: On master: BEGIN
[0m18:53:45.728000 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:53:45.806814 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:53:45.807786 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:45.808783 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:53:45.893556 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:53:45.896549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9920c69f-07af-43dd-98c4-683250f890f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001666354EC90>]}
[0m18:53:45.896549 [debug] [MainThread]: On master: ROLLBACK
[0m18:53:45.897545 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:45.898543 [debug] [MainThread]: On master: BEGIN
[0m18:53:45.899541 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:53:45.900538 [debug] [MainThread]: On master: COMMIT
[0m18:53:45.900538 [debug] [MainThread]: Using postgres connection "master"
[0m18:53:45.901536 [debug] [MainThread]: On master: COMMIT
[0m18:53:45.902532 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:53:45.902532 [debug] [MainThread]: On master: Close
[0m18:53:45.904528 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:53:45.905526 [info ] [MainThread]: 
[0m18:53:45.924476 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_Airport
[0m18:53:45.926469 [info ] [Thread-1 (]: 1 of 7 START sql incremental model flights_wh.Dim_Airport ...................... [RUN]
[0m18:53:45.927470 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flights_dbt.Dim_Airport'
[0m18:53:45.928463 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_Airport
[0m18:53:45.932453 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_Airport"
[0m18:53:45.935445 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (compile): 18:53:45.929461 => 18:53:45.934448
[0m18:53:45.936442 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_Airport
[0m18:53:46.050138 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:53:46.051137 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

    
  
    

  create temporary table "Dim_Airport__dbt_tmp185346002277"
  
  
    as
  
  (
    

select *,
    jsonb_extract_path(airport_name, 'en' )as airport_name_eng, 
    jsonb_extract_path(city, 'en' )as city_eng,
    jsonb_extract_path(airport_name, 'ru' )as airport_name_rus,
    jsonb_extract_path(city, 'en' )as city_rus,

'2023-08-16 15:53:44'::timestamp as dbt_time

from stg.airports_data
  );
  
  
[0m18:53:46.052133 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:53:46.172817 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:53:46.183780 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:53:46.184777 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: BEGIN
[0m18:53:46.186772 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:53:46.186772 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:53:46.187769 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport__dbt_tmp185346002277'
        
      order by ordinal_position

  
[0m18:53:46.242623 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:53:46.249604 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:53:46.250601 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:53:46.257582 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:53:46.272545 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:53:46.272545 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:53:46.278531 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:53:46.313434 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_Airport"
[0m18:53:46.315429 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:53:46.315429 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      
        
            delete from "flights_demo"."flights_wh"."Dim_Airport"
            where (
                airport_code) in (
                select (airport_code)
                from "Dim_Airport__dbt_tmp185346002277"
            );

        
    

    insert into "flights_demo"."flights_wh"."Dim_Airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time"
        from "Dim_Airport__dbt_tmp185346002277"
    )
  
[0m18:53:46.327423 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m18:53:46.357352 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:53:46.358347 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:53:46.359315 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:53:46.361306 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:53:46.365325 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (execute): 18:53:45.937441 => 18:53:46.364343
[0m18:53:46.366293 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: Close
[0m18:53:46.368289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9920c69f-07af-43dd-98c4-683250f890f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166631A6CD0>]}
[0m18:53:46.370284 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model flights_wh.Dim_Airport ................. [[32mINSERT 0 104[0m in 0.44s]
[0m18:53:46.374274 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_Airport
[0m18:53:46.375376 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_aircraft
[0m18:53:46.377337 [info ] [Thread-1 (]: 2 of 7 START sql incremental model flights_wh.Dim_aircraft ..................... [RUN]
[0m18:53:46.382338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_Airport, now model.flights_dbt.Dim_aircraft)
[0m18:53:46.383323 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_aircraft
[0m18:53:46.392297 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_aircraft"
[0m18:53:46.396290 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (compile): 18:53:46.385320 => 18:53:46.394290
[0m18:53:46.399285 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_aircraft
[0m18:53:46.411282 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:53:46.412248 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

    
  
    

  create temporary table "Dim_aircraft__dbt_tmp185346406276"
  
  
    as
  
  (
    

select 
    row_number() over() as dim_aircraft_id,

    ad.aircraft_code,
    ad.model,
    ad.range,
    ad.last_update,

    s. seat_no,
    s.fare_conditions,

    case when range >= 5600 then 'High'
        when range < 5600 then 'Low'
        else 'Null'
        end as range_L_H,
    jsonb_extract_path(model, 'en' )as Model_English,
    jsonb_extract_path(model, 'ru' )as Model_Russian,

'2023-08-16 15:53:44'::timestamp as dbt_time

from flights_demo.stg.aircrafts_data ad 
join flights_demo.stg.seats s 
	on s.aircraft_code = ad.aircraft_code
  );
  
  
[0m18:53:46.413274 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:53:46.542671 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m18:53:46.548653 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:53:46.550652 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: BEGIN
[0m18:53:46.552643 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:53:46.553642 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:53:46.554637 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft__dbt_tmp185346406276'
        
      order by ordinal_position

  
[0m18:53:46.582563 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:53:46.587550 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:53:46.588549 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:53:46.594533 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:53:46.599519 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:53:46.600514 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:53:46.606498 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:53:46.618466 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_aircraft"
[0m18:53:46.619464 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:53:46.620460 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      insert into "flights_demo"."flights_wh"."Dim_aircraft" ("dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time")
    (
        select "dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time"
        from "Dim_aircraft__dbt_tmp185346406276"
    )


  
[0m18:53:46.626446 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m18:53:46.629437 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:53:46.631432 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:53:46.631432 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:53:46.635425 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:53:46.640409 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (execute): 18:53:46.400275 => 18:53:46.640409
[0m18:53:46.641440 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: Close
[0m18:53:46.643400 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9920c69f-07af-43dd-98c4-683250f890f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166634D2750>]}
[0m18:53:46.644402 [info ] [Thread-1 (]: 2 of 7 OK created sql incremental model flights_wh.Dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.26s]
[0m18:53:46.647389 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_aircraft
[0m18:53:46.648387 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_boarding_passes
[0m18:53:46.649387 [info ] [Thread-1 (]: 3 of 7 START sql incremental model flights_wh.Fact_boarding_passes ............. [RUN]
[0m18:53:46.652376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_aircraft, now model.flights_dbt.Fact_boarding_passes)
[0m18:53:46.653374 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_boarding_passes
[0m18:53:46.660369 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_boarding_passes"
[0m18:53:46.663346 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_boarding_passes (compile): 18:53:46.654373 => 18:53:46.662355
[0m18:53:46.664380 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_boarding_passes
[0m18:53:46.682296 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:53:46.682296 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

    
  
    

  create temporary table "Fact_boarding_passes__dbt_tmp185346672331"
  
  
    as
  
  (
    

select 
    bp.ticket_no,
    bp.flight_id,
    bp.boarding_no,
    bp.seat_no,
    bp.last_update,

    tf.fare_conditions,
    tf.amount,

'2023-08-16 15:53:44'::timestamp as dbt_time

from flights_demo.stg.ticket_flights tf 
join flights_demo.stg.boarding_passes bp 
	on tf.ticket_no = bp.ticket_no 
	and tf.flight_id =bp.flight_id
  );
  
  
[0m18:53:46.683326 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:53:50.664864 [debug] [Thread-1 (]: SQL status: SELECT 579686 in 4.0 seconds
[0m18:53:50.675834 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:53:50.676832 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: BEGIN
[0m18:53:50.679824 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:53:50.681818 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:53:50.684812 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Fact_boarding_passes__dbt_tmp185346672331'
        
      order by ordinal_position

  
[0m18:53:50.757616 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m18:53:50.764597 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:53:50.765594 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_boarding_passes'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:53:50.772575 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m18:53:50.777562 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:53:50.778560 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_boarding_passes'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:53:50.791528 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m18:53:50.800499 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_boarding_passes"
[0m18:53:50.804498 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:53:50.807482 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      
        
            delete from "flights_demo"."flights_wh"."Fact_boarding_passes"
            where (
                ticket_no) in (
                select (ticket_no)
                from "Fact_boarding_passes__dbt_tmp185346672331"
            );

        
    

    insert into "flights_demo"."flights_wh"."Fact_boarding_passes" ("ticket_no", "flight_id", "boarding_no", "seat_no", "last_update", "fare_conditions", "amount", "dbt_time")
    (
        select "ticket_no", "flight_id", "boarding_no", "seat_no", "last_update", "fare_conditions", "amount", "dbt_time"
        from "Fact_boarding_passes__dbt_tmp185346672331"
    )
  
[0m18:53:56.694927 [debug] [Thread-1 (]: SQL status: INSERT 0 579686 in 6.0 seconds
[0m18:53:56.697920 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: COMMIT
[0m18:53:56.698919 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:53:56.699914 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: COMMIT
[0m18:53:56.719859 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:53:56.721854 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_boarding_passes (execute): 18:53:46.665375 => 18:53:56.721854
[0m18:53:56.722850 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: Close
[0m18:53:56.725845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9920c69f-07af-43dd-98c4-683250f890f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166634BF190>]}
[0m18:53:56.727838 [info ] [Thread-1 (]: 3 of 7 OK created sql incremental model flights_wh.Fact_boarding_passes ........ [[32mINSERT 0 579686[0m in 10.07s]
[0m18:53:56.729833 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_boarding_passes
[0m18:53:56.730829 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_flights
[0m18:53:56.731825 [info ] [Thread-1 (]: 4 of 7 START sql incremental model flights_wh.Fact_flights ..................... [RUN]
[0m18:53:56.733821 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_boarding_passes, now model.flights_dbt.Fact_flights)
[0m18:53:56.734819 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_flights
[0m18:53:56.738812 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_flights"
[0m18:53:56.743796 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (compile): 18:53:56.734819 => 18:53:56.742798
[0m18:53:56.744793 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_flights
[0m18:53:56.771239 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:53:56.772236 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

    
  
    

  create temporary table "Fact_flights__dbt_tmp185356758757"
  
  
    as
  
  (
    

with dim_flight_mod as (	
			select *,
			extract(day from (scheduled_arrival - scheduled_departure)*24) + extract(hour from (scheduled_arrival - scheduled_departure)) as flight_duration_expected,
			extract(day from (actual_arrival - actual_departure)*24) + extract(hour from (actual_arrival - actual_departure)) as duration_actual_hours
			from flights_demo.stg.flights f 
			)
select *,
    case 	when duration_actual_hours > flight_duration_expected 
                then 'Longer'
            when duration_actual_hours < flight_duration_expected 
                then 'Shorter'
            when duration_actual_hours = flight_duration_expected 
                then 'As Expected'
            else null
            end as flight_duration_case,

'2023-08-16 15:53:44'::timestamp as dbt_time

from dim_flight_mod
  );
  
  
[0m18:53:56.775231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:53:57.077460 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m18:53:57.082440 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:53:57.082440 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: BEGIN
[0m18:53:57.084402 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:53:57.085398 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:53:57.085398 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights__dbt_tmp185356758757'
        
      order by ordinal_position

  
[0m18:53:57.114321 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:53:57.120330 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:53:57.120330 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:53:57.131318 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:53:57.138259 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:53:57.139255 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:53:57.145270 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:53:57.150225 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_flights"
[0m18:53:57.152220 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:53:57.153221 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      
        
            delete from "flights_demo"."flights_wh"."Fact_flights"
            where (
                flight_id) in (
                select (flight_id)
                from "Fact_flights__dbt_tmp185356758757"
            );

        
    

    insert into "flights_demo"."flights_wh"."Fact_flights" ("flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time")
    (
        select "flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time"
        from "Fact_flights__dbt_tmp185356758757"
    )
  
[0m18:53:57.660387 [debug] [Thread-1 (]: SQL status: INSERT 0 33121 in 1.0 seconds
[0m18:53:57.663379 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:53:57.664376 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:53:57.665374 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:53:57.677342 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:53:57.679337 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (execute): 18:53:56.745789 => 18:53:57.679337
[0m18:53:57.680334 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: Close
[0m18:53:57.682342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9920c69f-07af-43dd-98c4-683250f890f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001666372E150>]}
[0m18:53:57.684324 [info ] [Thread-1 (]: 4 of 7 OK created sql incremental model flights_wh.Fact_flights ................ [[32mINSERT 0 33121[0m in 0.95s]
[0m18:53:57.689311 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_flights
[0m18:53:57.692319 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_tickets
[0m18:53:57.694298 [info ] [Thread-1 (]: 5 of 7 START sql incremental model flights_wh.Fact_tickets ..................... [RUN]
[0m18:53:57.700282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_flights, now model.flights_dbt.Fact_tickets)
[0m18:53:57.703276 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_tickets
[0m18:53:57.721227 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_tickets"
[0m18:53:57.725216 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_tickets (compile): 18:53:57.705269 => 18:53:57.723220
[0m18:53:57.728206 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_tickets
[0m18:53:57.748153 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m18:53:57.750153 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_tickets"} */

    
  
    

  create temporary table "Fact_tickets__dbt_tmp185357735188"
  
  
    as
  
  (
    

select 
    b.book_ref,
    b.book_date,
    b.total_amount,

    t.ticket_no,
    t.passenger_id,
    t.passenger_name,
    t.contact_data,
    t.last_update,

    jsonb_extract_path(contact_data, 'email' )as Email,
    jsonb_extract_path(contact_data, 'phone' )as Phone,

'2023-08-16 15:53:44'::timestamp as dbt_time

from flights_demo.stg.bookings b 
join flights_demo.stg.tickets t
	on b.book_ref =t.book_ref
  );
  
  
[0m18:53:57.753142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:54:00.879133 [debug] [Thread-1 (]: SQL status: SELECT 366733 in 3.0 seconds
[0m18:54:00.898083 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m18:54:00.901076 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: BEGIN
[0m18:54:00.907077 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:54:00.912062 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m18:54:00.915042 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Fact_tickets__dbt_tmp185357735188'
        
      order by ordinal_position

  
[0m18:54:01.016767 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:54:01.031725 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m18:54:01.032722 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_tickets'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:54:01.043697 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:54:01.050674 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m18:54:01.051713 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_tickets'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:54:01.063639 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:54:01.068625 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_tickets"
[0m18:54:01.072615 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m18:54:01.074610 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_tickets"} */

      
        
            delete from "flights_demo"."flights_wh"."Fact_tickets"
            where (
                ticket_no) in (
                select (ticket_no)
                from "Fact_tickets__dbt_tmp185357735188"
            );

        
    

    insert into "flights_demo"."flights_wh"."Fact_tickets" ("book_ref", "book_date", "total_amount", "ticket_no", "passenger_id", "passenger_name", "contact_data", "last_update", "email", "phone", "dbt_time")
    (
        select "book_ref", "book_date", "total_amount", "ticket_no", "passenger_id", "passenger_name", "contact_data", "last_update", "email", "phone", "dbt_time"
        from "Fact_tickets__dbt_tmp185357735188"
    )
  
[0m18:54:10.137550 [debug] [Thread-1 (]: SQL status: INSERT 0 366733 in 9.0 seconds
[0m18:54:10.140504 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: COMMIT
[0m18:54:10.141502 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m18:54:10.142499 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: COMMIT
[0m18:54:10.159455 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:54:10.161473 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_tickets (execute): 18:53:57.730204 => 18:54:10.161473
[0m18:54:10.163447 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: Close
[0m18:54:10.165447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9920c69f-07af-43dd-98c4-683250f890f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166634CBB90>]}
[0m18:54:10.167433 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model flights_wh.Fact_tickets ................ [[32mINSERT 0 366733[0m in 12.47s]
[0m18:54:10.170425 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_tickets
[0m18:54:10.171423 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m18:54:10.172426 [info ] [Thread-1 (]: 6 of 7 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m18:54:10.175413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_tickets, now model.flights_dbt.my_first_dbt_model)
[0m18:54:10.177409 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m18:54:10.183391 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m18:54:10.186384 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 18:54:10.178433 => 18:54:10.185387
[0m18:54:10.189379 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m18:54:10.285118 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m18:54:10.288109 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:54:10.290106 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m18:54:10.291101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:54:10.395824 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:54:10.397817 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:54:10.399817 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:54:10.448680 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:54:10.467630 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:54:10.469624 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:54:10.475608 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:54:10.483586 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:54:10.484583 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:54:10.486583 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:54:10.498549 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:54:10.500541 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:54:10.502538 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:54:10.504531 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:54:10.522482 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:54:10.523479 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:54:10.537442 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:54:10.542431 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 18:54:10.197355 => 18:54:10.541431
[0m18:54:10.544425 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m18:54:10.548415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9920c69f-07af-43dd-98c4-683250f890f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016663766150>]}
[0m18:54:10.550409 [info ] [Thread-1 (]: 6 of 7 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.37s]
[0m18:54:10.552402 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m18:54:10.554397 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m18:54:10.555394 [info ] [Thread-1 (]: 7 of 7 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:54:10.556392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m18:54:10.557390 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m18:54:10.563376 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m18:54:10.576340 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 18:54:10.558389 => 18:54:10.574347
[0m18:54:10.577336 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m18:54:10.592296 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m18:54:10.596289 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:54:10.600284 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m18:54:10.606263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:54:10.713974 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:54:10.715965 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:54:10.716964 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_demo"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:54:10.733919 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:54:10.742894 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:54:10.744889 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:54:10.746883 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:54:10.751869 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:54:10.752865 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:54:10.753864 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:54:10.756860 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:54:10.761845 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:54:10.762840 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:54:10.763838 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:54:10.766830 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 18:54:10.579333 => 18:54:10.765833
[0m18:54:10.766830 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m18:54:10.768826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9920c69f-07af-43dd-98c4-683250f890f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000166635B8090>]}
[0m18:54:10.770819 [info ] [Thread-1 (]: 7 of 7 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.21s]
[0m18:54:10.774809 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m18:54:10.777800 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:10.779795 [debug] [MainThread]: On master: BEGIN
[0m18:54:10.779795 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:54:10.879529 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:54:10.880525 [debug] [MainThread]: On master: COMMIT
[0m18:54:10.881523 [debug] [MainThread]: Using postgres connection "master"
[0m18:54:10.882521 [debug] [MainThread]: On master: COMMIT
[0m18:54:10.884520 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:54:10.885511 [debug] [MainThread]: On master: Close
[0m18:54:10.887507 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:54:10.889504 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m18:54:10.890500 [debug] [MainThread]: Connection 'list_flights_demo_flights_wh' was properly closed.
[0m18:54:10.891495 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m18:54:10.893491 [info ] [MainThread]: 
[0m18:54:10.895485 [info ] [MainThread]: Finished running 5 incremental models, 2 view models in 0 hours 0 minutes and 25.59 seconds (25.59s).
[0m18:54:10.898477 [debug] [MainThread]: Command end result
[0m18:54:10.908451 [info ] [MainThread]: 
[0m18:54:10.911445 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:54:10.916431 [info ] [MainThread]: 
[0m18:54:10.919424 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m18:54:10.922414 [debug] [MainThread]: Command `dbt run` succeeded at 18:54:10.922414 after 26.65 seconds
[0m18:54:10.923411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001665C90EB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001665C90DFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001665C90ECD0>]}
[0m18:54:10.929407 [debug] [MainThread]: Flushing usage events
[0m18:57:10.370997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B03AEE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B045D250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B045D510>]}


============================== 18:57:10.378978 | 3b1cc6a9-96ec-4744-ac40-566f8667f839 ==============================
[0m18:57:10.378978 [info ] [MainThread]: Running with dbt=1.5.3
[0m18:57:10.380937 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:57:10.532566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b1cc6a9-96ec-4744-ac40-566f8667f839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B034F650>]}
[0m18:57:10.553509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b1cc6a9-96ec-4744-ac40-566f8667f839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B034F650>]}
[0m18:57:10.555505 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m18:57:10.582402 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m18:57:10.922568 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:57:10.923567 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models\dimension\Dim_aircraft.sql
[0m18:57:10.956514 [debug] [MainThread]: 1603: static parser failed on dimension\Dim_aircraft.sql
[0m18:57:10.980413 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimension\Dim_aircraft.sql
[0m18:57:10.996371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b1cc6a9-96ec-4744-ac40-566f8667f839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B0683450>]}
[0m18:57:11.011383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b1cc6a9-96ec-4744-ac40-566f8667f839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B0715590>]}
[0m18:57:11.012331 [info ] [MainThread]: Found 7 models, 12 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:57:11.014324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b1cc6a9-96ec-4744-ac40-566f8667f839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8ACAF3090>]}
[0m18:57:11.016318 [info ] [MainThread]: 
[0m18:57:11.021306 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:57:11.024296 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m18:57:11.047240 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m18:57:11.050235 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m18:57:11.052222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:11.235853 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m18:57:11.238845 [debug] [ThreadPool]: On list_flights_demo: Close
[0m18:57:11.241836 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo_flights_wh'
[0m18:57:11.255801 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:57:11.256798 [debug] [ThreadPool]: On list_flights_demo_flights_wh: BEGIN
[0m18:57:11.256798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:11.352540 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:57:11.353539 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:57:11.354539 [debug] [ThreadPool]: On list_flights_demo_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo_flights_wh"} */
select
      'flights_demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:57:11.405914 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m18:57:11.407910 [debug] [ThreadPool]: On list_flights_demo_flights_wh: ROLLBACK
[0m18:57:11.409906 [debug] [ThreadPool]: On list_flights_demo_flights_wh: Close
[0m18:57:11.424864 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:11.425861 [debug] [MainThread]: On master: BEGIN
[0m18:57:11.426858 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:57:11.498668 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:57:11.498668 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:11.499697 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:57:11.560536 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:57:11.563527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b1cc6a9-96ec-4744-ac40-566f8667f839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B0DA4550>]}
[0m18:57:11.564524 [debug] [MainThread]: On master: ROLLBACK
[0m18:57:11.565487 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:11.565487 [debug] [MainThread]: On master: BEGIN
[0m18:57:11.566486 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:57:11.567516 [debug] [MainThread]: On master: COMMIT
[0m18:57:11.568480 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:11.568480 [debug] [MainThread]: On master: COMMIT
[0m18:57:11.569480 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:57:11.570478 [debug] [MainThread]: On master: Close
[0m18:57:11.572471 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:57:11.574465 [info ] [MainThread]: 
[0m18:57:11.595408 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_Airport
[0m18:57:11.596409 [info ] [Thread-1 (]: 1 of 7 START sql incremental model flights_wh.Dim_Airport ...................... [RUN]
[0m18:57:11.598401 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flights_dbt.Dim_Airport'
[0m18:57:11.600398 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_Airport
[0m18:57:11.606387 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_Airport"
[0m18:57:11.611369 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (compile): 18:57:11.600398 => 18:57:11.609382
[0m18:57:11.614360 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_Airport
[0m18:57:11.728081 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:57:11.730048 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

    
  
    

  create temporary table "Dim_Airport__dbt_tmp185711680216"
  
  
    as
  
  (
    

select *,
    jsonb_extract_path(airport_name, 'en' )as airport_name_eng, 
    jsonb_extract_path(city, 'en' )as city_eng,
    jsonb_extract_path(airport_name, 'ru' )as airport_name_rus,
    jsonb_extract_path(city, 'en' )as city_rus,

'2023-08-16 15:57:10'::timestamp as dbt_time

from stg.airports_data
  );
  
  
[0m18:57:11.731079 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:57:11.839780 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:57:11.850755 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:57:11.851753 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: BEGIN
[0m18:57:11.854730 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:57:11.857707 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:57:11.859704 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport__dbt_tmp185711680216'
        
      order by ordinal_position

  
[0m18:57:11.911592 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:57:11.920538 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:57:11.922542 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:57:11.930512 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:57:11.953460 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:57:11.955452 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:57:11.967414 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:57:12.014289 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_Airport"
[0m18:57:12.017282 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:57:12.018277 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      
        
            delete from "flights_demo"."flights_wh"."Dim_Airport"
            where (
                airport_code) in (
                select (airport_code)
                from "Dim_Airport__dbt_tmp185711680216"
            );

        
    

    insert into "flights_demo"."flights_wh"."Dim_Airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time"
        from "Dim_Airport__dbt_tmp185711680216"
    )
  
[0m18:57:12.031242 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m18:57:12.068148 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:57:12.069141 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:57:12.070141 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:57:12.073132 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:57:12.080114 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (execute): 18:57:11.615413 => 18:57:12.079122
[0m18:57:12.081112 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: Close
[0m18:57:12.084103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1cc6a9-96ec-4744-ac40-566f8667f839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B0E89650>]}
[0m18:57:12.085099 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model flights_wh.Dim_Airport ................. [[32mINSERT 0 104[0m in 0.49s]
[0m18:57:12.088090 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_Airport
[0m18:57:12.089091 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_aircraft
[0m18:57:12.090084 [info ] [Thread-1 (]: 2 of 7 START sql incremental model flights_wh.Dim_aircraft ..................... [RUN]
[0m18:57:12.094114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_Airport, now model.flights_dbt.Dim_aircraft)
[0m18:57:12.096069 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_aircraft
[0m18:57:12.102086 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_aircraft"
[0m18:57:12.107042 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (compile): 18:57:12.096069 => 18:57:12.106058
[0m18:57:12.108037 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_aircraft
[0m18:57:12.122003 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:57:12.123000 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

    
  
    

  create temporary table "Dim_aircraft__dbt_tmp185712117018"
  
  
    as
  
  (
    

select 
    row_number() over() as dim_aircraft_id,

    ad.aircraft_code,
    ad.model,
    ad.range,
    ad.last_update,

    s. seat_no,
    s.fare_conditions,

    case when range > 5600 then 'High'
        when range < = 5600 then 'Low'
        else 'Null'
        end as range_L_H,
    jsonb_extract_path(model, 'en' )as Model_English,
    jsonb_extract_path(model, 'ru' )as Model_Russian,

'2023-08-16 15:57:10'::timestamp as dbt_time

from flights_demo.stg.aircrafts_data ad 
join flights_demo.stg.seats s 
	on s.aircraft_code = ad.aircraft_code
  );
  
  
[0m18:57:12.123000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:12.234699 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "="
LINE 27:         when range < = 5600 then 'Low'
                              ^

[0m18:57:12.236693 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (execute): 18:57:12.109035 => 18:57:12.236693
[0m18:57:12.237690 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: Close
[0m18:57:12.252651 [debug] [Thread-1 (]: Database Error in model Dim_aircraft (models\dimension\Dim_aircraft.sql)
  syntax error at or near "="
  LINE 27:         when range < = 5600 then 'Low'
                                ^
[0m18:57:12.253649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1cc6a9-96ec-4744-ac40-566f8667f839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B0F70210>]}
[0m18:57:12.254645 [error] [Thread-1 (]: 2 of 7 ERROR creating sql incremental model flights_wh.Dim_aircraft ............ [[31mERROR[0m in 0.16s]
[0m18:57:12.256640 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_aircraft
[0m18:57:12.257637 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_boarding_passes
[0m18:57:12.259635 [info ] [Thread-1 (]: 3 of 7 START sql incremental model flights_wh.Fact_boarding_passes ............. [RUN]
[0m18:57:12.262625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_aircraft, now model.flights_dbt.Fact_boarding_passes)
[0m18:57:12.266615 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_boarding_passes
[0m18:57:12.275677 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_boarding_passes"
[0m18:57:12.282653 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_boarding_passes (compile): 18:57:12.267612 => 18:57:12.281658
[0m18:57:12.283651 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_boarding_passes
[0m18:57:12.291631 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:57:12.294676 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

    
  
    

  create temporary table "Fact_boarding_passes__dbt_tmp185712286641"
  
  
    as
  
  (
    

select 
    bp.ticket_no,
    bp.flight_id,
    bp.boarding_no,
    bp.seat_no,
    bp.last_update,

    tf.fare_conditions,
    tf.amount,

'2023-08-16 15:57:10'::timestamp as dbt_time

from flights_demo.stg.ticket_flights tf 
join flights_demo.stg.boarding_passes bp 
	on tf.ticket_no = bp.ticket_no 
	and tf.flight_id =bp.flight_id
  );
  
  
[0m18:57:12.301605 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:16.146647 [debug] [Thread-1 (]: SQL status: SELECT 579686 in 4.0 seconds
[0m18:57:16.154627 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:57:16.155625 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: BEGIN
[0m18:57:16.162604 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:57:16.163602 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:57:16.163602 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Fact_boarding_passes__dbt_tmp185712286641'
        
      order by ordinal_position

  
[0m18:57:16.204530 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m18:57:16.213469 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:57:16.214466 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_boarding_passes'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:57:16.224439 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m18:57:16.231422 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:57:16.232451 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_boarding_passes'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:57:16.242393 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m18:57:16.246379 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_boarding_passes"
[0m18:57:16.248374 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:57:16.249372 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      
        
            delete from "flights_demo"."flights_wh"."Fact_boarding_passes"
            where (
                ticket_no) in (
                select (ticket_no)
                from "Fact_boarding_passes__dbt_tmp185712286641"
            );

        
    

    insert into "flights_demo"."flights_wh"."Fact_boarding_passes" ("ticket_no", "flight_id", "boarding_no", "seat_no", "last_update", "fare_conditions", "amount", "dbt_time")
    (
        select "ticket_no", "flight_id", "boarding_no", "seat_no", "last_update", "fare_conditions", "amount", "dbt_time"
        from "Fact_boarding_passes__dbt_tmp185712286641"
    )
  
[0m18:57:24.533371 [debug] [Thread-1 (]: SQL status: INSERT 0 579686 in 8.0 seconds
[0m18:57:24.538357 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: COMMIT
[0m18:57:24.539354 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:57:24.539354 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: COMMIT
[0m18:57:24.561296 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:57:24.565285 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_boarding_passes (execute): 18:57:12.283651 => 18:57:24.564289
[0m18:57:24.567284 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: Close
[0m18:57:24.569275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1cc6a9-96ec-4744-ac40-566f8667f839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B0F8E9D0>]}
[0m18:57:24.571270 [info ] [Thread-1 (]: 3 of 7 OK created sql incremental model flights_wh.Fact_boarding_passes ........ [[32mINSERT 0 579686[0m in 12.31s]
[0m18:57:24.574261 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_boarding_passes
[0m18:57:24.575258 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_flights
[0m18:57:24.577252 [info ] [Thread-1 (]: 4 of 7 START sql incremental model flights_wh.Fact_flights ..................... [RUN]
[0m18:57:24.581245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_boarding_passes, now model.flights_dbt.Fact_flights)
[0m18:57:24.584236 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_flights
[0m18:57:24.600194 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_flights"
[0m18:57:24.603186 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (compile): 18:57:24.587232 => 18:57:24.602187
[0m18:57:24.605179 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_flights
[0m18:57:24.636103 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:57:24.639092 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

    
  
    

  create temporary table "Fact_flights__dbt_tmp185724617152"
  
  
    as
  
  (
    

with dim_flight_mod as (	
			select *,
			extract(day from (scheduled_arrival - scheduled_departure)*24) + extract(hour from (scheduled_arrival - scheduled_departure)) as flight_duration_expected,
			extract(day from (actual_arrival - actual_departure)*24) + extract(hour from (actual_arrival - actual_departure)) as duration_actual_hours
			from flights_demo.stg.flights f 
			)
select *,
    case 	when duration_actual_hours > flight_duration_expected 
                then 'Longer'
            when duration_actual_hours < flight_duration_expected 
                then 'Shorter'
            when duration_actual_hours = flight_duration_expected 
                then 'As Expected'
            else null
            end as flight_duration_case,

'2023-08-16 15:57:10'::timestamp as dbt_time

from dim_flight_mod
  );
  
  
[0m18:57:24.649069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:25.070859 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m18:57:25.076843 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:57:25.077841 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: BEGIN
[0m18:57:25.081888 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:57:25.083846 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:57:25.084823 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights__dbt_tmp185724617152'
        
      order by ordinal_position

  
[0m18:57:25.128706 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:57:25.139677 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:57:25.140673 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:57:25.145659 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:57:25.156629 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:57:25.157635 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:57:25.165619 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:57:25.176577 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_flights"
[0m18:57:25.179577 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:57:25.183568 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      
        
            delete from "flights_demo"."flights_wh"."Fact_flights"
            where (
                flight_id) in (
                select (flight_id)
                from "Fact_flights__dbt_tmp185724617152"
            );

        
    

    insert into "flights_demo"."flights_wh"."Fact_flights" ("flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time")
    (
        select "flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time"
        from "Fact_flights__dbt_tmp185724617152"
    )
  
[0m18:57:25.684094 [debug] [Thread-1 (]: SQL status: INSERT 0 33121 in 0.0 seconds
[0m18:57:25.703035 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:57:25.704034 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:57:25.706028 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:57:25.721985 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:57:25.723979 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (execute): 18:57:24.606177 => 18:57:25.722982
[0m18:57:25.724982 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: Close
[0m18:57:25.730964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1cc6a9-96ec-4744-ac40-566f8667f839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B1406990>]}
[0m18:57:25.734952 [info ] [Thread-1 (]: 4 of 7 OK created sql incremental model flights_wh.Fact_flights ................ [[32mINSERT 0 33121[0m in 1.15s]
[0m18:57:25.738940 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_flights
[0m18:57:25.739937 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_tickets
[0m18:57:25.741932 [info ] [Thread-1 (]: 5 of 7 START sql incremental model flights_wh.Fact_tickets ..................... [RUN]
[0m18:57:25.744923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_flights, now model.flights_dbt.Fact_tickets)
[0m18:57:25.746919 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_tickets
[0m18:57:25.760883 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_tickets"
[0m18:57:25.764872 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_tickets (compile): 18:57:25.747924 => 18:57:25.763873
[0m18:57:25.768859 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_tickets
[0m18:57:25.800774 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m18:57:25.803767 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_tickets"} */

    
  
    

  create temporary table "Fact_tickets__dbt_tmp185725782825"
  
  
    as
  
  (
    

select 
    b.book_ref,
    b.book_date,
    b.total_amount,

    t.ticket_no,
    t.passenger_id,
    t.passenger_name,
    t.contact_data,
    t.last_update,

    jsonb_extract_path(contact_data, 'email' )as Email,
    jsonb_extract_path(contact_data, 'phone' )as Phone,

'2023-08-16 15:57:10'::timestamp as dbt_time

from flights_demo.stg.bookings b 
join flights_demo.stg.tickets t
	on b.book_ref =t.book_ref
  );
  
  
[0m18:57:25.806758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:28.968645 [debug] [Thread-1 (]: SQL status: SELECT 366733 in 3.0 seconds
[0m18:57:28.974605 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m18:57:28.975604 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: BEGIN
[0m18:57:28.977597 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:57:28.978596 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m18:57:28.979593 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Fact_tickets__dbt_tmp185725782825'
        
      order by ordinal_position

  
[0m18:57:29.007517 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:57:29.013636 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m18:57:29.014498 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_tickets'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:57:29.021479 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:57:29.028462 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m18:57:29.029460 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_tickets'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:57:29.034454 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:57:29.039431 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_tickets"
[0m18:57:29.042426 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m18:57:29.044420 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_tickets"} */

      
        
            delete from "flights_demo"."flights_wh"."Fact_tickets"
            where (
                ticket_no) in (
                select (ticket_no)
                from "Fact_tickets__dbt_tmp185725782825"
            );

        
    

    insert into "flights_demo"."flights_wh"."Fact_tickets" ("book_ref", "book_date", "total_amount", "ticket_no", "passenger_id", "passenger_name", "contact_data", "last_update", "email", "phone", "dbt_time")
    (
        select "book_ref", "book_date", "total_amount", "ticket_no", "passenger_id", "passenger_name", "contact_data", "last_update", "email", "phone", "dbt_time"
        from "Fact_tickets__dbt_tmp185725782825"
    )
  
[0m18:57:38.649346 [debug] [Thread-1 (]: SQL status: INSERT 0 366733 in 10.0 seconds
[0m18:57:38.656326 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: COMMIT
[0m18:57:38.657327 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m18:57:38.658327 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: COMMIT
[0m18:57:38.683263 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:57:38.685258 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_tickets (execute): 18:57:25.770855 => 18:57:38.685258
[0m18:57:38.686281 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: Close
[0m18:57:38.687252 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1cc6a9-96ec-4744-ac40-566f8667f839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B13E6D50>]}
[0m18:57:38.689249 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model flights_wh.Fact_tickets ................ [[32mINSERT 0 366733[0m in 12.94s]
[0m18:57:38.691242 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_tickets
[0m18:57:38.692268 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m18:57:38.693237 [info ] [Thread-1 (]: 6 of 7 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m18:57:38.695231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_tickets, now model.flights_dbt.my_first_dbt_model)
[0m18:57:38.696228 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m18:57:38.699223 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m18:57:38.706204 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 18:57:38.696228 => 18:57:38.705204
[0m18:57:38.707198 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m18:57:38.763107 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m18:57:38.765044 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:57:38.766042 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m18:57:38.767039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:38.867655 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:57:38.868678 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:57:38.869678 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:57:38.898572 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:57:38.905586 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:57:38.906585 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:57:38.909543 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:57:38.914529 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:57:38.916525 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:57:38.920520 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:57:38.933480 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:57:38.934476 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:57:38.935474 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:57:38.937470 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:57:38.944478 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:57:38.945446 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:57:38.954423 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:57:38.957417 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 18:57:38.708197 => 18:57:38.956422
[0m18:57:38.958414 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m18:57:38.960411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1cc6a9-96ec-4744-ac40-566f8667f839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B0F702D0>]}
[0m18:57:38.962402 [info ] [Thread-1 (]: 6 of 7 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.27s]
[0m18:57:38.964407 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m18:57:38.966149 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m18:57:38.968125 [info ] [Thread-1 (]: 7 of 7 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:57:38.970121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m18:57:38.971121 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m18:57:38.975136 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m18:57:38.982140 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 18:57:38.972116 => 18:57:38.980095
[0m18:57:38.986080 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m18:57:38.999045 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m18:57:39.003036 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:57:39.004029 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m18:57:39.005026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:39.094297 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:57:39.094297 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:57:39.095294 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_demo"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:57:39.104270 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:57:39.110254 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:57:39.111251 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:57:39.112249 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:57:39.115241 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:57:39.115241 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:57:39.117264 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:57:39.120229 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:57:39.124216 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:57:39.125217 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:57:39.127209 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:57:39.130202 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 18:57:38.989071 => 18:57:39.129205
[0m18:57:39.131198 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m18:57:39.133200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b1cc6a9-96ec-4744-ac40-566f8667f839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B0E6D210>]}
[0m18:57:39.134194 [info ] [Thread-1 (]: 7 of 7 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.16s]
[0m18:57:39.137183 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m18:57:39.140175 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:39.140175 [debug] [MainThread]: On master: BEGIN
[0m18:57:39.141172 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:57:39.349617 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:57:39.351613 [debug] [MainThread]: On master: COMMIT
[0m18:57:39.352615 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:39.353603 [debug] [MainThread]: On master: COMMIT
[0m18:57:39.356598 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:57:39.358598 [debug] [MainThread]: On master: Close
[0m18:57:39.360587 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:57:39.362582 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m18:57:39.362582 [debug] [MainThread]: Connection 'list_flights_demo_flights_wh' was properly closed.
[0m18:57:39.363578 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m18:57:39.366571 [info ] [MainThread]: 
[0m18:57:39.368569 [info ] [MainThread]: Finished running 5 incremental models, 2 view models in 0 hours 0 minutes and 28.34 seconds (28.34s).
[0m18:57:39.371556 [debug] [MainThread]: Command end result
[0m18:57:39.383526 [info ] [MainThread]: 
[0m18:57:39.385520 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:57:39.386519 [info ] [MainThread]: 
[0m18:57:39.388519 [error] [MainThread]: [33mDatabase Error in model Dim_aircraft (models\dimension\Dim_aircraft.sql)[0m
[0m18:57:39.393524 [error] [MainThread]:   syntax error at or near "="
[0m18:57:39.395494 [error] [MainThread]:   LINE 27:         when range < = 5600 then 'Low'
[0m18:57:39.398502 [error] [MainThread]:                                 ^
[0m18:57:39.401489 [info ] [MainThread]: 
[0m18:57:39.403471 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m18:57:39.406465 [debug] [MainThread]: Command `dbt run` failed at 18:57:39.405467 after 29.08 seconds
[0m18:57:39.407464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B0633990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B042C7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8B045D510>]}
[0m18:57:39.408459 [debug] [MainThread]: Flushing usage events
[0m18:57:51.275906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021203941690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212033D69D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021202A17350>]}


============================== 18:57:51.287867 | 7d1d57c0-af42-491a-9bdd-183a95f6ae89 ==============================
[0m18:57:51.287867 [info ] [MainThread]: Running with dbt=1.5.3
[0m18:57:51.289863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m18:57:51.514260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d1d57c0-af42-491a-9bdd-183a95f6ae89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021202A17350>]}
[0m18:57:51.552159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d1d57c0-af42-491a-9bdd-183a95f6ae89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021203FFBE50>]}
[0m18:57:51.555154 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m18:57:51.610013 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m18:57:51.803533 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:57:51.805482 [debug] [MainThread]: Partial parsing: updated file: flights_dbt://models\dimension\Dim_aircraft.sql
[0m18:57:51.840387 [debug] [MainThread]: 1603: static parser failed on dimension\Dim_aircraft.sql
[0m18:57:51.875294 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimension\Dim_aircraft.sql
[0m18:57:51.889258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d1d57c0-af42-491a-9bdd-183a95f6ae89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021203D6E650>]}
[0m18:57:51.903253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d1d57c0-af42-491a-9bdd-183a95f6ae89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021203672290>]}
[0m18:57:51.904251 [info ] [MainThread]: Found 7 models, 12 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m18:57:51.906213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d1d57c0-af42-491a-9bdd-183a95f6ae89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002127FD73110>]}
[0m18:57:51.909203 [info ] [MainThread]: 
[0m18:57:51.910200 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:57:51.913194 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m18:57:51.935147 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m18:57:51.936137 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m18:57:51.942136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:52.055920 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m18:57:52.058963 [debug] [ThreadPool]: On list_flights_demo: Close
[0m18:57:52.064898 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo_flights_wh'
[0m18:57:52.073909 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:57:52.073909 [debug] [ThreadPool]: On list_flights_demo_flights_wh: BEGIN
[0m18:57:52.074903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:52.139738 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m18:57:52.140729 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m18:57:52.140729 [debug] [ThreadPool]: On list_flights_demo_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo_flights_wh"} */
select
      'flights_demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m18:57:52.165674 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m18:57:52.167665 [debug] [ThreadPool]: On list_flights_demo_flights_wh: ROLLBACK
[0m18:57:52.168662 [debug] [ThreadPool]: On list_flights_demo_flights_wh: Close
[0m18:57:52.177635 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:52.178633 [debug] [MainThread]: On master: BEGIN
[0m18:57:52.179631 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:57:52.240027 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:57:52.240975 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:52.241971 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:57:52.288879 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m18:57:52.290878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d1d57c0-af42-491a-9bdd-183a95f6ae89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212039C0490>]}
[0m18:57:52.291870 [debug] [MainThread]: On master: ROLLBACK
[0m18:57:52.292868 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:52.293866 [debug] [MainThread]: On master: BEGIN
[0m18:57:52.294830 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:57:52.294830 [debug] [MainThread]: On master: COMMIT
[0m18:57:52.295826 [debug] [MainThread]: Using postgres connection "master"
[0m18:57:52.295826 [debug] [MainThread]: On master: COMMIT
[0m18:57:52.296857 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:57:52.297858 [debug] [MainThread]: On master: Close
[0m18:57:52.298819 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:57:52.300814 [info ] [MainThread]: 
[0m18:57:52.312816 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_Airport
[0m18:57:52.313814 [info ] [Thread-1 (]: 1 of 7 START sql incremental model flights_wh.Dim_Airport ...................... [RUN]
[0m18:57:52.317812 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flights_dbt.Dim_Airport'
[0m18:57:52.318801 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_Airport
[0m18:57:52.326756 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_Airport"
[0m18:57:52.328739 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (compile): 18:57:52.319763 => 18:57:52.328739
[0m18:57:52.329749 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_Airport
[0m18:57:52.441538 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:57:52.442533 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

    
  
    

  create temporary table "Dim_Airport__dbt_tmp185752392569"
  
  
    as
  
  (
    

select *,
    jsonb_extract_path(airport_name, 'en' )as airport_name_eng, 
    jsonb_extract_path(city, 'en' )as city_eng,
    jsonb_extract_path(airport_name, 'ru' )as airport_name_rus,
    jsonb_extract_path(city, 'en' )as city_rus,

'2023-08-16 15:57:51'::timestamp as dbt_time

from stg.airports_data
  );
  
  
[0m18:57:52.442533 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:57:52.530297 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m18:57:52.540306 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:57:52.543295 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: BEGIN
[0m18:57:52.544325 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:57:52.545289 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:57:52.545289 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport__dbt_tmp185752392569'
        
      order by ordinal_position

  
[0m18:57:52.577236 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:57:52.585217 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:57:52.588177 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:57:52.595201 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:57:52.605162 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:57:52.606133 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:57:52.613107 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:57:52.641068 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_Airport"
[0m18:57:52.644027 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:57:52.645023 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      
        
            delete from "flights_demo"."flights_wh"."Dim_Airport"
            where (
                airport_code) in (
                select (airport_code)
                from "Dim_Airport__dbt_tmp185752392569"
            );

        
    

    insert into "flights_demo"."flights_wh"."Dim_Airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time"
        from "Dim_Airport__dbt_tmp185752392569"
    )
  
[0m18:57:52.651007 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m18:57:52.670953 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:57:52.671983 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m18:57:52.671983 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m18:57:52.679931 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:57:52.682960 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (execute): 18:57:52.330767 => 18:57:52.681939
[0m18:57:52.682960 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: Close
[0m18:57:52.685914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d1d57c0-af42-491a-9bdd-183a95f6ae89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002120362C850>]}
[0m18:57:52.687909 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model flights_wh.Dim_Airport ................. [[32mINSERT 0 104[0m in 0.37s]
[0m18:57:52.691901 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_Airport
[0m18:57:52.692894 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_aircraft
[0m18:57:52.693892 [info ] [Thread-1 (]: 2 of 7 START sql incremental model flights_wh.Dim_aircraft ..................... [RUN]
[0m18:57:52.695887 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_Airport, now model.flights_dbt.Dim_aircraft)
[0m18:57:52.696917 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_aircraft
[0m18:57:52.701872 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_aircraft"
[0m18:57:52.706860 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (compile): 18:57:52.697882 => 18:57:52.704875
[0m18:57:52.707858 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_aircraft
[0m18:57:52.728800 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:57:52.730794 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

    
  
    

  create temporary table "Dim_aircraft__dbt_tmp185752719827"
  
  
    as
  
  (
    

select 
    row_number() over() as dim_aircraft_id,

    ad.aircraft_code,
    ad.model,
    ad.range,
    ad.last_update,

    s. seat_no,
    s.fare_conditions,

    case when range > 5600 then 'High'
        when range <= 5600 then 'Low'
        else 'Null'
        end as range_L_H,
    jsonb_extract_path(model, 'en' )as Model_English,
    jsonb_extract_path(model, 'ru' )as Model_Russian,

'2023-08-16 15:57:51'::timestamp as dbt_time

from flights_demo.stg.aircrafts_data ad 
join flights_demo.stg.seats s 
	on s.aircraft_code = ad.aircraft_code
  );
  
  
[0m18:57:52.731790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:52.838293 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m18:57:52.843278 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:57:52.844279 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: BEGIN
[0m18:57:52.846271 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:57:52.849281 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:57:52.850261 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft__dbt_tmp185752719827'
        
      order by ordinal_position

  
[0m18:57:52.874233 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:57:52.879230 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:57:52.880180 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:57:52.887160 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:57:52.892181 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:57:52.892181 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:57:52.898131 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:57:52.910099 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_aircraft"
[0m18:57:52.913124 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:57:52.914089 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      insert into "flights_demo"."flights_wh"."Dim_aircraft" ("dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time")
    (
        select "dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time"
        from "Dim_aircraft__dbt_tmp185752719827"
    )


  
[0m18:57:52.921108 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m18:57:52.924094 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:57:52.925107 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m18:57:52.925107 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m18:57:52.928108 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:57:52.930047 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (execute): 18:57:52.709853 => 18:57:52.929082
[0m18:57:52.931043 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: Close
[0m18:57:52.933039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d1d57c0-af42-491a-9bdd-183a95f6ae89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021204095290>]}
[0m18:57:52.935035 [info ] [Thread-1 (]: 2 of 7 OK created sql incremental model flights_wh.Dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.24s]
[0m18:57:52.937029 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_aircraft
[0m18:57:52.939024 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_boarding_passes
[0m18:57:52.940022 [info ] [Thread-1 (]: 3 of 7 START sql incremental model flights_wh.Fact_boarding_passes ............. [RUN]
[0m18:57:52.942016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_aircraft, now model.flights_dbt.Fact_boarding_passes)
[0m18:57:52.943013 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_boarding_passes
[0m18:57:52.950996 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_boarding_passes"
[0m18:57:52.957974 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_boarding_passes (compile): 18:57:52.944009 => 18:57:52.956979
[0m18:57:52.959969 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_boarding_passes
[0m18:57:52.967945 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:57:52.968941 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

    
  
    

  create temporary table "Fact_boarding_passes__dbt_tmp185752963962"
  
  
    as
  
  (
    

select 
    bp.ticket_no,
    bp.flight_id,
    bp.boarding_no,
    bp.seat_no,
    bp.last_update,

    tf.fare_conditions,
    tf.amount,

'2023-08-16 15:57:51'::timestamp as dbt_time

from flights_demo.stg.ticket_flights tf 
join flights_demo.stg.boarding_passes bp 
	on tf.ticket_no = bp.ticket_no 
	and tf.flight_id =bp.flight_id
  );
  
  
[0m18:57:52.970939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:55.485976 [debug] [Thread-1 (]: SQL status: SELECT 579686 in 3.0 seconds
[0m18:57:55.489965 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:57:55.490998 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: BEGIN
[0m18:57:55.492958 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:57:55.493956 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:57:55.494986 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Fact_boarding_passes__dbt_tmp185752963962'
        
      order by ordinal_position

  
[0m18:57:55.521879 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m18:57:55.526865 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:57:55.527898 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_boarding_passes'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:57:55.534846 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m18:57:55.539860 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:57:55.542824 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_boarding_passes'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:57:55.546847 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m18:57:55.551799 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_boarding_passes"
[0m18:57:55.552797 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:57:55.553794 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      
        
            delete from "flights_demo"."flights_wh"."Fact_boarding_passes"
            where (
                ticket_no) in (
                select (ticket_no)
                from "Fact_boarding_passes__dbt_tmp185752963962"
            );

        
    

    insert into "flights_demo"."flights_wh"."Fact_boarding_passes" ("ticket_no", "flight_id", "boarding_no", "seat_no", "last_update", "fare_conditions", "amount", "dbt_time")
    (
        select "ticket_no", "flight_id", "boarding_no", "seat_no", "last_update", "fare_conditions", "amount", "dbt_time"
        from "Fact_boarding_passes__dbt_tmp185752963962"
    )
  
[0m18:58:01.117503 [debug] [Thread-1 (]: SQL status: INSERT 0 579686 in 6.0 seconds
[0m18:58:01.122494 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: COMMIT
[0m18:58:01.123522 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m18:58:01.123522 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: COMMIT
[0m18:58:01.140444 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:58:01.142436 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_boarding_passes (execute): 18:57:52.959969 => 18:58:01.142436
[0m18:58:01.143433 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: Close
[0m18:58:01.145433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d1d57c0-af42-491a-9bdd-183a95f6ae89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002120419CA10>]}
[0m18:58:01.147424 [info ] [Thread-1 (]: 3 of 7 OK created sql incremental model flights_wh.Fact_boarding_passes ........ [[32mINSERT 0 579686[0m in 8.20s]
[0m18:58:01.150420 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_boarding_passes
[0m18:58:01.151411 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_flights
[0m18:58:01.152409 [info ] [Thread-1 (]: 4 of 7 START sql incremental model flights_wh.Fact_flights ..................... [RUN]
[0m18:58:01.154406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_boarding_passes, now model.flights_dbt.Fact_flights)
[0m18:58:01.157412 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_flights
[0m18:58:01.162385 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_flights"
[0m18:58:01.166378 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (compile): 18:58:01.158396 => 18:58:01.165379
[0m18:58:01.167415 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_flights
[0m18:58:01.185322 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:58:01.186320 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

    
  
    

  create temporary table "Fact_flights__dbt_tmp185801174383"
  
  
    as
  
  (
    

with dim_flight_mod as (	
			select *,
			extract(day from (scheduled_arrival - scheduled_departure)*24) + extract(hour from (scheduled_arrival - scheduled_departure)) as flight_duration_expected,
			extract(day from (actual_arrival - actual_departure)*24) + extract(hour from (actual_arrival - actual_departure)) as duration_actual_hours
			from flights_demo.stg.flights f 
			)
select *,
    case 	when duration_actual_hours > flight_duration_expected 
                then 'Longer'
            when duration_actual_hours < flight_duration_expected 
                then 'Shorter'
            when duration_actual_hours = flight_duration_expected 
                then 'As Expected'
            else null
            end as flight_duration_case,

'2023-08-16 15:57:51'::timestamp as dbt_time

from dim_flight_mod
  );
  
  
[0m18:58:01.187317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:01.435444 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 0.0 seconds
[0m18:58:01.441396 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:58:01.442392 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: BEGIN
[0m18:58:01.451983 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:58:01.452980 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:58:01.453979 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights__dbt_tmp185801174383'
        
      order by ordinal_position

  
[0m18:58:01.580638 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:58:01.586658 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:58:01.587652 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:58:01.592639 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:58:01.596597 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:58:01.600590 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:58:01.607567 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m18:58:01.614551 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_flights"
[0m18:58:01.615546 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:58:01.616543 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      
        
            delete from "flights_demo"."flights_wh"."Fact_flights"
            where (
                flight_id) in (
                select (flight_id)
                from "Fact_flights__dbt_tmp185801174383"
            );

        
    

    insert into "flights_demo"."flights_wh"."Fact_flights" ("flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time")
    (
        select "flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time"
        from "Fact_flights__dbt_tmp185801174383"
    )
  
[0m18:58:01.800052 [debug] [Thread-1 (]: SQL status: INSERT 0 33121 in 0.0 seconds
[0m18:58:01.804044 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:58:01.805079 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m18:58:01.805079 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m18:58:01.817032 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:58:01.819004 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (execute): 18:58:01.168367 => 18:58:01.819004
[0m18:58:01.820000 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: Close
[0m18:58:01.820997 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d1d57c0-af42-491a-9bdd-183a95f6ae89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002120392E090>]}
[0m18:58:01.821997 [info ] [Thread-1 (]: 4 of 7 OK created sql incremental model flights_wh.Fact_flights ................ [[32mINSERT 0 33121[0m in 0.67s]
[0m18:58:01.822992 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_flights
[0m18:58:01.824015 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_tickets
[0m18:58:01.825011 [info ] [Thread-1 (]: 5 of 7 START sql incremental model flights_wh.Fact_tickets ..................... [RUN]
[0m18:58:01.827978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_flights, now model.flights_dbt.Fact_tickets)
[0m18:58:01.829973 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_tickets
[0m18:58:01.841944 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_tickets"
[0m18:58:01.843935 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_tickets (compile): 18:58:01.830975 => 18:58:01.843935
[0m18:58:01.845931 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_tickets
[0m18:58:01.853911 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m18:58:01.855909 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_tickets"} */

    
  
    

  create temporary table "Fact_tickets__dbt_tmp185801850917"
  
  
    as
  
  (
    

select 
    b.book_ref,
    b.book_date,
    b.total_amount,

    t.ticket_no,
    t.passenger_id,
    t.passenger_name,
    t.contact_data,
    t.last_update,

    jsonb_extract_path(contact_data, 'email' )as Email,
    jsonb_extract_path(contact_data, 'phone' )as Phone,

'2023-08-16 15:57:51'::timestamp as dbt_time

from flights_demo.stg.bookings b 
join flights_demo.stg.tickets t
	on b.book_ref =t.book_ref
  );
  
  
[0m18:58:01.856939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:04.020387 [debug] [Thread-1 (]: SQL status: SELECT 366733 in 2.0 seconds
[0m18:58:04.025372 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m18:58:04.027368 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: BEGIN
[0m18:58:04.029364 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:58:04.030363 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m18:58:04.031355 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Fact_tickets__dbt_tmp185801850917'
        
      order by ordinal_position

  
[0m18:58:04.080225 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:58:04.087206 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m18:58:04.088204 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_tickets'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:58:04.094187 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:58:04.100173 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m18:58:04.101170 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_tickets'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m18:58:04.109152 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m18:58:04.114169 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_tickets"
[0m18:58:04.115131 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m18:58:04.116129 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_tickets"} */

      
        
            delete from "flights_demo"."flights_wh"."Fact_tickets"
            where (
                ticket_no) in (
                select (ticket_no)
                from "Fact_tickets__dbt_tmp185801850917"
            );

        
    

    insert into "flights_demo"."flights_wh"."Fact_tickets" ("book_ref", "book_date", "total_amount", "ticket_no", "passenger_id", "passenger_name", "contact_data", "last_update", "email", "phone", "dbt_time")
    (
        select "book_ref", "book_date", "total_amount", "ticket_no", "passenger_id", "passenger_name", "contact_data", "last_update", "email", "phone", "dbt_time"
        from "Fact_tickets__dbt_tmp185801850917"
    )
  
[0m18:58:10.660579 [debug] [Thread-1 (]: SQL status: INSERT 0 366733 in 7.0 seconds
[0m18:58:10.663569 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: COMMIT
[0m18:58:10.664602 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m18:58:10.665598 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: COMMIT
[0m18:58:10.680523 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:58:10.682519 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_tickets (execute): 18:58:01.845931 => 18:58:10.682519
[0m18:58:10.683516 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: Close
[0m18:58:10.684540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d1d57c0-af42-491a-9bdd-183a95f6ae89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021204255690>]}
[0m18:58:10.685513 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model flights_wh.Fact_tickets ................ [[32mINSERT 0 366733[0m in 8.86s]
[0m18:58:10.686515 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_tickets
[0m18:58:10.687506 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m18:58:10.688502 [info ] [Thread-1 (]: 6 of 7 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m18:58:10.690499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_tickets, now model.flights_dbt.my_first_dbt_model)
[0m18:58:10.691497 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m18:58:10.694515 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m18:58:10.700484 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 18:58:10.692492 => 18:58:10.697491
[0m18:58:10.702467 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m18:58:10.754327 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m18:58:10.762308 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:58:10.765315 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m18:58:10.767297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:10.847109 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:58:10.848075 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:58:10.848075 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m18:58:10.877026 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:58:10.885975 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:58:10.886971 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m18:58:10.888996 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:58:10.892989 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:58:10.893986 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m18:58:10.894951 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:58:10.903929 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:58:10.904924 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:58:10.904924 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m18:58:10.907957 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:58:10.917921 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m18:58:10.918886 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m18:58:10.922876 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:58:10.925868 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 18:58:10.703466 => 18:58:10.925868
[0m18:58:10.926894 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m18:58:10.927863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d1d57c0-af42-491a-9bdd-183a95f6ae89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212041E96D0>]}
[0m18:58:10.929873 [info ] [Thread-1 (]: 6 of 7 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.24s]
[0m18:58:10.932851 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m18:58:10.936841 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m18:58:10.938833 [info ] [Thread-1 (]: 7 of 7 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m18:58:10.941827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m18:58:10.942855 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m18:58:10.948809 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m18:58:10.952797 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 18:58:10.942855 => 18:58:10.950808
[0m18:58:10.952797 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m18:58:10.961772 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m18:58:10.963769 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:58:10.964763 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m18:58:10.965762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:11.041540 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m18:58:11.042533 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:58:11.043530 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_demo"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m18:58:11.053503 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m18:58:11.058491 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:58:11.059490 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m18:58:11.060488 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m18:58:11.063512 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:58:11.063512 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:58:11.065484 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m18:58:11.073454 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m18:58:11.077477 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m18:58:11.077477 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m18:58:11.079436 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m18:58:11.081466 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 18:58:10.953794 => 18:58:11.081466
[0m18:58:11.082463 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m18:58:11.083459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d1d57c0-af42-491a-9bdd-183a95f6ae89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021204298ED0>]}
[0m18:58:11.085419 [info ] [Thread-1 (]: 7 of 7 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.14s]
[0m18:58:11.087416 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m18:58:11.090406 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:11.090406 [debug] [MainThread]: On master: BEGIN
[0m18:58:11.091437 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:58:11.167200 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m18:58:11.168198 [debug] [MainThread]: On master: COMMIT
[0m18:58:11.169197 [debug] [MainThread]: Using postgres connection "master"
[0m18:58:11.171191 [debug] [MainThread]: On master: COMMIT
[0m18:58:11.172222 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m18:58:11.173219 [debug] [MainThread]: On master: Close
[0m18:58:11.175180 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:58:11.175180 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m18:58:11.176176 [debug] [MainThread]: Connection 'list_flights_demo_flights_wh' was properly closed.
[0m18:58:11.176176 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m18:58:11.178171 [info ] [MainThread]: 
[0m18:58:11.179170 [info ] [MainThread]: Finished running 5 incremental models, 2 view models in 0 hours 0 minutes and 19.27 seconds (19.27s).
[0m18:58:11.182185 [debug] [MainThread]: Command end result
[0m18:58:11.195141 [info ] [MainThread]: 
[0m18:58:11.197121 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:58:11.198119 [info ] [MainThread]: 
[0m18:58:11.200114 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m18:58:11.202110 [debug] [MainThread]: Command `dbt run` succeeded at 18:58:11.202110 after 19.96 seconds
[0m18:58:11.203105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002120370FC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212036CF550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002127D3CDFD0>]}
[0m18:58:11.204101 [debug] [MainThread]: Flushing usage events
[0m20:21:51.459867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B917ABD4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B917AA9CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B917DB2FD0>]}


============================== 20:21:51.489739 | b6a69904-6192-400c-9601-dfb664cfd64d ==============================
[0m20:21:51.489739 [info ] [MainThread]: Running with dbt=1.5.3
[0m20:21:51.500641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\flights_dbt_course\\flights_dbt\\logs', 'profiles_dir': 'C:\\Users\\Dana Kohta\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'send_anonymous_usage_stats': 'True'}
[0m20:21:51.922649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6a69904-6192-400c-9601-dfb664cfd64d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B917A29210>]}
[0m20:21:51.964653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6a69904-6192-400c-9601-dfb664cfd64d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B917ABF3D0>]}
[0m20:21:51.970637 [info ] [MainThread]: Registered adapter: postgres=1.5.3
[0m20:21:52.057899 [debug] [MainThread]: checksum: d91324b50612e0c4823cec6657ec795d80c11aba9d5b50e83fb26de63277dec4, vars: {}, profile: , target: , version: 1.5.3
[0m20:21:52.349709 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:21:52.353700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b6a69904-6192-400c-9601-dfb664cfd64d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B917AABA90>]}
[0m20:21:54.411715 [debug] [MainThread]: 1603: static parser failed on dimension\Dim_aircraft.sql
[0m20:21:54.450115 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimension\Dim_aircraft.sql
[0m20:21:54.456649 [debug] [MainThread]: 1603: static parser failed on dimension\Dim_Airport.sql
[0m20:21:54.489566 [debug] [MainThread]: 1602: parser fallback to jinja rendering on dimension\Dim_Airport.sql
[0m20:21:54.508759 [debug] [MainThread]: 1699: static parser successfully parsed example\my_first_dbt_model.sql
[0m20:21:54.529704 [debug] [MainThread]: 1699: static parser successfully parsed example\my_second_dbt_model.sql
[0m20:21:54.549687 [debug] [MainThread]: 1603: static parser failed on Facts\Fact_boarding_passes.sql
[0m20:21:54.568800 [debug] [MainThread]: 1602: parser fallback to jinja rendering on Facts\Fact_boarding_passes.sql
[0m20:21:54.574799 [debug] [MainThread]: 1603: static parser failed on Facts\Fact_flights.sql
[0m20:21:54.599973 [debug] [MainThread]: 1602: parser fallback to jinja rendering on Facts\Fact_flights.sql
[0m20:21:54.606681 [debug] [MainThread]: 1603: static parser failed on Facts\Fact_tickets.sql
[0m20:21:54.625672 [debug] [MainThread]: 1602: parser fallback to jinja rendering on Facts\Fact_tickets.sql
[0m20:21:54.915030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6a69904-6192-400c-9601-dfb664cfd64d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B917ABEAD0>]}
[0m20:21:54.930664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6a69904-6192-400c-9601-dfb664cfd64d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B918531590>]}
[0m20:21:54.931699 [info ] [MainThread]: Found 7 models, 12 tests, 0 snapshots, 0 analyses, 307 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics, 0 groups
[0m20:21:54.932731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6a69904-6192-400c-9601-dfb664cfd64d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B914213110>]}
[0m20:21:54.934953 [info ] [MainThread]: 
[0m20:21:54.936648 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:21:54.939814 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo'
[0m20:21:54.973553 [debug] [ThreadPool]: Using postgres connection "list_flights_demo"
[0m20:21:54.975142 [debug] [ThreadPool]: On list_flights_demo: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo"} */

    select distinct nspname from pg_namespace
  
[0m20:21:54.978573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:21:55.381782 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
[0m20:21:55.385087 [debug] [ThreadPool]: On list_flights_demo: Close
[0m20:21:55.391765 [debug] [ThreadPool]: Acquiring new postgres connection 'list_flights_demo_flights_wh'
[0m20:21:55.412751 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m20:21:55.413776 [debug] [ThreadPool]: On list_flights_demo_flights_wh: BEGIN
[0m20:21:55.414843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:21:55.507851 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m20:21:55.510824 [debug] [ThreadPool]: Using postgres connection "list_flights_demo_flights_wh"
[0m20:21:55.511924 [debug] [ThreadPool]: On list_flights_demo_flights_wh: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "list_flights_demo_flights_wh"} */
select
      'flights_demo' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'flights_wh'
    union all
    select
      'flights_demo' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'flights_wh'
  
[0m20:21:55.581145 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m20:21:55.587148 [debug] [ThreadPool]: On list_flights_demo_flights_wh: ROLLBACK
[0m20:21:55.590038 [debug] [ThreadPool]: On list_flights_demo_flights_wh: Close
[0m20:21:55.619603 [debug] [MainThread]: Using postgres connection "master"
[0m20:21:55.622599 [debug] [MainThread]: On master: BEGIN
[0m20:21:55.623609 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:21:55.735059 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:21:55.737659 [debug] [MainThread]: Using postgres connection "master"
[0m20:21:55.739655 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:21:55.938350 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m20:21:55.944910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6a69904-6192-400c-9601-dfb664cfd64d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B918541D50>]}
[0m20:21:55.946905 [debug] [MainThread]: On master: ROLLBACK
[0m20:21:55.948897 [debug] [MainThread]: Using postgres connection "master"
[0m20:21:55.949895 [debug] [MainThread]: On master: BEGIN
[0m20:21:55.951892 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:21:55.953884 [debug] [MainThread]: On master: COMMIT
[0m20:21:55.955208 [debug] [MainThread]: Using postgres connection "master"
[0m20:21:55.956204 [debug] [MainThread]: On master: COMMIT
[0m20:21:55.957201 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:21:55.959200 [debug] [MainThread]: On master: Close
[0m20:21:55.965957 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:21:55.969953 [info ] [MainThread]: 
[0m20:21:56.004924 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_Airport
[0m20:21:56.009794 [info ] [Thread-1 (]: 1 of 7 START sql incremental model flights_wh.Dim_Airport ...................... [RUN]
[0m20:21:56.018768 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.flights_dbt.Dim_Airport'
[0m20:21:56.021837 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_Airport
[0m20:21:56.049610 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_Airport"
[0m20:21:56.058576 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (compile): 20:21:56.023755 => 20:21:56.056578
[0m20:21:56.063568 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_Airport
[0m20:21:56.257369 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m20:21:56.258366 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

    
  
    

  create temporary table "Dim_Airport__dbt_tmp202156180746"
  
  
    as
  
  (
    

select *,
    jsonb_extract_path(airport_name, 'en' )as airport_name_eng, 
    jsonb_extract_path(city, 'en' )as city_eng,
    jsonb_extract_path(airport_name, 'ru' )as airport_name_rus,
    jsonb_extract_path(city, 'en' )as city_rus,

'2023-08-16 17:21:51'::timestamp as dbt_time

from stg.airports_data
  );
  
  
[0m20:21:56.259646 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:21:56.510683 [debug] [Thread-1 (]: SQL status: SELECT 104 in 0.0 seconds
[0m20:21:56.535750 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m20:21:56.537748 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: BEGIN
[0m20:21:56.540978 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:21:56.542733 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m20:21:56.543728 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport__dbt_tmp202156180746'
        
      order by ordinal_position

  
[0m20:21:56.642649 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m20:21:56.660598 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m20:21:56.661823 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m20:21:56.673838 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m20:21:56.700422 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m20:21:56.701519 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_Airport'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m20:21:56.712349 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m20:21:56.776083 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_Airport"
[0m20:21:56.782028 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m20:21:56.783023 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_Airport"} */

      
        
            delete from "flights_demo"."flights_wh"."Dim_Airport"
            where (
                airport_code) in (
                select (airport_code)
                from "Dim_Airport__dbt_tmp202156180746"
            );

        
    

    insert into "flights_demo"."flights_wh"."Dim_Airport" ("airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time")
    (
        select "airport_code", "airport_name", "city", "coordinates", "timezone", "last_update", "airport_name_eng", "city_eng", "airport_name_rus", "city_rus", "dbt_time"
        from "Dim_Airport__dbt_tmp202156180746"
    )
  
[0m20:21:56.802302 [debug] [Thread-1 (]: SQL status: INSERT 0 104 in 0.0 seconds
[0m20:21:56.823930 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m20:21:56.824965 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_Airport"
[0m20:21:56.825960 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: COMMIT
[0m20:21:56.831945 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:21:56.833986 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_Airport (execute): 20:21:56.064557 => 20:21:56.833986
[0m20:21:56.835429 [debug] [Thread-1 (]: On model.flights_dbt.Dim_Airport: Close
[0m20:21:56.837425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6a69904-6192-400c-9601-dfb664cfd64d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B917ABEE90>]}
[0m20:21:56.840420 [info ] [Thread-1 (]: 1 of 7 OK created sql incremental model flights_wh.Dim_Airport ................. [[32mINSERT 0 104[0m in 0.82s]
[0m20:21:56.844953 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_Airport
[0m20:21:56.846948 [debug] [Thread-1 (]: Began running node model.flights_dbt.Dim_aircraft
[0m20:21:56.848963 [info ] [Thread-1 (]: 2 of 7 START sql incremental model flights_wh.Dim_aircraft ..................... [RUN]
[0m20:21:56.851935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_Airport, now model.flights_dbt.Dim_aircraft)
[0m20:21:56.853929 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Dim_aircraft
[0m20:21:56.865898 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Dim_aircraft"
[0m20:21:56.876932 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (compile): 20:21:56.855282 => 20:21:56.872034
[0m20:21:56.880986 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Dim_aircraft
[0m20:21:56.905953 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m20:21:56.909023 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

    
  
    

  create temporary table "Dim_aircraft__dbt_tmp202156890927"
  
  
    as
  
  (
    

select 
    row_number() over() as dim_aircraft_id,

    ad.aircraft_code,
    ad.model,
    ad.range,
    ad.last_update,

    s. seat_no,
    s.fare_conditions,

    case when range > 5600 then 'High'
        when range <= 5600 then 'Low'
        else 'Null'
        end as range_L_H,
    jsonb_extract_path(model, 'en' )as Model_English,
    jsonb_extract_path(model, 'ru' )as Model_Russian,

'2023-08-16 17:21:51'::timestamp as dbt_time

from flights_demo.stg.aircrafts_data ad 
join flights_demo.stg.seats s 
	on s.aircraft_code = ad.aircraft_code
  );
  
  
[0m20:21:56.914494 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:21:57.351973 [debug] [Thread-1 (]: SQL status: SELECT 1339 in 0.0 seconds
[0m20:21:57.368518 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m20:21:57.373739 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: BEGIN
[0m20:21:57.379704 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:21:57.383261 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m20:21:57.391877 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft__dbt_tmp202156890927'
        
      order by ordinal_position

  
[0m20:21:57.417898 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m20:21:57.422880 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m20:21:57.424144 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m20:21:57.433330 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m20:21:57.441844 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m20:21:57.442876 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Dim_aircraft'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m20:21:57.454343 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m20:21:57.496036 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Dim_aircraft"
[0m20:21:57.500025 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m20:21:57.500025 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Dim_aircraft"} */

      insert into "flights_demo"."flights_wh"."Dim_aircraft" ("dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time")
    (
        select "dim_aircraft_id", "aircraft_code", "model", "range", "last_update", "seat_no", "fare_conditions", "range_l_h", "model_english", "model_russian", "dbt_time"
        from "Dim_aircraft__dbt_tmp202156890927"
    )


  
[0m20:21:57.512207 [debug] [Thread-1 (]: SQL status: INSERT 0 1339 in 0.0 seconds
[0m20:21:57.517023 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m20:21:57.518629 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Dim_aircraft"
[0m20:21:57.520787 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: COMMIT
[0m20:21:57.525605 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:21:57.529637 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Dim_aircraft (execute): 20:21:56.882852 => 20:21:57.529637
[0m20:21:57.530638 [debug] [Thread-1 (]: On model.flights_dbt.Dim_aircraft: Close
[0m20:21:57.532586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6a69904-6192-400c-9601-dfb664cfd64d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B918619DD0>]}
[0m20:21:57.533585 [info ] [Thread-1 (]: 2 of 7 OK created sql incremental model flights_wh.Dim_aircraft ................ [[32mINSERT 0 1339[0m in 0.68s]
[0m20:21:57.535579 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Dim_aircraft
[0m20:21:57.536578 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_boarding_passes
[0m20:21:57.543508 [info ] [Thread-1 (]: 3 of 7 START sql incremental model flights_wh.Fact_boarding_passes ............. [RUN]
[0m20:21:57.550045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Dim_aircraft, now model.flights_dbt.Fact_boarding_passes)
[0m20:21:57.552042 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_boarding_passes
[0m20:21:57.567598 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_boarding_passes"
[0m20:21:57.578660 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_boarding_passes (compile): 20:21:57.553072 => 20:21:57.577029
[0m20:21:57.581562 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_boarding_passes
[0m20:21:57.624085 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m20:21:57.626080 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

    
  
    

  create temporary table "Fact_boarding_passes__dbt_tmp202157601218"
  
  
    as
  
  (
    

select 
    bp.ticket_no,
    bp.flight_id,
    bp.boarding_no,
    bp.seat_no,
    bp.last_update,

    tf.fare_conditions,
    tf.amount,

'2023-08-16 17:21:51'::timestamp as dbt_time

from flights_demo.stg.ticket_flights tf 
join flights_demo.stg.boarding_passes bp 
	on tf.ticket_no = bp.ticket_no 
	and tf.flight_id =bp.flight_id
  );
  
  
[0m20:21:57.630071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:03.907636 [debug] [Thread-1 (]: SQL status: SELECT 579686 in 6.0 seconds
[0m20:22:03.916109 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m20:22:03.918095 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: BEGIN
[0m20:22:03.923073 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:22:03.925000 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m20:22:03.926080 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Fact_boarding_passes__dbt_tmp202157601218'
        
      order by ordinal_position

  
[0m20:22:04.033808 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m20:22:04.054237 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m20:22:04.059259 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_boarding_passes'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m20:22:04.086724 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m20:22:04.110901 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m20:22:04.115874 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_boarding_passes'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m20:22:04.143684 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.0 seconds
[0m20:22:04.154631 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_boarding_passes"
[0m20:22:04.169306 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m20:22:04.172052 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_boarding_passes"} */

      
        
            delete from "flights_demo"."flights_wh"."Fact_boarding_passes"
            where (
                ticket_no) in (
                select (ticket_no)
                from "Fact_boarding_passes__dbt_tmp202157601218"
            );

        
    

    insert into "flights_demo"."flights_wh"."Fact_boarding_passes" ("ticket_no", "flight_id", "boarding_no", "seat_no", "last_update", "fare_conditions", "amount", "dbt_time")
    (
        select "ticket_no", "flight_id", "boarding_no", "seat_no", "last_update", "fare_conditions", "amount", "dbt_time"
        from "Fact_boarding_passes__dbt_tmp202157601218"
    )
  
[0m20:22:16.378139 [debug] [Thread-1 (]: SQL status: INSERT 0 579686 in 12.0 seconds
[0m20:22:16.397623 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: COMMIT
[0m20:22:16.400723 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_boarding_passes"
[0m20:22:16.401986 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: COMMIT
[0m20:22:16.413623 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:22:16.414620 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_boarding_passes (execute): 20:21:57.583555 => 20:22:16.414620
[0m20:22:16.415618 [debug] [Thread-1 (]: On model.flights_dbt.Fact_boarding_passes: Close
[0m20:22:16.416615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6a69904-6192-400c-9601-dfb664cfd64d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B918669B10>]}
[0m20:22:16.418209 [info ] [Thread-1 (]: 3 of 7 OK created sql incremental model flights_wh.Fact_boarding_passes ........ [[32mINSERT 0 579686[0m in 18.87s]
[0m20:22:16.421682 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_boarding_passes
[0m20:22:16.423599 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_flights
[0m20:22:16.426261 [info ] [Thread-1 (]: 4 of 7 START sql incremental model flights_wh.Fact_flights ..................... [RUN]
[0m20:22:16.430245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_boarding_passes, now model.flights_dbt.Fact_flights)
[0m20:22:16.433313 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_flights
[0m20:22:16.450889 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_flights"
[0m20:22:16.469714 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (compile): 20:22:16.435837 => 20:22:16.463776
[0m20:22:16.477090 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_flights
[0m20:22:16.517883 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m20:22:16.525970 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

    
  
    

  create temporary table "Fact_flights__dbt_tmp202216500792"
  
  
    as
  
  (
    

with dim_flight_mod as (	
			select *,
			extract(day from (scheduled_arrival - scheduled_departure)*24) + extract(hour from (scheduled_arrival - scheduled_departure)) as flight_duration_expected,
			extract(day from (actual_arrival - actual_departure)*24) + extract(hour from (actual_arrival - actual_departure)) as duration_actual_hours
			from flights_demo.stg.flights f 
			)
select *,
    case 	when duration_actual_hours > flight_duration_expected 
                then 'Longer'
            when duration_actual_hours < flight_duration_expected 
                then 'Shorter'
            when duration_actual_hours = flight_duration_expected 
                then 'As Expected'
            else null
            end as flight_duration_case,

'2023-08-16 17:21:51'::timestamp as dbt_time

from dim_flight_mod
  );
  
  
[0m20:22:16.530231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:17.971559 [debug] [Thread-1 (]: SQL status: SELECT 33121 in 1.0 seconds
[0m20:22:17.987753 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m20:22:17.990746 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: BEGIN
[0m20:22:18.003095 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:22:18.006787 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m20:22:18.011125 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights__dbt_tmp202216500792'
        
      order by ordinal_position

  
[0m20:22:18.136460 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m20:22:18.153266 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m20:22:18.156221 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m20:22:18.173316 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m20:22:18.194259 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m20:22:18.197351 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_flights'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m20:22:18.211681 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.0 seconds
[0m20:22:18.221982 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_flights"
[0m20:22:18.227756 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m20:22:18.235871 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_flights"} */

      
        
            delete from "flights_demo"."flights_wh"."Fact_flights"
            where (
                flight_id) in (
                select (flight_id)
                from "Fact_flights__dbt_tmp202216500792"
            );

        
    

    insert into "flights_demo"."flights_wh"."Fact_flights" ("flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time")
    (
        select "flight_id", "flight_no", "scheduled_departure", "scheduled_arrival", "departure_airport", "arrival_airport", "status", "aircraft_code", "actual_departure", "actual_arrival", "last_update", "flight_duration_expected", "duration_actual_hours", "flight_duration_case", "dbt_time"
        from "Fact_flights__dbt_tmp202216500792"
    )
  
[0m20:22:19.154735 [debug] [Thread-1 (]: SQL status: INSERT 0 33121 in 1.0 seconds
[0m20:22:19.175897 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m20:22:19.178781 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_flights"
[0m20:22:19.181783 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: COMMIT
[0m20:22:19.200860 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:22:19.205627 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_flights (execute): 20:22:16.478089 => 20:22:19.204629
[0m20:22:19.209131 [debug] [Thread-1 (]: On model.flights_dbt.Fact_flights: Close
[0m20:22:19.213605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6a69904-6192-400c-9601-dfb664cfd64d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B918758190>]}
[0m20:22:19.217593 [info ] [Thread-1 (]: 4 of 7 OK created sql incremental model flights_wh.Fact_flights ................ [[32mINSERT 0 33121[0m in 2.78s]
[0m20:22:19.224855 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_flights
[0m20:22:19.230839 [debug] [Thread-1 (]: Began running node model.flights_dbt.Fact_tickets
[0m20:22:19.236844 [info ] [Thread-1 (]: 5 of 7 START sql incremental model flights_wh.Fact_tickets ..................... [RUN]
[0m20:22:19.279738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_flights, now model.flights_dbt.Fact_tickets)
[0m20:22:19.287725 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.Fact_tickets
[0m20:22:19.353240 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.Fact_tickets"
[0m20:22:19.363205 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_tickets (compile): 20:22:19.320934 => 20:22:19.361419
[0m20:22:19.365807 [debug] [Thread-1 (]: Began executing node model.flights_dbt.Fact_tickets
[0m20:22:19.398600 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m20:22:19.401593 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_tickets"} */

    
  
    

  create temporary table "Fact_tickets__dbt_tmp202219380814"
  
  
    as
  
  (
    

select 
    b.book_ref,
    b.book_date,
    b.total_amount,

    t.ticket_no,
    t.passenger_id,
    t.passenger_name,
    t.contact_data,
    t.last_update,

    jsonb_extract_path(contact_data, 'email' )as Email,
    jsonb_extract_path(contact_data, 'phone' )as Phone,

'2023-08-16 17:21:51'::timestamp as dbt_time

from flights_demo.stg.bookings b 
join flights_demo.stg.tickets t
	on b.book_ref =t.book_ref
  );
  
  
[0m20:22:19.404584 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:24.421920 [debug] [Thread-1 (]: SQL status: SELECT 366733 in 5.0 seconds
[0m20:22:24.433879 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m20:22:24.435415 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: BEGIN
[0m20:22:24.440456 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:22:24.441401 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m20:22:24.442497 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'Fact_tickets__dbt_tmp202219380814'
        
      order by ordinal_position

  
[0m20:22:24.542017 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m20:22:24.552739 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m20:22:24.554751 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_tickets'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m20:22:24.564854 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m20:22:24.573763 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m20:22:24.574811 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_tickets"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "flights_demo".INFORMATION_SCHEMA.columns
      where table_name = 'Fact_tickets'
        
        and table_schema = 'flights_wh'
        
      order by ordinal_position

  
[0m20:22:24.584950 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.0 seconds
[0m20:22:24.592914 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.Fact_tickets"
[0m20:22:24.597858 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m20:22:24.600852 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.Fact_tickets"} */

      
        
            delete from "flights_demo"."flights_wh"."Fact_tickets"
            where (
                ticket_no) in (
                select (ticket_no)
                from "Fact_tickets__dbt_tmp202219380814"
            );

        
    

    insert into "flights_demo"."flights_wh"."Fact_tickets" ("book_ref", "book_date", "total_amount", "ticket_no", "passenger_id", "passenger_name", "contact_data", "last_update", "email", "phone", "dbt_time")
    (
        select "book_ref", "book_date", "total_amount", "ticket_no", "passenger_id", "passenger_name", "contact_data", "last_update", "email", "phone", "dbt_time"
        from "Fact_tickets__dbt_tmp202219380814"
    )
  
[0m20:22:40.013930 [debug] [Thread-1 (]: SQL status: INSERT 0 366733 in 15.0 seconds
[0m20:22:40.019957 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: COMMIT
[0m20:22:40.021912 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.Fact_tickets"
[0m20:22:40.023912 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: COMMIT
[0m20:22:40.046597 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:22:40.049560 [debug] [Thread-1 (]: Timing info for model.flights_dbt.Fact_tickets (execute): 20:22:19.367818 => 20:22:40.049560
[0m20:22:40.051554 [debug] [Thread-1 (]: On model.flights_dbt.Fact_tickets: Close
[0m20:22:40.055193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6a69904-6192-400c-9601-dfb664cfd64d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B918776850>]}
[0m20:22:40.058690 [info ] [Thread-1 (]: 5 of 7 OK created sql incremental model flights_wh.Fact_tickets ................ [[32mINSERT 0 366733[0m in 20.78s]
[0m20:22:40.064644 [debug] [Thread-1 (]: Finished running node model.flights_dbt.Fact_tickets
[0m20:22:40.066644 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_first_dbt_model
[0m20:22:40.069633 [info ] [Thread-1 (]: 6 of 7 START sql view model flights_wh.my_first_dbt_model ...................... [RUN]
[0m20:22:40.073879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.Fact_tickets, now model.flights_dbt.my_first_dbt_model)
[0m20:22:40.074883 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_first_dbt_model
[0m20:22:40.088044 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_first_dbt_model"
[0m20:22:40.095942 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (compile): 20:22:40.076839 => 20:22:40.093968
[0m20:22:40.098543 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_first_dbt_model
[0m20:22:40.261787 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_first_dbt_model"
[0m20:22:40.269029 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:22:40.271023 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: BEGIN
[0m20:22:40.273019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:40.476835 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:22:40.478831 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:22:40.480859 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp"
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/


with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m20:22:40.537682 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:22:40.554568 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:22:40.556561 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m20:22:40.560550 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:22:40.575662 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:22:40.578621 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:22:40.584849 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:22:40.603822 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m20:22:40.605779 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:22:40.607336 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: COMMIT
[0m20:22:40.613808 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:22:40.809669 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_first_dbt_model"
[0m20:22:40.812101 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_first_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_first_dbt_model__dbt_backup" cascade
[0m20:22:40.826064 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:22:40.837831 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_first_dbt_model (execute): 20:22:40.099901 => 20:22:40.836833
[0m20:22:40.840909 [debug] [Thread-1 (]: On model.flights_dbt.my_first_dbt_model: Close
[0m20:22:40.845086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6a69904-6192-400c-9601-dfb664cfd64d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B9184BBA50>]}
[0m20:22:40.847755 [info ] [Thread-1 (]: 6 of 7 OK created sql view model flights_wh.my_first_dbt_model ................. [[32mCREATE VIEW[0m in 0.77s]
[0m20:22:40.853746 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_first_dbt_model
[0m20:22:40.861094 [debug] [Thread-1 (]: Began running node model.flights_dbt.my_second_dbt_model
[0m20:22:40.863713 [info ] [Thread-1 (]: 7 of 7 START sql view model flights_wh.my_second_dbt_model ..................... [RUN]
[0m20:22:40.868698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.flights_dbt.my_first_dbt_model, now model.flights_dbt.my_second_dbt_model)
[0m20:22:40.871734 [debug] [Thread-1 (]: Began compiling node model.flights_dbt.my_second_dbt_model
[0m20:22:40.897209 [debug] [Thread-1 (]: Writing injected SQL for node "model.flights_dbt.my_second_dbt_model"
[0m20:22:40.905957 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (compile): 20:22:40.875212 => 20:22:40.904965
[0m20:22:40.908950 [debug] [Thread-1 (]: Began executing node model.flights_dbt.my_second_dbt_model
[0m20:22:40.960766 [debug] [Thread-1 (]: Writing runtime sql for node "model.flights_dbt.my_second_dbt_model"
[0m20:22:40.964758 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:22:40.967752 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: BEGIN
[0m20:22:40.970740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:22:41.155753 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m20:22:41.157844 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:22:41.160738 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */

  create view "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "flights_demo"."flights_wh"."my_first_dbt_model"
where id = 1
  );
[0m20:22:41.221976 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m20:22:41.246755 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:22:41.250587 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
alter table "flights_demo"."flights_wh"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:22:41.256570 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m20:22:41.263843 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m20:22:41.266761 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:22:41.269750 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: COMMIT
[0m20:22:41.274773 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m20:22:41.289758 [debug] [Thread-1 (]: Using postgres connection "model.flights_dbt.my_second_dbt_model"
[0m20:22:41.300653 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.5.3", "profile_name": "flights_dbt", "target_name": "dev", "node_id": "model.flights_dbt.my_second_dbt_model"} */
drop view if exists "flights_demo"."flights_wh"."my_second_dbt_model__dbt_backup" cascade
[0m20:22:41.306731 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m20:22:41.321079 [debug] [Thread-1 (]: Timing info for model.flights_dbt.my_second_dbt_model (execute): 20:22:40.910945 => 20:22:41.320081
[0m20:22:41.325594 [debug] [Thread-1 (]: On model.flights_dbt.my_second_dbt_model: Close
[0m20:22:41.332572 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6a69904-6192-400c-9601-dfb664cfd64d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B918780490>]}
[0m20:22:41.337090 [info ] [Thread-1 (]: 7 of 7 OK created sql view model flights_wh.my_second_dbt_model ................ [[32mCREATE VIEW[0m in 0.46s]
[0m20:22:41.343074 [debug] [Thread-1 (]: Finished running node model.flights_dbt.my_second_dbt_model
[0m20:22:41.360733 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:41.363857 [debug] [MainThread]: On master: BEGIN
[0m20:22:41.369505 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:22:41.613827 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m20:22:41.617342 [debug] [MainThread]: On master: COMMIT
[0m20:22:41.620892 [debug] [MainThread]: Using postgres connection "master"
[0m20:22:41.625158 [debug] [MainThread]: On master: COMMIT
[0m20:22:41.628095 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m20:22:41.629090 [debug] [MainThread]: On master: Close
[0m20:22:41.633121 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:22:41.634116 [debug] [MainThread]: Connection 'list_flights_demo' was properly closed.
[0m20:22:41.636110 [debug] [MainThread]: Connection 'list_flights_demo_flights_wh' was properly closed.
[0m20:22:41.637106 [debug] [MainThread]: Connection 'model.flights_dbt.my_second_dbt_model' was properly closed.
[0m20:22:41.640101 [info ] [MainThread]: 
[0m20:22:41.642093 [info ] [MainThread]: Finished running 5 incremental models, 2 view models in 0 hours 0 minutes and 46.70 seconds (46.70s).
[0m20:22:41.650076 [debug] [MainThread]: Command end result
[0m20:22:41.667028 [info ] [MainThread]: 
[0m20:22:41.670018 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:22:41.673013 [info ] [MainThread]: 
[0m20:22:41.676123 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m20:22:41.686096 [debug] [MainThread]: Command `dbt run` succeeded at 20:22:41.685109 after 50.60 seconds
[0m20:22:41.691085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B917B4A390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B917D9EE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B917B7F450>]}
[0m20:22:41.696821 [debug] [MainThread]: Flushing usage events
